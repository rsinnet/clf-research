(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    260320,       6258]
NotebookOptionsPosition[    245369,       5816]
NotebookOutlinePosition[    245872,       5836]
CellTagsIndexPosition[    245829,       5833]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Old 2D Footed Simulation Model with Reduction using MEX\
\>", "Title",
 CellChangeTimes->{{3.4404350275828004`*^9, 3.4404350344780006`*^9}, {
   3.4419833227303467`*^9, 3.4419833238067465`*^9}, {3.4420861759203467`*^9, 
   3.4420861767471466`*^9}, 3.4424113254077573`*^9, {3.4891631024901485`*^9, 
   3.489163105828339*^9}, {3.578417641978129*^9, 3.5784176513447905`*^9}, {
   3.5787422951875677`*^9, 3.57874229742337*^9}, {3.5806735138484545`*^9, 
   3.5806735292136545`*^9}, {3.582465350507823*^9, 3.582465352226548*^9}, {
   3.582500905775579*^9, 3.5825009116364202`*^9}, {3.582637676200282*^9, 
   3.582637681673915*^9}, 3.605279566053493*^9}],

Cell["Initialization", "Section",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.4404350142604003`*^9, 3.4404350171308002`*^9}, 
   3.4424113254077573`*^9, 3.581939957629306*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dl1", "=", 
  RowBox[{"DateString", "[", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4831815714484*^9, 3.48318159081*^9}, {
   3.5813459127448673`*^9, 3.581345913288363*^9}, {3.581879520126506*^9, 
   3.581879521357643*^9}, 3.58193995762938*^9, {3.5835919899194117`*^9, 
   3.583591993560217*^9}}],

Cell[BoxData[
 FormBox["\<\"Mon 31 Mar 2014 13:40:59\"\>", TraditionalForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.5817827189458933`*^9, 3.581783098267177*^9, 3.581783387843563*^9, 
   3.5817859569920187`*^9, 3.581786078894977*^9, 3.581786134285021*^9, 
   3.581844889848269*^9, 3.581848209734868*^9, 3.581863471163519*^9, 
   3.581876714847698*^9, 3.581876920939706*^9, 3.581879524980501*^9, 
   3.581886693544389*^9, 3.581886729856029*^9, 3.581886791938649*^9, 
   3.581887288710409*^9, 3.581893058096635*^9, 3.581939879844017*^9, 
   3.581939957629446*^9, {3.581940038134542*^9, 3.581940045610772*^9}, {
   3.58227700005027*^9, 3.582277000908359*^9}, {3.582286199135831*^9, 
   3.582286199823182*^9}, {3.582286268266878*^9, 3.582286268937058*^9}, 
   3.582465381805532*^9, 3.582465496768211*^9, 3.582465970938064*^9, {
   3.582469342413334*^9, 3.582469343335248*^9}, {3.582500915630815*^9, 
   3.582500917066368*^9}, {3.582570508850998*^9, 3.5825705096155233`*^9}, {
   3.582580697767144*^9, 3.582580731153962*^9}, {3.58263497946257*^9, 
   3.582634980391878*^9}, {3.582649768466955*^9, 3.582649790471196*^9}, {
   3.582650904654028*^9, 3.582650905371793*^9}, {3.5826575192197027`*^9, 
   3.582657536985491*^9}, {3.5826576320342283`*^9, 3.5826576329937963`*^9}, 
   3.5827343699219837`*^9, {3.582972209231537*^9, 3.582972210091213*^9}, {
   3.582973430547492*^9, 3.5829734501075907`*^9}, {3.582975022687812*^9, 
   3.582975023581194*^9}, {3.5829792624980297`*^9, 3.582979263279479*^9}, {
   3.5830015653321867`*^9, 3.583001566155799*^9}, {3.5830135136207523`*^9, 
   3.583013514372382*^9}, {3.583016681983808*^9, 3.5830166832319*^9}, {
   3.583017689024067*^9, 3.583017689766047*^9}, {3.5830786739672413`*^9, 
   3.58307867495586*^9}, {3.5835892773717833`*^9, 3.5835892783301353`*^9}, {
   3.583591858252263*^9, 3.583591859217647*^9}, {3.583591961487995*^9, 
   3.583592096338608*^9}, {3.583598781923128*^9, 3.5835987830985727`*^9}, {
   3.583599536949448*^9, 3.583599537938558*^9}, {3.5836171322727757`*^9, 
   3.583617133104376*^9}, {3.5836210370289783`*^9, 3.583621037769434*^9}, {
   3.605280058345975*^9, 3.605280059172065*^9}}],

Cell[BoxData[
 RowBox[{"nbdir", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4918480983167477`*^9, 3.4918481000267496`*^9}, 
   3.4923395121731296`*^9, {3.5782300318375397`*^9, 3.5782300330177307`*^9}, {
   3.578418119964163*^9, 3.5784181246745186`*^9}, 3.5819399576295033`*^9, {
   3.5835919899197693`*^9, 3.583591993560577*^9}}],

Cell[BoxData[
 FormBox["\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/\"\>", 
  TraditionalForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.5817827190689373`*^9, 3.5817830984430428`*^9, 3.5817833878872957`*^9, 
   3.581785957034507*^9, 3.581786079085279*^9, 3.5817861343420773`*^9, 
   3.581844890007998*^9, 3.581848209866081*^9, 3.5818634712061357`*^9, 
   3.5818767149500303`*^9, 3.581876920972801*^9, 3.5818795250201178`*^9, 
   3.581886694077002*^9, 3.5818867298932467`*^9, 3.581886792071768*^9, 
   3.581887288744581*^9, 3.581893058131837*^9, 3.581939879959908*^9, 
   3.581939957629549*^9, {3.581940038255316*^9, 3.581940045699234*^9}, {
   3.58227700014925*^9, 3.582277000969075*^9}, {3.582286199274469*^9, 
   3.5822861998699627`*^9}, {3.582286268314618*^9, 3.582286268976891*^9}, 
   3.582465381924198*^9, 3.582465496815637*^9, 3.582465970978894*^9, {
   3.582469342420196*^9, 3.582469343419799*^9}, {3.5825009156772423`*^9, 
   3.582500917119166*^9}, {3.582570508997086*^9, 3.582570509637299*^9}, {
   3.58258069788414*^9, 3.582580731202629*^9}, {3.582634979505803*^9, 
   3.582634980434206*^9}, {3.582649768504747*^9, 3.582649790511395*^9}, {
   3.582650904695858*^9, 3.58265090542021*^9}, {3.582657519258705*^9, 
   3.5826575370204563`*^9}, {3.5826576320766697`*^9, 3.5826576330476017`*^9}, 
   3.582734370001121*^9, {3.5829722092689447`*^9, 3.5829722101387663`*^9}, {
   3.58297343060928*^9, 3.582973450162859*^9}, {3.582975022731511*^9, 
   3.58297502363395*^9}, {3.582979262535152*^9, 3.582979263333762*^9}, {
   3.583001565370739*^9, 3.583001566194874*^9}, {3.583013513661232*^9, 
   3.583013514417927*^9}, {3.5830166820242968`*^9, 3.583016683274575*^9}, {
   3.583017689062687*^9, 3.5830176898153887`*^9}, {3.583078674014016*^9, 
   3.583078675014176*^9}, 3.583589277423118*^9, {3.583591858383789*^9, 
   3.583591860461053*^9}, {3.583591961602186*^9, 3.58359209644656*^9}, {
   3.5835987821194267`*^9, 3.583598783138111*^9}, {3.583599537080266*^9, 
   3.5835995379917593`*^9}, {3.5836171323864613`*^9, 
   3.5836171331353607`*^9}, {3.583621037217737*^9, 3.583621037806095*^9}, {
   3.605280058413588*^9, 3.605280059226427*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"snakeyamldir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"nbdir", ",", "\"\<third\>\"", ",", "\"\<snakeyaml\>\""}], "}"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"utildir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"nbdir", ",", "\"\<util\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"screwsdir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"nbdir", ",", "\"\<third\>\"", ",", "\"\<Screws\>\""}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581349573012516*^9, 3.581349589211383*^9}, {
   3.5818866381465607`*^9, 3.5818866670784197`*^9}, 3.581939957629603*^9, {
   3.5835919899200697`*^9, 3.583591993560885*^9}}],

Cell[BoxData[
 RowBox[{"$Path", " ", "=", " ", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"$Path", ",", 
     RowBox[{"{", 
      RowBox[{"utildir", ",", "snakeyamldir", ",", "screwsdir"}], "}"}]}], 
    "]"}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581337899597541*^9, 3.581337938058917*^9}, {
   3.581338662362093*^9, 3.581338663139182*^9}, {3.581349413914529*^9, 
   3.581349448916799*^9}, {3.581349525624958*^9, 3.581349526098669*^9}, {
   3.5813495692034883`*^9, 3.581349570947217*^9}, {3.581694527297353*^9, 
   3.581694530784091*^9}, {3.581886678532425*^9, 3.581886689860094*^9}, 
   3.581939957629648*^9, {3.58359198992022*^9, 3.5835919935610456`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"/usr/local/Wolfram/Mathematica/8.0/SystemFiles/Links\"\>", 
    ",", "\<\"/home/rsinnet/.Mathematica/Kernel\"\>", 
    ",", "\<\"/home/rsinnet/.Mathematica/Autoload\"\>", 
    ",", "\<\"/home/rsinnet/.Mathematica/Applications\"\>", 
    ",", "\<\"/usr/share/Mathematica/Kernel\"\>", 
    ",", "\<\"/usr/share/Mathematica/Autoload\"\>", 
    ",", "\<\"/usr/share/Mathematica/Applications\"\>", ",", "\<\".\"\>", 
    ",", "\<\"/home/rsinnet\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/Packages\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/LegacyPackages\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/SystemFiles/Autoload\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/Autoload\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/Applications\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/ExtraPackages\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/SystemFiles/Kernel/Packages\"\
\>", ",", \
"\<\"/usr/local/Wolfram/Mathematica/8.0/Documentation/English/System\"\>", 
    ",", "\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/util\"\>", 
    ",", "\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/third/\
snakeyaml\"\>", 
    ",", "\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/third/Screws\"\
\>"}], "}"}], TraditionalForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.581782719139063*^9, 3.581783098549073*^9, 3.581783387986703*^9, 
   3.58178595707528*^9, 3.581786079153302*^9, 3.581786134403769*^9, 
   3.5818448900625973`*^9, 3.581848210054706*^9, 3.581863471257618*^9, 
   3.58187671499158*^9, 3.58187692101623*^9, 3.581879525069831*^9, 
   3.5818866956099577`*^9, 3.5818867299470663`*^9, 3.581886792116455*^9, 
   3.581887288811616*^9, 3.581893058182727*^9, 3.581939880031817*^9, 
   3.581939957629698*^9, {3.581940038318314*^9, 3.5819400457476807`*^9}, {
   3.582277000202888*^9, 3.5822770010399437`*^9}, {3.582286199319517*^9, 
   3.582286199918786*^9}, {3.582286268379389*^9, 3.582286269021174*^9}, 
   3.582465381976635*^9, 3.58246549686067*^9, 3.582465971030128*^9, {
   3.5824693425253773`*^9, 3.5824693434787397`*^9}, {3.582500915802291*^9, 
   3.582500917182411*^9}, {3.58257050903913*^9, 3.58257050967227*^9}, {
   3.582580697925077*^9, 3.582580731253502*^9}, {3.582634979549285*^9, 
   3.582634980479751*^9}, {3.582649768603903*^9, 3.5826497905545464`*^9}, {
   3.582650904737153*^9, 3.582650905471898*^9}, {3.582657519300077*^9, 
   3.582657537062457*^9}, {3.582657632132143*^9, 3.582657633106015*^9}, 
   3.582734370055334*^9, {3.5829722093422623`*^9, 3.582972210190919*^9}, {
   3.582973430707285*^9, 3.582973450225564*^9}, {3.58297502283611*^9, 
   3.582975023696294*^9}, {3.582979262639168*^9, 3.5829792633825197`*^9}, {
   3.5830015654731903`*^9, 3.583001566248354*^9}, {3.583013513715682*^9, 
   3.583013514471418*^9}, {3.583016682103343*^9, 3.583016683317707*^9}, {
   3.5830176891603518`*^9, 3.58301768986443*^9}, {3.58307867406104*^9, 
   3.5830786750805197`*^9}, 3.583589277480142*^9, 3.583591858446683*^9, {
   3.5835919616484423`*^9, 3.583592096489559*^9}, {3.583598782221551*^9, 
   3.583598783188529*^9}, {3.5835995371382017`*^9, 3.583599538033596*^9}, {
   3.58361713244802*^9, 3.5836171331806383`*^9}, {3.583621037269305*^9, 
   3.583621037844301*^9}, {3.605280058449901*^9, 3.605280059288559*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<RobotLinks`\>\"", "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5813367202648497`*^9, 3.581336721271616*^9}, 
   3.5819399576297503`*^9, {3.5825014262642307`*^9, 3.582501429338111*^9}, {
   3.582583364932928*^9, 3.582583365178348*^9}, {3.5835919899205112`*^9, 
   3.58359199356135*^9}}],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<SnakeYaml`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SnakeYaml`YamlInit", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"snakeyamldir", ",", "\"\<snakeyaml-1.10.jar\>\""}], "}"}], "]"}],
   "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581336703845263*^9, 3.581336711231525*^9}, {
   3.5813367450408163`*^9, 3.581336753592917*^9}, {3.581338479201351*^9, 
   3.5813384825606003`*^9}, {3.581338744519328*^9, 3.581338751873493*^9}, {
   3.581338859634376*^9, 3.581338895307234*^9}, {3.581344999507485*^9, 
   3.581345007283494*^9}, {3.581345928276507*^9, 3.5813459348517723`*^9}, {
   3.581346616499198*^9, 3.581346619362835*^9}, 3.5813495420576878`*^9, {
   3.581349594130229*^9, 3.581349617769165*^9}, 3.581349650915312*^9, 
   3.581939957629794*^9, {3.58359198992066*^9, 3.58359199356151*^9}}]
}, Open  ]],

Cell[BoxData[
 FormBox["\<\"Yaml already initizialized\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.605280059342394*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"builddir", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"nbdir", ",", 
     RowBox[{"\"\<build_\>\"", "<>", 
      RowBox[{"FileBaseName", "[", 
       RowBox[{"NotebookFileName", "[", "]"}], "]"}]}]}], "}"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.578230037447628*^9, 3.5782300930886917`*^9}, {
   3.578230136960682*^9, 3.5782301508327503`*^9}, {3.578323384951927*^9, 
   3.578323385144105*^9}, {3.5784176645299835`*^9, 3.5784176875953145`*^9}, 
   3.578418128859389*^9, {3.578742301842122*^9, 3.578742303664324*^9}, {
   3.579572045838529*^9, 3.5795720466943207`*^9}, {3.5806735369898415`*^9, 
   3.5806735370589046`*^9}, {3.581347341428228*^9, 3.581347354050168*^9}, 
   3.581939957629838*^9, {3.582465473890686*^9, 3.582465494815852*^9}, {
   3.583591989920816*^9, 3.583591993561668*^9}}],

Cell[BoxData[
 FormBox["\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/build_old-\
model-2d-feet-amber-suite\"\>", TraditionalForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.581782719318771*^9, 3.5817830986960773`*^9, 3.581783388258656*^9, 
   3.5817859573391733`*^9, 3.5817860794927187`*^9, 3.581786134672793*^9, 
   3.581844890245164*^9, 3.58184821125006*^9, 3.581863471469283*^9, 
   3.581876715094818*^9, 3.581876921219274*^9, 3.5818795253762207`*^9, {
   3.581886700318651*^9, 3.581886730200673*^9}, 3.581886792335387*^9, 
   3.581887289059306*^9, 3.5818930584198112`*^9, 3.5819398801654587`*^9, 
   3.5819399576298857`*^9, {3.581940038476542*^9, 3.581940045813774*^9}, {
   3.582277000474277*^9, 3.5822770011166773`*^9}, {3.582286199572538*^9, 
   3.582286199974792*^9}, {3.582286268639454*^9, 3.582286269074243*^9}, 
   3.582465382157525*^9, {3.582465475642983*^9, 3.582465497538156*^9}, 
   3.5824659712988358`*^9, {3.582469342889757*^9, 3.5824693436069117`*^9}, {
   3.582500916121526*^9, 3.5825009174752417`*^9}, {3.582570509184174*^9, 
   3.582570509747477*^9}, {3.582580697979701*^9, 3.582580731373983*^9}, {
   3.5826349799029207`*^9, 3.582634980534358*^9}, {3.582649768867526*^9, 
   3.5826497906234503`*^9}, {3.582650905002145*^9, 3.5826509055520477`*^9}, {
   3.582657519532298*^9, 3.5826575371199017`*^9}, {3.582657632416711*^9, 
   3.582657633188368*^9}, 3.5827343701257877`*^9, {3.582972209678035*^9, 
   3.5829722102640467`*^9}, {3.582973431071863*^9, 3.5829734502927713`*^9}, {
   3.582975023179942*^9, 3.58297502378489*^9}, {3.58297926291374*^9, 
   3.5829792634646053`*^9}, {3.583001565743786*^9, 3.583001566380795*^9}, {
   3.583013513988916*^9, 3.5830135145475407`*^9}, {3.583016682573822*^9, 
   3.583016683379209*^9}, {3.583017689432716*^9, 3.583017689938223*^9}, {
   3.5830786744099197`*^9, 3.58307867516851*^9}, 3.5835892779418573`*^9, 
   3.583591858659047*^9, {3.583591961893551*^9, 3.583592096622437*^9}, {
   3.58359878243548*^9, 3.583598783265428*^9}, {3.5835995373247766`*^9, 
   3.583599538083179*^9}, {3.583617132646365*^9, 3.583617133230687*^9}, {
   3.5836210374506683`*^9, 3.583621037891551*^9}, {3.605280058581629*^9, 
   3.605280059377613*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "builddir", "]"}], ",", ",", 
    RowBox[{"CreateDirectory", "[", "builddir", "]"}]}], "]"}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4318808284558*^9, 3.4318808288146*^9}, {
   3.4318982003682003`*^9, 3.4318982006022*^9}, {3.4318997009954*^9, 
   3.431899728701*^9}, {3.4318998612718*^9, 3.4318998753118*^9}, {
   3.4319128101837997`*^9, 3.4319128106518*^9}, 3.454242597217705*^9, 
   3.4554579110104094`*^9, {3.4832079699653997`*^9, 3.4832079712623997`*^9}, {
   3.4918313821329226`*^9, 3.4918313843370485`*^9}, {3.5782301283444767`*^9, 
   3.5782301577542753`*^9}, {3.578417713537305*^9, 3.5784177416903405`*^9}, {
   3.5784181362512255`*^9, 3.578418143507936*^9}, 3.581939957629932*^9, {
   3.583591989921123*^9, 3.583591993561975*^9}}],

Cell["\<\
Dimension of the space in which the robot operates\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.583591878709257*^9, 3.583591897282351*^9}, 
   3.5835919935621243`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dim", "=", "2"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.583591899556706*^9, 3.583591902262911*^9}, 
   3.583591993562258*^9}],

Cell[BoxData[
 RowBox[{"constsubs", "=", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Lft", "\[Rule]", 
      FractionBox["1", "4"]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"foot", " ", "ankle"}], "\[Dash]", 
       RowBox[{"toe", " ", "length"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Lfh", "\[Rule]", 
      FractionBox[
       RowBox[{"1", " ", "1"}], 
       RowBox[{"4", " ", "4"}]]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"foot", " ", "ankle"}], "\[Dash]", 
       RowBox[{"heel", " ", "length"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ha", "\[Rule]", 
      FractionBox[
       RowBox[{"1", " ", "1"}], 
       RowBox[{"5", " ", "2"}]]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"height", " ", "of", " ", "ankle"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Lc", "\[Rule]", "0.50"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"calf", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Lt", "\[Rule]", "0.50"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"thigh", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rfx", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "1"}], 
        RowBox[{"3", " ", "6"}]]}]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"foot", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rfz", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", "1", " ", "1"}], 
       RowBox[{"3", " ", "3", " ", "6"}]]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"foot", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rcx", "\[Rule]", "0"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"calf", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rcz", "\[Rule]", "0.375"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"calf", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rtx", "\[Rule]", "0"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"thigh", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rtz", "\[Rule]", "0.175"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"thigh", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rTx", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"torso", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rTz", "\[Rule]", "0.075"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"torso", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"wHip", "\[Rule]", 
      RowBox[{"0.25", " ", 
       RowBox[{"p", "[", "1", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wFoot", "\[Rule]", 
      RowBox[{"0.08", 
       RowBox[{"p", "[", "1", "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"mf", "\[Rule]", "0.1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"mc", "\[Rule]", "1.5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"mt", "\[Rule]", "5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"mT", "\[Rule]", "20"}], ",", "\[IndentingNewLine]", 
     RowBox[{"g", "\[Rule]", "9.81"}]}], "\[IndentingNewLine]", "}"}], "//", 
   "Rationalize"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4349049195298*^9, 3.4349049437878*^9}, {
   3.4349993545274*^9, 3.4349993797214003`*^9}, {3.435000560398*^9, 
   3.4350005632528*^9}, {3.4350707572384*^9, 3.4350707618248*^9}, {
   3.4350772253014*^9, 3.4350772254262*^9}, {3.435078153829*^9, 
   3.4350782220322*^9}, {3.4350782615002003`*^9, 3.435078291811*^9}, 
   3.4350790937412*^9, {3.4350808724442*^9, 3.4350808770618*^9}, {
   3.4350815963042*^9, 3.4350815983789997`*^9}, {3.43508206077*^9, 
   3.4350820940136003`*^9}, {3.4350823303828*^9, 3.4350823363887997`*^9}, {
   3.435082521709*^9, 3.435082526545*^9}, {3.4353196505144*^9, 
   3.4353196948028*^9}, {3.435319873376*^9, 3.435319887572*^9}, {
   3.4353208165694*^9, 3.4353208194554*^9}, 3.4353210966127996`*^9, {
   3.4353212670866003`*^9, 3.4353212719694*^9}, {3.4353221386418*^9, 
   3.4353221496865997`*^9}, {3.4353223965699997`*^9, 3.4353223966792*^9}, {
   3.4353226242363997`*^9, 3.4353226261084003`*^9}, 3.4353235871907997`*^9, {
   3.4353368037764*^9, 3.4353368071616*^9}, {3.4353408653612003`*^9, 
   3.4353408717572002`*^9}, {3.4402457169728003`*^9, 
   3.4402457170039997`*^9}, {3.4402460597356*^9, 3.4402460624344*^9}, {
   3.440246662159*^9, 3.4402466701774*^9}, {3.4402712213442*^9, 
   3.4402712531052*^9}, {3.4402718403542*^9, 3.4402718491412*^9}, {
   3.4403487309802*^9, 3.4403487681082*^9}, {3.4403558159737997`*^9, 
   3.4403558578733997`*^9}, {3.4404236020412006`*^9, 
   3.4404236097008004`*^9}, {3.4404259997788005`*^9, 
   3.4404260399010005`*^9}, {3.4404385449296007`*^9, 
   3.4404385890630007`*^9}, {3.4404386440508003`*^9, 3.4404386584964004`*^9}, 
   3.4404395871088004`*^9, {3.440512097489174*^9, 3.4405121122935734`*^9}, 
   3.4406969117755737`*^9, {3.440705955990574*^9, 3.440705977159774*^9}, {
   3.440706170350174*^9, 3.4407061722065735`*^9}, {3.4407063815585737`*^9, 
   3.4407063820889735`*^9}, {3.4407067030823736`*^9, 
   3.4407067030823736`*^9}, {3.4407067839059734`*^9, 
   3.4407067883675737`*^9}, {3.4407068923727736`*^9, 3.4407068946347733`*^9}, 
   3.440768144048174*^9, {3.4407685888667736`*^9, 3.4407685998491735`*^9}, {
   3.4407690714937735`*^9, 3.440769106734174*^9}, 3.440780711814364*^9, {
   3.4409368493343477`*^9, 3.4409368579143476`*^9}, 3.440937052120748*^9, 
   3.4409512258825846`*^9, {3.440956158778185*^9, 3.440956158856185*^9}, {
   3.440956558182585*^9, 3.440956558712985*^9}, {3.440958204138585*^9, 
   3.4409582151365848`*^9}, {3.4409594130609846`*^9, 3.4409594175069847`*^9}, 
   3.441022061446353*^9, {3.4410228332095532`*^9, 3.4410228364699535`*^9}, {
   3.4410230877683535`*^9, 3.441023092479553*^9}, 3.441023136414753*^9, 
   3.441023168408553*^9, 3.441023627056353*^9, {3.441023820573553*^9, 
   3.441023834084153*^9}, 3.4410368933567533`*^9, 3.4410370482313533`*^9, {
   3.441038713002353*^9, 3.4410387191955533`*^9}, {3.441039431232353*^9, 
   3.4410394353819532`*^9}, {3.441136957010053*^9, 3.441136962251653*^9}, {
   3.4411372581532536`*^9, 3.441137262115653*^9}, {3.4415512244094*^9, 
   3.4415512464678*^9}, {3.4415516053494*^9, 3.4415516054742002`*^9}, {
   3.441998499572547*^9, 3.4419985050637465`*^9}, {3.442062672618947*^9, 
   3.4420626763005466`*^9}, {3.442065799594947*^9, 3.442065800920947*^9}, 
   3.442411325423357*^9, {3.455459616851609*^9, 3.455459620720409*^9}, {
   3.455632439318109*^9, 3.4556325240729094`*^9}, {3.4564869824795*^9, 
   3.4564870056455*^9}, {3.4564877199238997`*^9, 3.4564877233403*^9}, {
   3.457703557511973*^9, 3.457703557792773*^9}, 3.4577037077459726`*^9, {
   3.4831100776988*^9, 3.4831100778236*^9}, {3.4831102065236*^9, 
   3.4831102068512*^9}, {3.4831246610252*^9, 3.4831246622108*^9}, 
   3.4831885579214*^9, {3.4831888486552*^9, 3.4831888502464*^9}, {
   3.4831888982164*^9, 3.4831889029588003`*^9}, {3.4831892709578*^9, 
   3.4831892750762*^9}, {3.4831894285824003`*^9, 3.4831894537296*^9}, {
   3.4831954980938*^9, 3.4831955030702*^9}, {3.4831957806684*^9, 
   3.4831957809024*^9}, {3.4831959049547997`*^9, 3.4831959094632*^9}, {
   3.4831959744332*^9, 3.4831959822799997`*^9}, {3.4831961390518*^9, 
   3.4831961447302*^9}, {3.4831962051949997`*^9, 3.4831962100934*^9}, {
   3.4831963744941998`*^9, 3.4831963788154*^9}, {3.4831965001776*^9, 
   3.48319650024*^9}, {3.4831966132066*^9, 3.4831966175278*^9}, 
   3.4831967075312*^9, {3.4832268151275997`*^9, 3.4832268215704*^9}, {
   3.4832268967478*^9, 3.4832269037834*^9}, {3.4832269452304*^9, 
   3.4832269828398*^9}, {3.48328266052*^9, 3.4832826627352*^9}, {
   3.4832828444351997`*^9, 3.4832828520168*^9}, {3.4832838323996*^9, 
   3.4832838353324003`*^9}, {3.4832839270184*^9, 3.4832839490924*^9}, {
   3.4832841018272*^9, 3.4832841499063997`*^9}, {3.4832848887022*^9, 
   3.4832848913542*^9}, {3.4832859365924*^9, 3.4832859395408*^9}, {
   3.483286230758*^9, 3.483286234502*^9}, {3.483286514528*^9, 
   3.4832865204091997`*^9}, {3.4832867553842*^9, 3.483286763309*^9}, 
   3.484816737328931*^9, {3.4848218831551*^9, 3.484821884785102*^9}, {
   3.484822006125275*^9, 3.484822008725279*^9}, {3.4848224874192257`*^9, 
   3.4848224899392295`*^9}, {3.4848225433593044`*^9, 
   3.4848225508493147`*^9}, {3.4848269284363728`*^9, 
   3.4848269286393843`*^9}, {3.484827282888646*^9, 3.4848272847107506`*^9}, 
   3.484827399002288*^9, {3.4848283446413755`*^9, 3.4848283446983786`*^9}, {
   3.4848284469372263`*^9, 3.484828446966228*^9}, {3.484828550201133*^9, 
   3.4848285859191756`*^9}, {3.4848301764965596`*^9, 3.4848301785713634`*^9}, 
   3.4848306463432703`*^9, {3.48483120953685*^9, 3.484831223116869*^9}, {
   3.4848330221038723`*^9, 3.484833026455121*^9}, {3.484833082697338*^9, 
   3.4848331083778067`*^9}, {3.4848331670571632`*^9, 3.484833167232173*^9}, {
   3.484833213673829*^9, 3.4848332418394403`*^9}, 3.484833281952735*^9, {
   3.4848333129135056`*^9, 3.4848333396630354`*^9}, {3.4848335540893*^9, 
   3.484833556432434*^9}, {3.4848336932432594`*^9, 3.484833695899411*^9}, {
   3.4848339707931337`*^9, 3.484833973095266*^9}, {3.4856123915183477`*^9, 
   3.485612422821138*^9}, {3.4863903390634003`*^9, 3.48639041552*^9}, {
   3.4863904950956*^9, 3.4863904984496*^9}, {3.486400968980678*^9, 
   3.4864009697067194`*^9}, {3.4864014375874805`*^9, 3.486401443504819*^9}, {
   3.4864688787018003`*^9, 3.4864688824146*^9}, {3.486468987585*^9, 
   3.4864689891605997`*^9}, {3.486469233889*^9, 3.4864692542938004`*^9}, {
   3.4864711921730003`*^9, 3.4864712206429996`*^9}, {3.4867480347042*^9, 
   3.4867480364358*^9}, {3.4867481319234*^9, 3.4867481334834003`*^9}, {
   3.4867483290202*^9, 3.4867483409698*^9}, {3.4921659225198526`*^9, 
   3.492166046371937*^9}, {3.4921691741448355`*^9, 3.4921691855484877`*^9}, {
   3.4921879975834217`*^9, 3.4921881184413347`*^9}, 3.4921882018191037`*^9, {
   3.492277260820487*^9, 3.4922772772584267`*^9}, {3.4922777953010573`*^9, 
   3.4922778047395973`*^9}, 3.4922780255822287`*^9, {3.4922832515609217`*^9, 
   3.4922832623605394`*^9}, 3.4923429715279937`*^9, {3.4927756166174994`*^9, 
   3.49277566540129*^9}, {3.4927759034689064`*^9, 3.4927759060930567`*^9}, {
   3.4927889996717625`*^9, 3.4927890003227997`*^9}, 3.4927892543013268`*^9, {
   3.4927902190878315`*^9, 3.492790226855275*^9}, {3.4927908139108534`*^9, 
   3.4927908325419188`*^9}, 3.4927909931471047`*^9, 3.4929495622029724`*^9, {
   3.4929607972273912`*^9, 3.4929608099951215`*^9}, {3.492961149218524*^9, 
   3.492961153382762*^9}, {3.4929614574801555`*^9, 3.4929614659606404`*^9}, {
   3.4929656954565535`*^9, 3.492965701445896*^9}, {3.4929664615983744`*^9, 
   3.492966461882391*^9}, {3.493987401292*^9, 3.4939874046148*^9}, {
   3.4939956223234*^9, 3.493995625459*^9}, 3.4939959174354*^9, {
   3.4940849076731997`*^9, 3.4940849108087997`*^9}, {3.4940851696862*^9, 
   3.4940851717922*^9}, {3.494171928530195*^9, 3.4941719303709955`*^9}, {
   3.494172120098195*^9, 3.494172121470995*^9}, 3.4941722020937953`*^9, 
   3.494174973218395*^9, {3.4942487727191954`*^9, 3.494248773467995*^9}, {
   3.494248808427595*^9, 3.494248808536795*^9}, {3.494248863214795*^9, 
   3.4942488714671955`*^9}, {3.494259904747795*^9, 3.494259905293795*^9}, {
   3.494264544928195*^9, 3.494264545224595*^9}, {3.494264905030795*^9, 
   3.494264907791995*^9}, {3.4942649905421953`*^9, 3.4942649942549953`*^9}, {
   3.4942653546383953`*^9, 3.494265357789595*^9}, {3.494266386375595*^9, 
   3.494266390447195*^9}, {3.4942703487415953`*^9, 3.494270352875595*^9}, {
   3.4942831411646953`*^9, 3.494283143192695*^9}, {3.494284565631895*^9, 
   3.494284567597495*^9}, {3.494285628350695*^9, 3.4942856319698954`*^9}, {
   3.494339417782056*^9, 3.4943394186088557`*^9}, {3.494339874431256*^9, 
   3.4943398751488557`*^9}, {3.4943399776876554`*^9, 
   3.4943399966104555`*^9}, {3.4943554965789967`*^9, 3.494355497826997*^9}, 
   3.494356740498597*^9, {3.494357307809597*^9, 3.494357307871997*^9}, {
   3.494370752258197*^9, 3.494370752507797*^9}, {3.494420794734397*^9, 
   3.4944208029243965`*^9}, {3.494421053586997*^9, 3.494421056067397*^9}, {
   3.494422391154397*^9, 3.4944224006547966`*^9}, {3.494423121156397*^9, 
   3.494423122575997*^9}, 3.494423808461197*^9, {3.4944356069039965`*^9, 
   3.4944356071223965`*^9}, {3.4944409384582624`*^9, 3.494440938723462*^9}, 
   3.4944438111382623`*^9, {3.4944521517846622`*^9, 3.4944521520030622`*^9}, {
   3.494502618698262*^9, 3.494502620788662*^9}, {3.4945029712096624`*^9, 
   3.494502971459262*^9}, 3.494503516196662*^9, 3.494503829677462*^9, 
   3.4945040884168625`*^9, {3.4945048365734625`*^9, 3.4945048388510623`*^9}, 
   3.4945053234112625`*^9, 3.494506585125662*^9, 3.494506989658062*^9, {
   3.494507295281062*^9, 3.4945072955150623`*^9}, {3.4945075946772623`*^9, 
   3.4945075948956623`*^9}, {3.4945080026654625`*^9, 
   3.4945080029462624`*^9}, {3.494531453510415*^9, 3.494531454419467*^9}, {
   3.494531829613927*^9, 3.494531829820939*^9}, {3.4945321328362703`*^9, 
   3.4945321341843476`*^9}, 3.494532991937408*^9, 3.494533610210771*^9, 
   3.49453420549782*^9, {3.495041265836632*^9, 3.495041278581854*^9}, {
   3.495041314978017*^9, 3.4950413186752234`*^9}, {3.4951440584373565`*^9, 
   3.495144059529358*^9}, {3.495213330135436*^9, 3.4952133379722624`*^9}, {
   3.4952133745053883`*^9, 3.4952134053429775`*^9}, {3.495214105250867*^9, 
   3.4952141109981956`*^9}, {3.4952141420569725`*^9, 3.495214211231929*^9}, {
   3.4952145558114347`*^9, 3.4952145885619125`*^9}, {3.4952271134024*^9, 
   3.4952272389514203`*^9}, {3.495237670283049*^9, 3.495237696959096*^9}, {
   3.496253756776331*^9, 3.496253773106265*^9}, {3.4988454174251833`*^9, 
   3.4988454196559873`*^9}, {3.498847125603893*^9, 3.4988471266490946`*^9}, {
   3.5783235540091653`*^9, 3.578323667710244*^9}, {3.578323763393673*^9, 
   3.5783238385741525`*^9}, {3.578323942691374*^9, 3.5783239653923545`*^9}, {
   3.578324000728011*^9, 3.578324141384001*^9}, {3.5783243568160973`*^9, 
   3.5783245702653604`*^9}, {3.5786853610286922`*^9, 3.578685376483986*^9}, {
   3.578742337582098*^9, 3.578742458803244*^9}, {3.5787437774455423`*^9, 
   3.5787437854837513`*^9}, {3.578833630690712*^9, 3.578833653865943*^9}, 
   3.578834183409741*^9, {3.578834630516046*^9, 3.578834632454303*^9}, {
   3.578834749486186*^9, 3.578834749591056*^9}, {3.578835353489999*^9, 
   3.578835354137299*^9}, 3.5795549891295223`*^9, {3.5795701521967373`*^9, 
   3.5795704311678114`*^9}, {3.579570462518814*^9, 3.579570609192501*^9}, {
   3.579570663466709*^9, 3.5795706658819437`*^9}, {3.579570733545538*^9, 
   3.579570773416422*^9}, {3.579571006542085*^9, 3.579571032134761*^9}, {
   3.579571078286455*^9, 3.5795711393239202`*^9}, {3.579571175724594*^9, 
   3.579571222284666*^9}, {3.579733296393281*^9, 3.579733297729516*^9}, {
   3.5798116833334007`*^9, 3.5798116840170317`*^9}, {3.5798233929521046`*^9, 
   3.579823395027022*^9}, {3.57982352417838*^9, 3.579823526530554*^9}, {
   3.5798236133868246`*^9, 3.5798236292584925`*^9}, 3.5798239008244658`*^9, {
   3.5798247026755147`*^9, 3.5798247059935803`*^9}, {3.579825274900349*^9, 
   3.579825278527701*^9}, {3.580673594138656*^9, 3.580673606151758*^9}, {
   3.580673689866125*^9, 3.5806736972519507`*^9}, {3.580844723784981*^9, 
   3.580844735934993*^9}, {3.5813591522315893`*^9, 3.5813591574517603`*^9}, {
   3.581359191610805*^9, 3.581359202301148*^9}, {3.58177456484824*^9, 
   3.581774569971402*^9}, 3.581939957629977*^9, {3.582276993844614*^9, 
   3.582276994114303*^9}, {3.582286259776084*^9, 3.5822862598311987`*^9}, {
   3.582649744803834*^9, 3.582649785141706*^9}, 3.582650901050786*^9, {
   3.5826575315187063`*^9, 3.58265753269414*^9}, {3.582734360781007*^9, 
   3.582734367721477*^9}, {3.5829722024319267`*^9, 3.582972204205662*^9}, {
   3.582979254327914*^9, 3.5829792562415953`*^9}, {3.583001558664032*^9, 
   3.583001558734474*^9}, {3.583013509917357*^9, 3.583013510134968*^9}, 
   3.5830176844717293`*^9, 3.583078670688794*^9, {3.583589219021187*^9, 
   3.5835892306124277`*^9}, {3.583591989921278*^9, 3.583591993562469*^9}, {
   3.583592034831744*^9, 3.5835920353393784`*^9}}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Lft", "\[Rule]", 
     FractionBox["1", "4"]}], ",", 
    RowBox[{"Lfh", "\[Rule]", 
     FractionBox["1", "16"]}], ",", 
    RowBox[{"ha", "\[Rule]", 
     FractionBox["1", "10"]}], ",", 
    RowBox[{"Lc", "\[Rule]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{"Lt", "\[Rule]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{"rfx", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["1", "9"]}]}], ",", 
    RowBox[{"rfz", "\[Rule]", 
     FractionBox["1", "27"]}], ",", 
    RowBox[{"rcx", "\[Rule]", "0"}], ",", 
    RowBox[{"rcz", "\[Rule]", 
     FractionBox["3", "8"]}], ",", 
    RowBox[{"rtx", "\[Rule]", "0"}], ",", 
    RowBox[{"rtz", "\[Rule]", 
     FractionBox["7", "40"]}], ",", 
    RowBox[{"rTx", "\[Rule]", "0"}], ",", 
    RowBox[{"rTz", "\[Rule]", 
     FractionBox["3", "40"]}], ",", 
    RowBox[{"wHip", "\[Rule]", 
     FractionBox[
      RowBox[{"p", "(", "1", ")"}], "4"]}], ",", 
    RowBox[{"wFoot", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"p", "(", "1", ")"}]}], "25"]}], ",", 
    RowBox[{"mf", "\[Rule]", 
     FractionBox["1", "10"]}], ",", 
    RowBox[{"mc", "\[Rule]", 
     FractionBox["3", "2"]}], ",", 
    RowBox[{"mt", "\[Rule]", "5"}], ",", 
    RowBox[{"mT", "\[Rule]", "20"}], ",", 
    RowBox[{"g", "\[Rule]", 
     FractionBox["981", "100"]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.583592035670568*^9, 3.583592096689454*^9}, {
  3.5835987825136747`*^9, 3.58359878333153*^9}, {3.5835995374096003`*^9, 
  3.5835995381580687`*^9}, {3.583617132737352*^9, 3.583617133278206*^9}, {
  3.583621037510919*^9, 3.5836210379482603`*^9}, {3.605280058617998*^9, 
  3.605280059452442*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"np", "=", "1"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "Number", " ", "of", " ", "parameters", " ", "that", " ", "can", " ", "be",
     " ", "passed", " ", "in", " ", "p", " ", 
    RowBox[{"arugment", "."}]}], " ", "*)"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.582506938371249*^9, 3.5825069606503477`*^9}, {
   3.5835892271034527`*^9, 3.5835892277127953`*^9}, 3.583591993562788*^9}],

Cell["State space", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.485611105489791*^9, 3.4856111154013577`*^9}, {
   3.580815270552294*^9, 3.5808152715589952`*^9}, {3.580819096749915*^9, 
   3.580819097717986*^9}, {3.580821627086256*^9, 3.58082162775817*^9}, {
   3.580827513958296*^9, 3.580827515254279*^9}, {3.580844804968649*^9, 
   3.580844806072349*^9}, {3.580858148553191*^9, 3.5808581492253857`*^9}, {
   3.581334832499361*^9, 3.581334833276869*^9}, {3.5813473916690283`*^9, 
   3.5813473922443037`*^9}, {3.5818482133087683`*^9, 3.581848214307775*^9}, 
   3.581939957630125*^9, {3.58359198992176*^9, 3.5835919935631323`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Qb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "[", "t", "]"}], ",", 
     RowBox[{
      SubscriptBox["p", "z"], "[", "t", "]"}], ",", 
     RowBox[{
      SubscriptBox["q", "y"], "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dQb", "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "Qb"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Xb", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Qb", ",", "dQb"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"Length", "[", "Qb", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5783246803370857`*^9, 3.5783247132324877`*^9}, {
   3.5783247474390993`*^9, 3.578324795920906*^9}, 3.5783261442720146`*^9, {
   3.578326368144912*^9, 3.578326420134959*^9}, 3.57882490280514*^9, 
   3.5795712070375614`*^9, {3.579571687589115*^9, 3.579571703436776*^9}, 
   3.579571735596527*^9, {3.580673741550891*^9, 3.5806737648233986`*^9}, {
   3.580679925628043*^9, 3.580679925799201*^9}, 3.5819399576301928`*^9, {
   3.583588940906156*^9, 3.583588951827054*^9}, {3.583591989922071*^9, 
   3.583591993563438*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nr", "=", "6"}], ";"}], "\n", 
 RowBox[{"Qr", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "#1"], "[", "t", "]"}], "&"}], ")"}], "/@", 
   RowBox[{"Range", "[", "nr", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"dQr", "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "Qr"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Xr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Qr", ",", "dQr"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4348998415914*^9, 3.4348998728382*^9}, {
   3.4348999758606*^9, 3.4348999820226*^9}, {3.4349000605685997`*^9, 
   3.434900078727*^9}, {3.4349002076142*^9, 3.4349002108746*^9}, {
   3.4349003921622*^9, 3.4349003968733997`*^9}, {3.4349031044564*^9, 
   3.4349031222092*^9}, {3.4349033544463997`*^9, 3.4349033847416*^9}, {
   3.434905033987*^9, 3.4349050435498*^9}, {3.4349052201886*^9, 
   3.4349052448688*^9}, {3.4350699032511997`*^9, 3.4350699037192*^9}, {
   3.435070016105*^9, 3.4350700168694*^9}, {3.4350703243970003`*^9, 
   3.435070324475*^9}, {3.43507063726*^9, 3.4350706395688*^9}, {
   3.4401625846896*^9, 3.4401625912316*^9}, {3.4404362916660004`*^9, 
   3.4404363701808004`*^9}, 3.442411325423357*^9, 3.455458349569009*^9, {
   3.4554588219994087`*^9, 3.455458901606209*^9}, {3.483182288981*^9, 
   3.4831822896986*^9}, 3.4831830194066*^9, {3.485610958414379*^9, 
   3.4856109855399303`*^9}, {3.4864645280864*^9, 3.4864645343576*^9}, {
   3.4864658750662003`*^9, 3.4864658796526003`*^9}, {3.4891631242463927`*^9, 
   3.4891632301684513`*^9}, {3.4891638028646107`*^9, 
   3.4891638065628223`*^9}, {3.4909727687047563`*^9, 
   3.4909727986054664`*^9}, {3.490973742044428*^9, 3.4909737607144957`*^9}, {
   3.4947646041195755`*^9, 3.494764609566887*^9}, {3.494764655668524*^9, 
   3.494764663716984*^9}, {3.5783246422969303`*^9, 3.5783246658797245`*^9}, {
   3.5783247260803614`*^9, 3.578324765208522*^9}, {3.578326370520108*^9, 
   3.5783264192391315`*^9}, 3.578417759155493*^9, 3.579570795853178*^9, {
   3.5795716785727744`*^9, 3.5795717332643695`*^9}, 3.5806737965096817`*^9, 
   3.581939957630237*^9, {3.58358896288894*^9, 3.5835889631734667`*^9}, {
   3.583591989922227*^9, 3.5835919935635967`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "2"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "3"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "4"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "5"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "6"], "(", "t", ")"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.5817827194139977`*^9, 3.5817830990623837`*^9, 3.581783388371901*^9, 
   3.5817859575000753`*^9, 3.581786079620899*^9, 3.5817861348257113`*^9, 
   3.581844890373982*^9, 3.581848215258906*^9, 3.581863471766572*^9, 
   3.5818767153183193`*^9, 3.5818769213532*^9, 3.5818795255094767`*^9, 
   3.5818867303128567`*^9, 3.581886792386718*^9, 3.5818872891060963`*^9, 
   3.581893058581696*^9, 3.5819398804460287`*^9, 3.581939957630288*^9, {
   3.581940038771364*^9, 3.5819400459232283`*^9}, {3.582277000586782*^9, 
   3.58227700125163*^9}, {3.582286199628812*^9, 3.582286200036016*^9}, {
   3.582286268736068*^9, 3.582286269163783*^9}, 3.58246538223895*^9, 
   3.5824654972760572`*^9, 3.582465971387512*^9, {3.58246934302757*^9, 
   3.5824693437436953`*^9}, {3.5825009164159107`*^9, 
   3.5825009176501083`*^9}, {3.582570509297018*^9, 3.582570509811132*^9}, {
   3.582580698157227*^9, 3.582580731502964*^9}, {3.5826349800821743`*^9, 
   3.582634980730311*^9}, {3.5826497689397573`*^9, 3.582649790726129*^9}, {
   3.582650905144147*^9, 3.5826509056933403`*^9}, {3.582657519807809*^9, 
   3.582657537220962*^9}, {3.582657632589658*^9, 3.582657633323464*^9}, 
   3.582734370220498*^9, {3.582972209776916*^9, 3.582972210418261*^9}, {
   3.582973431188574*^9, 3.582973450496842*^9}, {3.582975023272314*^9, 
   3.582975023908896*^9}, {3.5829792630524607`*^9, 3.582979263604332*^9}, {
   3.5830015658836193`*^9, 3.5830015665620747`*^9}, {3.583013514154018*^9, 
   3.5830135147668123`*^9}, {3.583016682676724*^9, 3.583016683504676*^9}, {
   3.5830176895552673`*^9, 3.583017690083477*^9}, 3.583078674563335*^9, 
   3.5835892780891314`*^9, 3.583591858937111*^9, {3.583591962120227*^9, 
   3.5835920967354937`*^9}, {3.5835987825738783`*^9, 
   3.5835987833847933`*^9}, {3.583599537628186*^9, 3.583599538177189*^9}, {
   3.583617132804913*^9, 3.583617133317689*^9}, {3.583621037558316*^9, 
   3.583621038124395*^9}, {3.605280058810011*^9, 3.605280059497834*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nl", "=", 
    RowBox[{"nr", "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "rigid", " ", 
    RowBox[{"links", "."}]}], " ", "*)"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.582469890744308*^9, 3.582469891752146*^9}, {
   3.582578241129855*^9, 3.582578278481859*^9}, {3.583588972975173*^9, 
   3.583588973508258*^9}, 3.5835919935639057`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Qb", ",", "Qr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dQ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"dQb", ",", "dQr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Q", ",", "dQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ne", "=", 
   RowBox[{"Length", "[", "Q", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.578324719333125*^9, 3.5783248115043077`*^9}, {
   3.5783263733277016`*^9, 3.5783264147830133`*^9}, {3.5795717407733154`*^9, 
   3.5795717748698583`*^9}, 3.581939957630342*^9, 3.5835919308192253`*^9, 
   3.583591993564065*^9}],

Cell["Subs for absolute coordinates", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581784788976655*^9, 3.5817847936496964`*^9}, {
   3.5818482160643587`*^9, 3.581848217067953*^9}, 3.581939957630405*^9, 
   3.583591930820216*^9, 3.5835919935644493`*^9}],

Cell["\<\
MATLAB shall pass the absolute coordinates as though they were relative \
coordinates according to this substitution list. It is a trivial pattern \
replacement.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5817847948731833`*^9, 3.581784835520631*^9}, 
   3.5819399576304617`*^9, 3.5835919308204937`*^9, 3.583591993564769*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Zeta]xsubs", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Qr", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}],
          "/.", "\[VeryThinSpace]", 
         RowBox[{"q", "\[Rule]", "\[Zeta]"}]}], ")"}], "->", 
       RowBox[{"Qr", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}],
       "&"}], ")"}], "/@", 
    RowBox[{"Range", "[", "nr", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Zeta]xsubs", "=", 
   RowBox[{"D", "[", 
    RowBox[{"\[Zeta]xsubs", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalZeta]xsubs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"\[Zeta]xsubs", ",", "d\[Zeta]xsubs"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5817789547521877`*^9, 3.5817790353416433`*^9}, {
   3.5817812703735313`*^9, 3.581781270801403*^9}, {3.581781305305296*^9, 
   3.581781317425208*^9}, {3.581784721104319*^9, 3.5817847230793324`*^9}, 
   3.5819399576305027`*^9, {3.5835890134118633`*^9, 3.5835890175051527`*^9}, 
   3.583591930820629*^9, 3.583591993564909*^9}],

Cell[BoxData[
 RowBox[{"statesubs", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Q", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"q", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", "ne", "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"dQ", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"dq", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", "ne", "]"}]}], ")"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4349049195298*^9, 3.4349049437878*^9}, {
   3.4349993545274*^9, 3.4349993797214003`*^9}, {3.435000560398*^9, 
   3.4350005632528*^9}, {3.4350707572384*^9, 3.4350707618248*^9}, {
   3.4350772253014*^9, 3.4350772254262*^9}, {3.435078153829*^9, 
   3.4350782220322*^9}, {3.4350782615002003`*^9, 3.435078291811*^9}, 
   3.4350790937412*^9, {3.4350808724442*^9, 3.4350808770618*^9}, {
   3.4350815963042*^9, 3.4350815983789997`*^9}, {3.43508206077*^9, 
   3.4350820940136003`*^9}, {3.4350823303828*^9, 3.4350823363887997`*^9}, {
   3.435082521709*^9, 3.435082526545*^9}, {3.4353196505144*^9, 
   3.4353196948028*^9}, {3.435319873376*^9, 3.435319887572*^9}, {
   3.4353208165694*^9, 3.4353208194554*^9}, 3.4353210966127996`*^9, {
   3.4353212670866003`*^9, 3.4353212719694*^9}, {3.4353221386418*^9, 
   3.4353221496865997`*^9}, {3.4353223965699997`*^9, 3.4353223966792*^9}, {
   3.4353226242363997`*^9, 3.4353226261084003`*^9}, 3.4353235871907997`*^9, {
   3.4353368037764*^9, 3.4353368071616*^9}, {3.4353408653612003`*^9, 
   3.4353408717572002`*^9}, {3.4402457169728003`*^9, 
   3.4402457170039997`*^9}, {3.4402460597356*^9, 3.4402460624344*^9}, {
   3.440246662159*^9, 3.4402466701774*^9}, {3.4402712213442*^9, 
   3.4402712531052*^9}, {3.4402718403542*^9, 3.4402718491412*^9}, {
   3.4403487309802*^9, 3.4403487681082*^9}, {3.4403558159737997`*^9, 
   3.4403558578733997`*^9}, {3.4404236020412006`*^9, 
   3.4404236097008004`*^9}, {3.4404259997788005`*^9, 
   3.4404260399010005`*^9}, {3.4404385449296007`*^9, 
   3.4404385890630007`*^9}, {3.4404386440508003`*^9, 3.4404386584964004`*^9}, 
   3.4404395871088004`*^9, {3.440512097489174*^9, 3.4405121122935734`*^9}, 
   3.4406969117755737`*^9, {3.440705955990574*^9, 3.440705977159774*^9}, {
   3.440706170350174*^9, 3.4407061722065735`*^9}, {3.4407063815585737`*^9, 
   3.4407063820889735`*^9}, {3.4407067030823736`*^9, 
   3.4407067030823736`*^9}, {3.4407067839059734`*^9, 
   3.4407067883675737`*^9}, {3.4407068923727736`*^9, 3.4407068946347733`*^9}, 
   3.440768144048174*^9, {3.4407685888667736`*^9, 3.4407685998491735`*^9}, {
   3.4407690714937735`*^9, 3.440769106734174*^9}, 3.440780711814364*^9, {
   3.4409368493343477`*^9, 3.4409368579143476`*^9}, 3.440937052120748*^9, 
   3.4409512258825846`*^9, {3.440956158778185*^9, 3.440956158856185*^9}, {
   3.440956558182585*^9, 3.440956558712985*^9}, {3.440958204138585*^9, 
   3.4409582151365848`*^9}, {3.4409594130609846`*^9, 3.4409594175069847`*^9}, 
   3.441022061446353*^9, {3.4410228332095532`*^9, 3.4410228364699535`*^9}, {
   3.4410230877683535`*^9, 3.441023092479553*^9}, 3.441023136414753*^9, 
   3.441023168408553*^9, 3.441023627056353*^9, {3.441023820573553*^9, 
   3.441023834084153*^9}, 3.4410368933567533`*^9, 3.4410370482313533`*^9, {
   3.441038713002353*^9, 3.4410387191955533`*^9}, {3.441039431232353*^9, 
   3.4410394353819532`*^9}, {3.441136957010053*^9, 3.441136962251653*^9}, {
   3.4411372581532536`*^9, 3.441137262115653*^9}, {3.4415512244094*^9, 
   3.4415512464678*^9}, {3.4415516053494*^9, 3.4415516054742002`*^9}, {
   3.441998499572547*^9, 3.4419985050637465`*^9}, {3.442062672618947*^9, 
   3.4420626763005466`*^9}, {3.442065799594947*^9, 3.442065800920947*^9}, 
   3.442411325423357*^9, {3.455459616851609*^9, 3.455459620720409*^9}, {
   3.455632439318109*^9, 3.4556325240729094`*^9}, {3.4564869824795*^9, 
   3.4564870056455*^9}, {3.4564877199238997`*^9, 3.4564877233403*^9}, {
   3.457703557511973*^9, 3.457703557792773*^9}, 3.4577037077459726`*^9, {
   3.4831100776988*^9, 3.4831100778236*^9}, {3.4831102065236*^9, 
   3.4831102068512*^9}, {3.4831246610252*^9, 3.4831246622108*^9}, 
   3.4831885579214*^9, {3.4831888486552*^9, 3.4831888502464*^9}, {
   3.4831888982164*^9, 3.4831889029588003`*^9}, {3.4831892709578*^9, 
   3.4831892750762*^9}, {3.4831894285824003`*^9, 3.4831894537296*^9}, {
   3.4831954980938*^9, 3.4831955030702*^9}, {3.4831957806684*^9, 
   3.4831957809024*^9}, {3.4831959049547997`*^9, 3.4831959094632*^9}, {
   3.4831959744332*^9, 3.4831959822799997`*^9}, {3.4831961390518*^9, 
   3.4831961447302*^9}, {3.4831962051949997`*^9, 3.4831962100934*^9}, {
   3.4831963744941998`*^9, 3.4831963788154*^9}, {3.4831965001776*^9, 
   3.48319650024*^9}, {3.4831966132066*^9, 3.4831966175278*^9}, 
   3.4831967075312*^9, {3.4832268151275997`*^9, 3.4832268215704*^9}, {
   3.4832268967478*^9, 3.4832269037834*^9}, {3.4832269452304*^9, 
   3.4832269828398*^9}, {3.48328266052*^9, 3.4832826627352*^9}, {
   3.4832828444351997`*^9, 3.4832828520168*^9}, {3.4832838323996*^9, 
   3.4832838353324003`*^9}, {3.4832839270184*^9, 3.4832839490924*^9}, {
   3.4832841018272*^9, 3.4832841499063997`*^9}, {3.4832848887022*^9, 
   3.4832848913542*^9}, {3.4832859365924*^9, 3.4832859395408*^9}, {
   3.483286230758*^9, 3.483286234502*^9}, {3.483286514528*^9, 
   3.4832865204091997`*^9}, {3.4832867553842*^9, 3.483286763309*^9}, 
   3.484816737328931*^9, {3.4848218831551*^9, 3.484821884785102*^9}, {
   3.484822006125275*^9, 3.484822008725279*^9}, {3.4848224874192257`*^9, 
   3.4848224899392295`*^9}, {3.4848225433593044`*^9, 
   3.4848225508493147`*^9}, {3.4848269284363728`*^9, 
   3.4848269286393843`*^9}, {3.484827282888646*^9, 3.4848272847107506`*^9}, 
   3.484827399002288*^9, {3.4848283446413755`*^9, 3.4848283446983786`*^9}, {
   3.4848284469372263`*^9, 3.484828446966228*^9}, {3.484828550201133*^9, 
   3.4848285859191756`*^9}, {3.4848301764965596`*^9, 3.4848301785713634`*^9}, 
   3.4848306463432703`*^9, {3.48483120953685*^9, 3.484831223116869*^9}, {
   3.4848330221038723`*^9, 3.484833026455121*^9}, {3.484833082697338*^9, 
   3.4848331083778067`*^9}, {3.4848331670571632`*^9, 3.484833167232173*^9}, {
   3.484833213673829*^9, 3.4848332418394403`*^9}, 3.484833281952735*^9, {
   3.4848333129135056`*^9, 3.4848333396630354`*^9}, {3.4848335540893*^9, 
   3.484833556432434*^9}, {3.4848336932432594`*^9, 3.484833695899411*^9}, {
   3.4848339707931337`*^9, 3.484833973095266*^9}, {3.4856123915183477`*^9, 
   3.485612422821138*^9}, {3.4863903390634003`*^9, 3.48639041552*^9}, {
   3.4863904950956*^9, 3.4863904984496*^9}, {3.486400968980678*^9, 
   3.4864009697067194`*^9}, {3.4864014375874805`*^9, 3.486401443504819*^9}, {
   3.4864688787018003`*^9, 3.4864688824146*^9}, {3.486468987585*^9, 
   3.4864689891605997`*^9}, {3.486469233889*^9, 3.4864692542938004`*^9}, {
   3.4864711921730003`*^9, 3.4864712206429996`*^9}, {3.4867480347042*^9, 
   3.4867480364358*^9}, {3.4867481319234*^9, 3.4867481334834003`*^9}, {
   3.4867483290202*^9, 3.4867483409698*^9}, {3.4921659225198526`*^9, 
   3.492166046371937*^9}, {3.4921691741448355`*^9, 3.4921691855484877`*^9}, {
   3.4921879975834217`*^9, 3.4921881184413347`*^9}, 3.4921882018191037`*^9, {
   3.492277260820487*^9, 3.4922772772584267`*^9}, {3.4922777953010573`*^9, 
   3.4922778047395973`*^9}, 3.4922780255822287`*^9, {3.4922832515609217`*^9, 
   3.4922832623605394`*^9}, 3.4923429715279937`*^9, {3.4927756166174994`*^9, 
   3.49277566540129*^9}, {3.4927759034689064`*^9, 3.4927759060930567`*^9}, {
   3.4927889996717625`*^9, 3.4927890003227997`*^9}, 3.4927892543013268`*^9, {
   3.4927902190878315`*^9, 3.492790226855275*^9}, {3.4927908139108534`*^9, 
   3.4927908325419188`*^9}, 3.4927909931471047`*^9, 3.4929495622029724`*^9, {
   3.4929607972273912`*^9, 3.4929608099951215`*^9}, {3.492961149218524*^9, 
   3.492961153382762*^9}, {3.4929614574801555`*^9, 3.4929614659606404`*^9}, {
   3.4929656954565535`*^9, 3.492965701445896*^9}, {3.4929664615983744`*^9, 
   3.492966461882391*^9}, {3.493987401292*^9, 3.4939874046148*^9}, {
   3.4939956223234*^9, 3.493995625459*^9}, 3.4939959174354*^9, {
   3.4940849076731997`*^9, 3.4940849108087997`*^9}, {3.4940851696862*^9, 
   3.4940851717922*^9}, {3.494171928530195*^9, 3.4941719303709955`*^9}, {
   3.494172120098195*^9, 3.494172121470995*^9}, 3.4941722020937953`*^9, 
   3.494174973218395*^9, {3.4942487727191954`*^9, 3.494248773467995*^9}, {
   3.494248808427595*^9, 3.494248808536795*^9}, {3.494248863214795*^9, 
   3.4942488714671955`*^9}, {3.494259904747795*^9, 3.494259905293795*^9}, {
   3.494264544928195*^9, 3.494264545224595*^9}, {3.494264905030795*^9, 
   3.494264907791995*^9}, {3.4942649905421953`*^9, 3.4942649942549953`*^9}, {
   3.4942653546383953`*^9, 3.494265357789595*^9}, {3.494266386375595*^9, 
   3.494266390447195*^9}, {3.4942703487415953`*^9, 3.494270352875595*^9}, {
   3.4942831411646953`*^9, 3.494283143192695*^9}, {3.494284565631895*^9, 
   3.494284567597495*^9}, {3.494285628350695*^9, 3.4942856319698954`*^9}, {
   3.494339417782056*^9, 3.4943394186088557`*^9}, {3.494339874431256*^9, 
   3.4943398751488557`*^9}, {3.4943399776876554`*^9, 
   3.4943399966104555`*^9}, {3.4943554965789967`*^9, 3.494355497826997*^9}, 
   3.494356740498597*^9, {3.494357307809597*^9, 3.494357307871997*^9}, {
   3.494370752258197*^9, 3.494370752507797*^9}, {3.494420794734397*^9, 
   3.4944208029243965`*^9}, {3.494421053586997*^9, 3.494421056067397*^9}, {
   3.494422391154397*^9, 3.4944224006547966`*^9}, {3.494423121156397*^9, 
   3.494423122575997*^9}, 3.494423808461197*^9, {3.4944356069039965`*^9, 
   3.4944356071223965`*^9}, {3.4944409384582624`*^9, 3.494440938723462*^9}, 
   3.4944438111382623`*^9, {3.4944521517846622`*^9, 3.4944521520030622`*^9}, {
   3.494502618698262*^9, 3.494502620788662*^9}, {3.4945029712096624`*^9, 
   3.494502971459262*^9}, 3.494503516196662*^9, 3.494503829677462*^9, 
   3.4945040884168625`*^9, {3.4945048365734625`*^9, 3.4945048388510623`*^9}, 
   3.4945053234112625`*^9, 3.494506585125662*^9, 3.494506989658062*^9, {
   3.494507295281062*^9, 3.4945072955150623`*^9}, {3.4945075946772623`*^9, 
   3.4945075948956623`*^9}, {3.4945080026654625`*^9, 
   3.4945080029462624`*^9}, {3.494531453510415*^9, 3.494531454419467*^9}, {
   3.494531829613927*^9, 3.494531829820939*^9}, {3.4945321328362703`*^9, 
   3.4945321341843476`*^9}, 3.494532991937408*^9, 3.494533610210771*^9, 
   3.49453420549782*^9, {3.495041265836632*^9, 3.495041278581854*^9}, {
   3.495041314978017*^9, 3.4950413186752234`*^9}, {3.4951440584373565`*^9, 
   3.495144059529358*^9}, {3.495213330135436*^9, 3.4952133379722624`*^9}, {
   3.4952133745053883`*^9, 3.4952134053429775`*^9}, {3.495214105250867*^9, 
   3.4952141109981956`*^9}, {3.4952141420569725`*^9, 3.495214211231929*^9}, {
   3.4952145558114347`*^9, 3.4952145885619125`*^9}, {3.4952271134024*^9, 
   3.4952272389514203`*^9}, {3.495237670283049*^9, 3.495237696959096*^9}, 
   3.496253756776331*^9, {3.497179598420119*^9, 3.497179602708788*^9}, {
   3.5783263005044003`*^9, 3.5783263378729353`*^9}, {3.57839511403271*^9, 
   3.5783951407614284`*^9}, {3.578742490455744*^9, 3.578742490766797*^9}, 
   3.581939957630549*^9, {3.582469924555224*^9, 3.582469939766259*^9}, 
   3.583591930820785*^9, 3.583591993565064*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "1", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "z"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "2", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "y"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "3", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "4", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "5", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "6", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "7", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "8", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "9", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "x"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "1", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "z"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "2", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "y"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "3", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "4", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "5", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "3"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "6", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "4"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "7", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "5"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "8", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "6"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "9", ")"}]}]}], "}"}], TraditionalForm]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.5817827195282087`*^9, 3.581783099139752*^9, 3.581783388419141*^9, 
   3.581785957655531*^9, 3.58178607969611*^9, 3.58178613489844*^9, 
   3.581844890463437*^9, 3.581848218811594*^9, 3.581863471895368*^9, 
   3.581876715372324*^9, 3.581876921525132*^9, 3.581879525558455*^9, 
   3.5818867303650503`*^9, 3.581886792436983*^9, 3.5818872891822567`*^9, 
   3.5818930586331873`*^9, 3.581939880523387*^9, 3.581939957630603*^9, {
   3.581940038932426*^9, 3.581940045981552*^9}, {3.582277000650238*^9, 
   3.582277001334898*^9}, {3.582286199696604*^9, 3.582286200095035*^9}, {
   3.5822862687872047`*^9, 3.5822862692176847`*^9}, 3.582465382332464*^9, 
   3.582465497333976*^9, 3.582465971449102*^9, {3.582469343099393*^9, 
   3.582469343809844*^9}, 3.582469943073304*^9, {3.582500916542289*^9, 
   3.582500917749103*^9}, {3.5825705093996277`*^9, 3.582570509941862*^9}, {
   3.5825806982664347`*^9, 3.582580731607765*^9}, {3.582634980136092*^9, 
   3.582634980784093*^9}, {3.582649768986602*^9, 3.582649790777063*^9}, {
   3.582650905193618*^9, 3.5826509057674017`*^9}, {3.582657519862194*^9, 
   3.5826575372749233`*^9}, {3.582657632652636*^9, 3.5826576333805113`*^9}, 
   3.5827343702949657`*^9, {3.582972209825449*^9, 3.582972210492146*^9}, {
   3.582973431255719*^9, 3.5829734505823*^9}, {3.582975023329276*^9, 
   3.582975023990842*^9}, {3.5829792631031637`*^9, 3.582979263675145*^9}, {
   3.5830015659393806`*^9, 3.583001566640011*^9}, {3.5830135142042828`*^9, 
   3.583013514853228*^9}, {3.5830166827450743`*^9, 3.583016683585575*^9}, {
   3.5830176896244297`*^9, 3.583017690153226*^9}, 3.583078674683585*^9, 
   3.583589278162271*^9, 3.5835918590067177`*^9, 3.583591930820961*^9, 
   3.5835919622680273`*^9, {3.5835919935652237`*^9, 3.5835920967802*^9}, {
   3.583598782730961*^9, 3.5835987834464493`*^9}, {3.583599537718421*^9, 
   3.583599538248931*^9}, {3.583617132895555*^9, 3.5836171333995323`*^9}, {
   3.5836210376234007`*^9, 3.583621038199902*^9}, {3.605280058973127*^9, 
   3.6052800595354233`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mf", ",", "mc", ",", "mt", ",", "mT", ",", "mt", ",", "mc", ",", "mf"}],
      "}"}], "/.", "constsubs"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.455459467232009*^9, 3.455459479540409*^9}, {
   3.4554595164032087`*^9, 3.455459517292409*^9}, {3.492188011584223*^9, 
   3.4921880120392485`*^9}, {3.5783261208563747`*^9, 3.57832612151198*^9}, {
   3.5784178965145197`*^9, 3.578417898410273*^9}, {3.57841834867467*^9, 
   3.578418353755369*^9}, {3.578742496594079*^9, 3.578742499192305*^9}, {
   3.5795708092605815`*^9, 3.5795708127478075`*^9}, {3.580828678985723*^9, 
   3.580828686807123*^9}, 3.580844792222456*^9, {3.581351605620186*^9, 
   3.5813516073716087`*^9}, 3.5819399576306562`*^9, {3.5835890305371304`*^9, 
   3.5835890361444607`*^9}, 3.583591930821106*^9, 3.583591993565373*^9}],

Cell["Useful functions", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4404317665824003`*^9, 3.4404317725728006`*^9}, {
   3.4427788776184*^9, 3.4427788792564*^9}, {3.4857074415682583`*^9, 
   3.485707447948658*^9}, {3.4954551277859*^9, 3.4954551288623*^9}, {
   3.5808152755193043`*^9, 3.5808152762309217`*^9}, {3.580827518014645*^9, 
   3.580827518662883*^9}, {3.581345042609646*^9, 3.581345043228314*^9}, {
   3.581346635409398*^9, 3.581346636092885*^9}, 3.581939957630718*^9, 
   3.583591930821447*^9, 3.583591993565724*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CrossProd", "[", "\[CapitalOmega]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.485706888267458*^9, 3.485706935348258*^9}, {
   3.4857070676674585`*^9, 3.485707073392658*^9}, 3.581939957630782*^9, 
   3.583591930821747*^9, 3.583591993566031*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelSimplify", "[", 
   RowBox[{"A_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelSimplify", "[", 
   RowBox[{"A_", "?", "VectorQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelSimplify", "[", "A_", "]"}], ":=", 
  RowBox[{"Simplify", "[", "A", "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.525444031603923*^9, 3.525444057323394*^9}, 
   3.525444167371688*^9, {3.5254442077009945`*^9, 3.5254442142373686`*^9}, {
   3.5254442656763105`*^9, 3.52544431862834*^9}, {3.5254446389836626`*^9, 
   3.525444643198904*^9}, {3.5273464706540365`*^9, 3.527346473775215*^9}, 
   3.527423798626493*^9, {3.5387532837469378`*^9, 3.5387532943515444`*^9}, 
   3.581939957630828*^9, 3.5835919308219023`*^9, 3.583591993566185*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelFullSimplify", "[", 
   RowBox[{"A_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelFullSimplify", "[", 
   RowBox[{"A_", "?", "VectorQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelFullSimplify", "[", "A_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", "A", "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581008894965406*^9, 3.581008912634509*^9}, 
   3.581939957630871*^9, 3.583591930822054*^9, 3.583591993566378*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AxisScalarToVector", "[", "axis_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sign", "[", "axis", "]"}], 
   RowBox[{"UnitVector", "[", 
    RowBox[{"3", ",", 
     RowBox[{"Abs", "[", "axis", "]"}]}], "]"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.580822010688099*^9, 3.5808220271533957`*^9}, {
   3.580822094745556*^9, 3.5808220959624166`*^9}, 3.580847041074833*^9, 
   3.5819399576309147`*^9, 3.583591930822208*^9, 3.583591993566457*^9}],

Cell[BoxData[
 RowBox[{"BlockDiagonalMatrix", ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
       RowBox[{"{", "##", "}"}]}], "]"}], "//", "Normal"}], ")"}], 
   "&"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5808470291591377`*^9, 3.580847040299953*^9}, 
   3.5819399576309566`*^9, 3.583591930822509*^9, 3.58359199356651*^9}],

Cell["Write files to disk", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.4438784331203923`*^9, 3.4438784402963924`*^9}, {
   3.580822097718912*^9, 3.58082209833424*^9}, {3.581784866937538*^9, 
   3.5817848715201683`*^9}, 3.581939957631015*^9, 3.583591930823173*^9, 
   3.583591993566622*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"fname_", "?", "StringQ"}]}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stream", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"builddir", ",", 
         RowBox[{"fname", "<>", "\"\<.math\>\""}]}], "}"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Write", "[", 
     RowBox[{"stream", ",", 
      RowBox[{"expr", "/.", "statesubs"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "stream", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "stream", "]"}], ";"}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5783512518387775`*^9, 3.578351515833716*^9}, {
   3.578351691684667*^9, 3.578351694675142*^9}, {3.5784130545207186`*^9, 
   3.5784130692713594`*^9}, {3.578414646377844*^9, 3.578414650035226*^9}, {
   3.5784153008200617`*^9, 3.5784153040750737`*^9}, 3.578828120680715*^9, {
   3.5795713120457034`*^9, 3.579571334495472*^9}, {3.581336277917783*^9, 
   3.5813362787555437`*^9}, 3.581939957631076*^9, 3.583591930823743*^9, 
   3.583591993566722*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"fname_", "?", "StringQ"}]}], "]"}], ":=", 
  RowBox[{"WriteExpr", "[", 
   RowBox[{
    RowBox[{"expr", "/.", "\[CapitalZeta]xsubs"}], ",", "fname"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5783512518387775`*^9, 3.578351515833716*^9}, {
   3.578351691684667*^9, 3.578351694675142*^9}, {3.5784130545207186`*^9, 
   3.5784130692713594`*^9}, {3.578414646377844*^9, 3.578414650035226*^9}, {
   3.5784153008200617`*^9, 3.5784153040750737`*^9}, 3.578828120680715*^9, {
   3.5795713120457034`*^9, 3.579571334495472*^9}, {3.581336277917783*^9, 
   3.5813362787555437`*^9}, {3.581784874415187*^9, 3.58178487464147*^9}, {
   3.581784920250252*^9, 3.5817849571708193`*^9}, 3.5819399576311207`*^9, {
   3.582571131376226*^9, 3.582571158628036*^9}, 3.583591930824038*^9, 
   3.583591993566774*^9}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"wHip", "=", 
    RowBox[{"-", "1"}]}], TraditionalForm]]],
 " is left left stance"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.580673871876334*^9, 3.580673881606326*^9}, {
   3.5806740085726647`*^9, 3.580674012075903*^9}, {3.580819153355012*^9, 
   3.580819158373939*^9}, {3.58084474790783*^9, 3.5808447490885153`*^9}, {
   3.580930073261314*^9, 3.580930074092037*^9}, {3.5813337870604057`*^9, 
   3.581333787860118*^9}, 3.5819399576311607`*^9, 3.583591930824287*^9, 
   3.58359199356682*^9}],

Cell["Compatibility with amber_suite", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5813337391321697`*^9, 3.581333747603447*^9}, 
   3.5819399576312237`*^9, 3.5835919308251247`*^9, 3.583591993566935*^9}],

Cell["Hash maps", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581330920796776*^9, 3.581330921715345*^9}, 
   3.58193995763131*^9, 3.5835919308255997`*^9, 3.583591993567087*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AxisToVector", "[", "\"\<x\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxisToVector", "[", "\"\<y\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxisToVector", "[", "\"\<z\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581333463867793*^9, 3.58133348138188*^9}, {
   3.5813335435530977`*^9, 3.581333583925572*^9}, 3.5819399576313753`*^9, 
   3.583591930825899*^9, 3.583591993567184*^9}],

Cell["Prismatic Twists", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581333717564124*^9, 3.58133372122797*^9}, 
   3.581939957631434*^9, 3.583591930826283*^9, 3.583591993567292*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTwist", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"origin_", "?", "VectorQ"}], "/;", 
     RowBox[{
      RowBox[{"Length", "[", "origin", "]"}], "\[Equal]", "3"}]}], ",", 
    RowBox[{
     RowBox[{"axis_", "?", "StringQ"}], "/;", 
     RowBox[{"StringMatchQ", "[", 
      RowBox[{"axis", ",", 
       RowBox[{"RegularExpression", "[", "\"\<-?P[x-z]\>\"", "]"}]}], 
      "]"}]}]}], "]"}], ":=", 
  RowBox[{"PrismaticTwist", "[", 
   RowBox[{"origin", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringMatchQ", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"axis", ",", "1"}], "]"}], ",", "\"\<-\>\""}], "]"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "]"}], "*", 
     RowBox[{"AxisToVector", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"axis", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.58133259803328*^9, 3.581332618615337*^9}, {
   3.5813328956388702`*^9, 3.5813329020313787`*^9}, {3.581332982199522*^9, 
   3.581333027155657*^9}, {3.581333061065323*^9, 3.5813330611548986`*^9}, {
   3.581333314316245*^9, 3.581333359185218*^9}, {3.581333396357369*^9, 
   3.581333396532571*^9}, {3.5813334286083117`*^9, 3.5813334623451633`*^9}, {
   3.581333591514027*^9, 3.581333595650236*^9}, {3.581335231970172*^9, 
   3.581335249010725*^9}, {3.581335904116515*^9, 3.58133590662761*^9}, 
   3.5819399576314917`*^9, 3.582657750188163*^9, {3.5829750039012747`*^9, 
   3.5829750138637333`*^9}, 3.583591930826584*^9, 3.583591993567389*^9}],

Cell["RevoluteTwists", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.581333723148056*^9, 3.5813337244519873`*^9}, {
   3.5813348438600273`*^9, 3.581334844524572*^9}, {3.581335283460101*^9, 
   3.581335284347176*^9}, 3.5819399576315536`*^9, 3.5835919308269167`*^9, 
   3.583591993567498*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTwist", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"origin_", "?", "VectorQ"}], "/;", 
     RowBox[{
      RowBox[{"Length", "[", "origin", "]"}], "\[Equal]", "3"}]}], ",", 
    RowBox[{
     RowBox[{"axis_", "?", "StringQ"}], "/;", 
     RowBox[{"StringMatchQ", "[", 
      RowBox[{"axis", ",", 
       RowBox[{"RegularExpression", "[", "\"\<-?R[x-z]\>\"", "]"}]}], 
      "]"}]}]}], "]"}], ":=", 
  RowBox[{"RevoluteTwist", "[", 
   RowBox[{"origin", ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringMatchQ", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"axis", ",", "1"}], "]"}], ",", "\"\<-\>\""}], "]"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"+", "1"}]}], "]"}], "*", 
     RowBox[{"AxisToVector", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"axis", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.58133259803328*^9, 3.581332618615337*^9}, {
   3.5813328956388702`*^9, 3.5813329020313787`*^9}, {3.581332982199522*^9, 
   3.581333027155657*^9}, {3.581333061065323*^9, 3.5813330611548986`*^9}, {
   3.581333314316245*^9, 3.581333359185218*^9}, {3.581333396357369*^9, 
   3.581333396532571*^9}, {3.5813334286083117`*^9, 3.5813334623451633`*^9}, {
   3.581333591514027*^9, 3.5813336276310253`*^9}, 3.581335263338542*^9, {
   3.5813358954846697`*^9, 3.5813358994696093`*^9}, 3.581939957631612*^9, 
   3.58359193082721*^9, 3.583591993567597*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Physical Configuration", "Section",
 CellChangeTimes->{{3.580724214202366*^9, 3.580724221898347*^9}, {
  3.581888167053402*^9, 3.581888170221246*^9}}],

Cell["\<\
The configuration in this section is emitted as YAML for the SVA model. The \
configuration is also important for later sections in this file.\
\>", "Text",
 CellChangeTimes->{{3.581888173436742*^9, 3.581888209108738*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TwistAxesBase", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Px\>\"", ",", "\"\<Pz\>\"", ",", "\"\<Ry\>\""}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"TwistAxesRobot", "=", 
   RowBox[{"Flatten", "@@", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Reverse", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"-", "2"}]}], "]"}], "&"}], ")"}], "/@", "#1"}], 
          "]"}]}], "]"}], "&"}], ")"}], "/@", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<-Ry\>\"", ",", "\"\<-Ry\>\"", ",", "\"\<-Ry\>\""}], "}"}],
       "}"}]}]}]}], ";"}], "\n", 
 RowBox[{"TwistAxesExt", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"TwistAxesBase", ",", "TwistAxesRobot"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.581332319002417*^9, 3.581332428900612*^9}, {
  3.581332472738452*^9, 3.581332526764078*^9}, {3.581333800525593*^9, 
  3.581333834767665*^9}, {3.583589059821616*^9, 3.583589080687668*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"Px\"\>", ",", "\<\"Pz\"\>", ",", "\<\"Ry\"\>", 
    ",", "\<\"-Ry\"\>", ",", "\<\"-Ry\"\>", ",", "\<\"-Ry\"\>", 
    ",", "\<\"Ry\"\>", ",", "\<\"Ry\"\>", ",", "\<\"Ry\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581782724585147*^9, 3.5817831036968603`*^9, 3.581783388540222*^9, 
   3.581785958028616*^9, 3.581786079890615*^9, 3.5817861350723877`*^9, 
   3.581844890616776*^9, 3.581848244928686*^9, 3.58186347212169*^9, 
   3.581876715518177*^9, 3.58187692160992*^9, 3.581879525649953*^9, 
   3.581886730467321*^9, 3.581886792535162*^9, 3.581887289341546*^9, 
   3.5818930587705593`*^9, 3.581939880710534*^9, 3.581940046116845*^9, 
   3.582277001516262*^9, 3.582286200199205*^9, 3.582286269316819*^9, 
   3.582465973628274*^9, 3.5824693440426083`*^9, 3.582500917880548*^9, 
   3.5825705100167294`*^9, {3.582580698424323*^9, 3.5825807319863462`*^9}, 
   3.582634981062141*^9, {3.582649769583613*^9, 3.582649790872654*^9}, 
   3.582650905896797*^9, {3.582657520916605*^9, 3.58265753738019*^9}, 
   3.5826576337955*^9, 3.582734370532394*^9, 3.58297221064384*^9, {
   3.582973432435341*^9, 3.582973450739766*^9}, 3.582975024180346*^9, 
   3.582979263800747*^9, 3.583001566794877*^9, 3.583013514963344*^9, 
   3.5830166837332563`*^9, 3.583017690271359*^9, 3.583589305203072*^9, 
   3.583592112555532*^9, 3.583598783643464*^9, 3.5835995384074593`*^9, 
   3.583617133658021*^9, 3.583621038281489*^9, 3.605280059610969*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"JointOffsetsSTT", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Lc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Lt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "wHip", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "Lt"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "Lc"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Lft", ",", "0", ",", 
        RowBox[{"-", "ha"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    "constsubs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580724432961009*^9, 3.5807244845097303`*^9}, {
   3.580724671807139*^9, 3.580724673578429*^9}, 3.580724783701446*^9, {
   3.580725266530995*^9, 3.5807252713016987`*^9}, {3.580726095682907*^9, 
   3.580726099896419*^9}, {3.58081889848599*^9, 3.580818898782929*^9}, {
   3.5808189535178957`*^9, 3.580818989799172*^9}, {3.580819068485573*^9, 
   3.5808190853094063`*^9}, {3.5808196914538097`*^9, 3.580819694893911*^9}, {
   3.58082075360474*^9, 3.5808207538133297`*^9}, {3.580821207469139*^9, 
   3.580821210182053*^9}, {3.5808212993974524`*^9, 3.580821299557679*^9}, 
   3.580821696069129*^9, {3.580844692542205*^9, 3.5808446935022497`*^9}, {
   3.581173396219589*^9, 3.5811733965315857`*^9}, {3.581181227435238*^9, 
   3.5811812395322113`*^9}, {3.5813338821655693`*^9, 3.581333882536539*^9}, {
   3.581334860682025*^9, 3.581334860957574*^9}, {3.5813541556914997`*^9, 
   3.5813541598669777`*^9}, {3.583589090738748*^9, 3.58358909687551*^9}}],

Cell["Compute the origins of the joints relative to the stance toe", "Text",
 CellChangeTimes->{{3.5808201005494127`*^9, 3.5808201118693933`*^9}, {
  3.580821696846725*^9, 3.5808216975660954`*^9}, {3.58082204115932*^9, 
  3.58082204212609*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"JointOriginsSTT", "=", 
   RowBox[{"Accumulate", "[", "JointOffsetsSTT", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580724489380122*^9, 3.58072450872635*^9}, {
   3.580724630592753*^9, 3.580724651633196*^9}, {3.580724688772756*^9, 
   3.5807247429758053`*^9}, {3.580724775369483*^9, 3.580725061555231*^9}, {
   3.5807251159536037`*^9, 3.5807252189757357`*^9}, {3.580725282296115*^9, 
   3.5807252897903147`*^9}, {3.580725359409007*^9, 3.5807254013615522`*^9}, {
   3.580815360776401*^9, 3.580815363399994*^9}, {3.5808155177126083`*^9, 
   3.580815536654807*^9}, {3.580818610930954*^9, 3.5808186314268513`*^9}, {
   3.580818775202483*^9, 3.580818849099401*^9}, {3.580818906378902*^9, 
   3.580818906619073*^9}, {3.580819076635128*^9, 3.580819081931196*^9}, {
   3.580819702291246*^9, 3.580819707915135*^9}, {3.580820766186647*^9, 
   3.5808207662427998`*^9}, {3.580820804849626*^9, 3.5808208200406847`*^9}, {
   3.581173412289661*^9, 3.581173413880731*^9}, {3.581181380889876*^9, 
   3.581181383713991*^9}, 3.581181555215173*^9, {3.58133424124848*^9, 
   3.581334247185072*^9}, {3.581334866601038*^9, 3.581334867863824*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComOffsetsSTT", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rfx", ",", "0", ",", "rfz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rcx", ",", "0", ",", "rcz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rtx", ",", "0", ",", "rtz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rTx", ",", 
        FractionBox["wHip", "2"], ",", "rTz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rtx", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "Lt"}], "+", "rtz"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rcx", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "Lc"}], "+", "rcz"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Lft", "+", "rfx"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "ha"}], "+", "rfz"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], "/.", "constsubs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.578834783294169*^9, 3.5788349878914557`*^9}, {
   3.578835237226836*^9, 3.578835241708209*^9}, 3.5788353467274*^9, {
   3.5795712557446203`*^9, 3.5795712878503213`*^9}, {3.579571343998262*^9, 
   3.579571345014203*^9}, {3.5795713958782578`*^9, 3.579571487401924*^9}, {
   3.580724270990967*^9, 3.580724271828389*^9}, {3.580724326778311*^9, 
   3.580724346248258*^9}, 3.5807244270993757`*^9, {3.580725447690282*^9, 
   3.580725464906304*^9}, {3.5807255792826033`*^9, 3.5807256356944036`*^9}, {
   3.5807256686940813`*^9, 3.58072570199092*^9}, {3.580725789306397*^9, 
   3.580725789751421*^9}, {3.580817904229738*^9, 3.580817926589962*^9}, {
   3.580819043366613*^9, 3.5808190518379717`*^9}, {3.580819483935039*^9, 
   3.580819514606*^9}, 3.580821720943022*^9, 3.580844776555997*^9, {
   3.5811734333963013`*^9, 3.581173434189369*^9}, {3.581181592043867*^9, 
   3.5811815941986513`*^9}, {3.581334259463752*^9, 3.581334289099818*^9}, {
   3.583589102512622*^9, 3.5835891048723183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"ComOriginsSTT", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ComOffsetsSTT", "\[LeftDoubleBracket]", 
      RowBox[{"{", "1", "}"}], "\[RightDoubleBracket]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"JointOriginsSTT", "\[LeftDoubleBracket]", 
          RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{
         "ComOffsetsSTT", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"nr", "+", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.580725705391213*^9, 3.5807257758747807`*^9}, 
   3.580815424695966*^9, {3.580815544583518*^9, 3.580815546727068*^9}, {
   3.5808190559152803`*^9, 3.580819059218412*^9}, {3.5808196074348097`*^9, 
   3.5808196650593767`*^9}, {3.580820242483395*^9, 3.580820276658619*^9}, {
   3.58082110067603*^9, 3.580821134867475*^9}, {3.580821321442238*^9, 
   3.580821381338213*^9}, {3.580821431346422*^9, 3.580821468226872*^9}, {
   3.5808218460752077`*^9, 3.580821882043633*^9}, {3.581173436735339*^9, 
   3.581173450754106*^9}, {3.58118159622674*^9, 3.581181634521264*^9}, {
   3.581334281629389*^9, 3.5813342859408693`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox["1", "9"]}], "0", 
      FractionBox["1", "27"]},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], "0", 
      FractionBox["19", "40"]},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], "0", 
      FractionBox["31", "40"]},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox[
       RowBox[{"p", "(", "1", ")"}], "8"], 
      FractionBox["47", "40"]},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox[
       RowBox[{"p", "(", "1", ")"}], "4"], 
      FractionBox["31", "40"]},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox[
       RowBox[{"p", "(", "1", ")"}], "4"], 
      FractionBox["19", "40"]},
     {
      RowBox[{"-", 
       FractionBox["1", "9"]}], 
      FractionBox[
       RowBox[{"p", "(", "1", ")"}], "4"], 
      FractionBox["1", "27"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5817827246856403`*^9, 3.581783103764175*^9, 3.581783388618779*^9, 
   3.5817859582471848`*^9, 3.581786080005467*^9, 3.581786135204315*^9, 
   3.581844890722324*^9, 3.5818482490074987`*^9, 3.581863472210744*^9, 
   3.5818767155780783`*^9, 3.581876921674502*^9, 3.58187952570625*^9, 
   3.58188673054103*^9, 3.58188679259973*^9, 3.581887289401958*^9, 
   3.581893058843252*^9, 3.581939880840514*^9, 3.5819400462016897`*^9, 
   3.582277001609097*^9, 3.58228620026265*^9, 3.582286269372055*^9, 
   3.5824659762882*^9, 3.582469344129938*^9, 3.582500918045547*^9, 
   3.582570510211018*^9, {3.582580698477819*^9, 3.58258073205046*^9}, 
   3.582634981154009*^9, {3.5826497697179832`*^9, 3.582649790926065*^9}, 
   3.5826509060587397`*^9, {3.58265752108218*^9, 3.582657537433062*^9}, 
   3.582657633867629*^9, 3.582734370596201*^9, 3.582972210721614*^9, {
   3.5829734325290956`*^9, 3.582973450818179*^9}, 3.582975024250967*^9, 
   3.5829792638680573`*^9, 3.583001566881034*^9, 3.583013515038022*^9, 
   3.583016683822124*^9, 3.583017690341621*^9, 3.583589315553096*^9, 
   3.5835921184411287`*^9, 3.5835987837004023`*^9, 3.583599538492571*^9, 
   3.583617133716815*^9, 3.583621038344364*^9, 3.6052800596658087`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.4864650144454*^9, 3.4864650153658*^9}, {
   3.4909741264094124`*^9, 3.490974127139454*^9}, {3.578415016119775*^9, 
   3.578415022167368*^9}, {3.580817930744133*^9, 3.5808179315258627`*^9}, 
   3.581888057212687*^9}],

Cell[CellGroupData[{

Cell["Kinematics", "Subsection",
 CellChangeTimes->{{3.581166064211364*^9, 3.5811660650593987`*^9}}],

Cell[CellGroupData[{

Cell["Empty twist", "Subsubsection",
 CellChangeTimes->{{3.5808185647333813`*^9, 3.5808185657811728`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]0", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4402720698982*^9, 3.4402720709282*^9}, {
   3.4402721864062*^9, 3.4402722488272*^9}, {3.4402722791132*^9, 
   3.4402722797082*^9}, {3.4402723198352003`*^9, 3.4402723551052*^9}, {
   3.4402724855052*^9, 3.4402724855792*^9}, {3.4402727516622*^9, 
   3.4402729073012*^9}, {3.4403401347148*^9, 3.4403401672876*^9}, {
   3.4415516485769997`*^9, 3.4415516619774*^9}, 3.442411325423357*^9, {
   3.455458666639009*^9, 3.455458702581409*^9}, {3.485611086693716*^9, 
   3.485611088213803*^9}, {3.485611149238293*^9, 3.4856111837682686`*^9}, {
   3.4856115268658924`*^9, 3.485611568033247*^9}, {3.4856117593341885`*^9, 
   3.4856118277371016`*^9}, {3.485611913392*^9, 3.485611957202506*^9}, {
   3.4856246457932425`*^9, 3.4856246493532476`*^9}, {3.4863904818044*^9, 
   3.4863904884968*^9}, {3.4864658161294003`*^9, 3.486465816925*^9}, {
   3.489163262470299*^9, 3.489163387710462*^9}, {3.489163548175043*^9, 
   3.489163575427602*^9}, {3.489163613304768*^9, 3.4891636740492425`*^9}, {
   3.4891637562279425`*^9, 3.489163770599765*^9}, 3.4891638604099016`*^9, {
   3.4909726797386675`*^9, 3.4909727020469437`*^9}, {3.490972733790759*^9, 
   3.490972752789846*^9}, {3.4909741452484903`*^9, 3.490974175111198*^9}, {
   3.4954562663675003`*^9, 3.4954562671942997`*^9}, {3.578324854046624*^9, 
   3.57832486757913*^9}, {3.5784149327807045`*^9, 3.5784149342360506`*^9}, {
   3.5784177786515226`*^9, 3.5784178050289164`*^9}, {3.5795715133909664`*^9, 
   3.5795715791558056`*^9}, {3.58067408141098*^9, 3.5806741479945145`*^9}, {
   3.5808153188861427`*^9, 3.5808153348556013`*^9}, {3.580816410194304*^9, 
   3.5808164150119267`*^9}, {3.5808181318071413`*^9, 3.580818141671217*^9}, {
   3.5808184974100018`*^9, 3.580818500761073*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Base frame twists", "Subsubsection",
 CellChangeTimes->{{3.4348155465694*^9, 3.4348155500794*^9}, 
   3.4349030872184*^9, 3.442411325423357*^9, 3.489163860407902*^9, {
   3.580816396421896*^9, 3.580816406261221*^9}, {3.5808164578452873`*^9, 
   3.580816474668944*^9}, {3.5808165131417*^9, 3.5808165155816803`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Xi]bf", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"GetTwist", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "#1"}], "]"}], "&"}], 
    ")"}], "/@", "TwistAxesBase"}]}]], "Input",
 CellChangeTimes->{{3.581334918530489*^9, 3.581334974212514*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581782729480585*^9, 3.5817831073012753`*^9, 3.581783389595233*^9, 
   3.581785959293755*^9, 3.5817860809960117`*^9, 3.5817861363365498`*^9, 
   3.581844891697843*^9, 3.58184825568498*^9, 3.581863473223413*^9, 
   3.581876716282577*^9, 3.581876922258881*^9, 3.581879526313869*^9, 
   3.581886731453558*^9, 3.581886793410904*^9, 3.581887290405221*^9, 
   3.581893059793357*^9, 3.581939882038734*^9, 3.581940047047192*^9, 
   3.582277002673324*^9, 3.582286200837152*^9, 3.582286269920644*^9, 
   3.582469344204789*^9, 3.582500918125208*^9, 3.582570510245784*^9, {
   3.5825806985251617`*^9, 3.5825807321088057`*^9}, 3.582634981260582*^9, {
   3.5826497697391567`*^9, 3.582649790972562*^9}, 3.582650906130459*^9, {
   3.582657521153591*^9, 3.582657537448715*^9}, 3.582657633891712*^9, 
   3.582734370661109*^9, 3.5829722107899103`*^9, {3.582973432693233*^9, 
   3.5829734508884487`*^9}, 3.58297502437928*^9, 3.582979263891238*^9, 
   3.5830015669513617`*^9, 3.5830135151962147`*^9, 3.583016683892911*^9, 
   3.583017690393301*^9, 3.583589323207984*^9, 3.583592132122045*^9, 
   3.583598783737513*^9, 3.5835995385657883`*^9, 3.583617133767157*^9, 
   3.583621038517413*^9, 3.6052800597157173`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Robot twists from stance foot", "Subsubsection",
 CellChangeTimes->{{3.58081720720544*^9, 3.580817220110298*^9}, {
  3.580844103999536*^9, 3.580844131304605*^9}, {3.5808581872575417`*^9, 
  3.580858188281107*^9}, {3.581334992139475*^9, 3.5813349924351*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Xi]rf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"GetTwist", "[", 
     RowBox[{
      RowBox[{
      "JointOriginsSTT", "\[LeftDoubleBracket]", "#1", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{
      "TwistAxesRobot", "\[LeftDoubleBracket]", "#1", 
       "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"Range", "[", "nr", "]"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.581334995970874*^9, 3.5813350483245983`*^9}, {
  3.581335934748332*^9, 3.58133593700395*^9}, {3.581361767141301*^9, 
  3.581361843468769*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "10"], "0", 
      FractionBox["1", "4"], "0", 
      RowBox[{"-", "1"}], "0"},
     {
      FractionBox["3", "5"], "0", 
      FractionBox["1", "4"], "0", 
      RowBox[{"-", "1"}], "0"},
     {
      FractionBox["11", "10"], "0", 
      FractionBox["1", "4"], "0", 
      RowBox[{"-", "1"}], "0"},
     {
      RowBox[{"-", 
       FractionBox["11", "10"]}], "0", 
      RowBox[{"-", 
       FractionBox["1", "4"]}], "0", "1", "0"},
     {
      RowBox[{"-", 
       FractionBox["3", "5"]}], "0", 
      RowBox[{"-", 
       FractionBox["1", "4"]}], "0", "1", "0"},
     {
      RowBox[{"-", 
       FractionBox["1", "10"]}], "0", 
      RowBox[{"-", 
       FractionBox["1", "4"]}], "0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581782730463283*^9, 3.581783108321224*^9, 3.581783389667089*^9, 
   3.5817859593474817`*^9, 3.5817860810509777`*^9, 3.58178613642072*^9, 
   3.5818448917682323`*^9, 3.581848256771121*^9, 3.581863473273572*^9, 
   3.5818767163383493`*^9, 3.581876922288755*^9, 3.581879526445044*^9, 
   3.5818867315018806`*^9, 3.581886793450079*^9, 3.581887290469243*^9, 
   3.5818930598638287`*^9, 3.58193988209103*^9, 3.5819400471481028`*^9, 
   3.582277002738076*^9, 3.582286200937854*^9, 3.582286269956365*^9, 
   3.5824693442640038`*^9, 3.58250091819248*^9, 3.582570510269991*^9, {
   3.5825806985617523`*^9, 3.5825807321653748`*^9}, 3.582634981300726*^9, {
   3.582649769749587*^9, 3.582649791014926*^9}, 3.582650906179682*^9, {
   3.582657521233171*^9, 3.582657537488833*^9}, 3.582657633940028*^9, 
   3.5827343707182083`*^9, 3.582972210843409*^9, {3.582973432831321*^9, 
   3.5829734509423103`*^9}, 3.5829750244319983`*^9, 3.582979263949938*^9, 
   3.583001566998425*^9, 3.5830135152432413`*^9, 3.583016683942984*^9, 
   3.58301769044536*^9, 3.5835893259429827`*^9, 3.583592133442994*^9, 
   3.583598783785212*^9, 3.583599538617344*^9, 3.583617133828018*^9, 
   3.583621038568555*^9, 3.6052800597918053`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Base configuration", "Subsubsection",
 CellChangeTimes->{{3.4402723662482*^9, 3.4402723751851997`*^9}, {
   3.4403491303598003`*^9, 3.4403491303754*^9}, 3.442411325423357*^9, {
   3.455632572510909*^9, 3.455632572869709*^9}, {3.4867430692058*^9, 
   3.4867430715769997`*^9}, {3.580898811635841*^9, 3.580898812513678*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gf", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", "#1"}], "]"}], "&"}], "/@",
     "ComOriginsSTT"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580822229265812*^9, 3.580822236322184*^9}, {
  3.580822301616654*^9, 3.5808223896580687`*^9}, {3.581173667501107*^9, 
  3.581173667772521*^9}, {3.5811818322048817`*^9, 3.5811818325641003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetStanceTwists", "[", 
    RowBox[{
     RowBox[{"massIndex_", "?", "IntegerQ"}], "/;", 
     RowBox[{"0", "<", "massIndex", "\[LessEqual]", "nl"}]}], "]"}], ":=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\[Xi]bf", "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "Q", "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}], "}"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Xi]rf", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "Qr", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}], 
         "}"}], "&"}], ")"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"massIndex", "-", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580828045264886*^9, 3.580828134701178*^9}, {
   3.580828176701483*^9, 3.58082818629958*^9}, {3.580828230900093*^9, 
   3.580828234695292*^9}, {3.580828616411359*^9, 3.580828623115005*^9}, {
   3.58082902336653*^9, 3.580829036553738*^9}, {3.5808290710569553`*^9, 
   3.580829138618312*^9}, 3.580829176336026*^9, {3.580829219176344*^9, 
   3.58082922202418*^9}, {3.5818463715334883`*^9, 3.581846393132922*^9}, {
   3.581848157193512*^9, 3.581848200609283*^9}, {3.582469879592251*^9, 
   3.582469879655342*^9}, {3.583589333799618*^9, 3.5835893350054626`*^9}, {
   3.583589396058777*^9, 3.583589400240294*^9}, {3.5835921715343647`*^9, 
   3.583592178058638*^9}}],

Cell[BoxData[
 RowBox[{"FK", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"twists", ",", " ", "g"}], "}"}], ",", 
    RowBox[{"ForwardKinematics", "@@", 
     RowBox[{"Join", "[", 
      RowBox[{"twists", ",", 
       RowBox[{"{", "g", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.58082241181*^9, 3.580822415427146*^9}, {
  3.5808280032232437`*^9, 3.5808280295489473`*^9}, {3.580828846566518*^9, 
  3.58082888963888*^9}, {3.580990595959402*^9, 3.580990606773621*^9}, {
  3.581357140663604*^9, 3.581357141679557*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate the forward kinematics\
\>", "Subsubsection",
 CellChangeTimes->{{3.485611263993857*^9, 3.485611268537117*^9}, {
  3.581783110240757*^9, 3.58178311102426*^9}, {3.583592184017715*^9, 
  3.583592184634201*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gf", "[", "\[Theta]", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FK", "[", 
       RowBox[{
        RowBox[{"GetStanceTwists", "[", "#1", "]"}], ",", 
        RowBox[{
         RowBox[{"gf", "[", "0", "]"}], "\[LeftDoubleBracket]", "#1", 
         "\[RightDoubleBracket]"}]}], "]"}], "&"}], ")"}], "/@", 
    RowBox[{"Range", "[", "nl", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5808283116871843`*^9, 3.580828414508978*^9}, {
  3.5808286314378223`*^9, 3.580828654859733*^9}, {3.580828754671934*^9, 
  3.580828755870145*^9}, {3.580841749247054*^9, 3.5808417519994783`*^9}, {
  3.582469961606077*^9, 3.5824699631724033`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Subsection",
 CellChangeTimes->{{3.581166052235951*^9, 3.581166053627684*^9}}],

Cell[CellGroupData[{

Cell["Convert to absolute coordinates, WAY FASTER", "Subsubsection",
 CellChangeTimes->{{3.581776101717293*^9, 3.581776110908976*^9}, {
  3.581781927136798*^9, 3.581781933727578*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n\[Zeta]", "=", "nr"}], ";"}]], "Input",
 CellChangeTimes->{{3.581782093239513*^9, 3.5817820980132627`*^9}, {
  3.581845016863212*^9, 3.581845017985311*^9}, {3.583589430760786*^9, 
  3.5835894309491253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTau]", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"n\[Zeta]", "/", "2"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"i", "\[GreaterEqual]", "j"}], ")"}]}], ")"}]}], 
        "\[Rule]", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", ">", 
             RowBox[{"n\[Zeta]", "/", "2"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"i", "\[GreaterEqual]", "j"}], ")"}]}], ")"}]}], 
        "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n\[Zeta]", ",", "n\[Zeta]"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5817821759024143`*^9, 3.5817822245877953`*^9}, {
  3.581782263449411*^9, 3.581782350188128*^9}, {3.581782396716917*^9, 
  3.5817824280964518`*^9}, {3.581782502677466*^9, 3.581782503581395*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Zeta]subs", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Qr", "/.", "\[VeryThinSpace]", 
             RowBox[{"q", "\[Rule]", "\[Zeta]"}]}], ")"}], 
           "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "==", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[CapitalTau]", ".", "Qr"}], ")"}], 
           "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}], "&"}], 
        ")"}], "/@", 
       RowBox[{"Range", "[", "n\[Zeta]", "]"}]}], ",", "Qr"}], "]"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Zeta]subs", "=", 
   RowBox[{"D", "[", 
    RowBox[{"\[Zeta]subs", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalZeta]subs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"\[Zeta]subs", ",", "d\[Zeta]subs"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.581776171201775*^9, 3.581776437050933*^9}, {
  3.581776481566861*^9, 3.581776482673903*^9}, {3.581776524286579*^9, 
  3.581776543621912*^9}, {3.5817766266486607`*^9, 3.581776627231968*^9}, {
  3.581778747152845*^9, 3.581778772817556*^9}, {3.5817812670559587`*^9, 
  3.5817812683758183`*^9}, {3.581781301245934*^9, 3.58178130138393*^9}, {
  3.581782510623249*^9, 3.581782512823926*^9}, {3.582469974172801*^9, 
  3.582469975487206*^9}, {3.583589441063334*^9, 3.583589458719756*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalZeta]r", "=", 
   RowBox[{"Qr", "/.", "\[VeryThinSpace]", 
    RowBox[{"q", "\[Rule]", "\[Zeta]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[CapitalZeta]r", "=", 
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalZeta]r", ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.581781347918705*^9, 3.5817814054259663`*^9}, {
  3.581782564850091*^9, 3.581782569266143*^9}, {3.5835894670787277`*^9, 
  3.583589500486356*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate the kinetic energy and manipulator inertia matrix", \
"Subsubsection",
 CellChangeTimes->{{3.432034707783764*^9, 3.432034716738164*^9}, {
   3.4348164244282*^9, 3.4348164316666*^9}, 3.43793555653119*^9, {
   3.4403491407962*^9, 3.4403491422158003`*^9}, 3.442411325423357*^9, {
   3.48561167578541*^9, 3.4856116779615345`*^9}, {3.490973632931187*^9, 
   3.490973644399843*^9}, {3.581848306125667*^9, 3.581848306699603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vf", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ParallelSimplify", "[", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", "t", "}"}]], 
        RowBox[{"RigidPosition", "[", "#1", "]"}]}], "]"}], "&"}], ")"}], "/@", 
    RowBox[{"gf", "[", "\[Theta]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5808418877355003`*^9, 3.580841894985504*^9}, {
  3.5817647056213017`*^9, 3.581764708719554*^9}, {3.581782522720522*^9, 
  3.581782525295424*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vf\[Zeta]", "=", 
   RowBox[{
    RowBox[{"vf", "/.", "\[CapitalZeta]subs"}], "//", "ParallelSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.581781417181625*^9, 3.5817814343177557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tf\[Zeta]", "=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"vf\[Zeta]", "\[Transpose]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", "mm", "]"}], ".", "vf\[Zeta]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581781457549424*^9, 3.581781512703274*^9}, {
  3.581782586216468*^9, 3.581782589591476*^9}, {3.581782967913869*^9, 
  3.5817829784820967`*^9}, {3.581848704631691*^9, 3.58184870521527*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Df\[Zeta]", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"Tf\[Zeta]", ",", 
      RowBox[{"{", 
       RowBox[{"d\[CapitalZeta]r", ",", "2"}], "}"}]}], "]"}], "//", 
    "ParallelSimplify"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{"Df\[Zeta]", ",", "\"\<Mrzmat\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.58178125319418*^9, 3.5817812564285727`*^9}, {
   3.581781325330455*^9, 3.581781332332614*^9}, {3.5817815241771097`*^9, 
   3.581781544121489*^9}, {3.581782593224907*^9, 3.581782595958909*^9}, 
   3.581782652362418*^9, {3.581784748051094*^9, 3.581784748239181*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Coriolis matrix", "Subsubsection",
 CellChangeTimes->{{3.4558938735559998`*^9, 3.4558938782204*^9}, {
  3.4922829997605195`*^9, 3.4922830012316036`*^9}, {3.5810153197091007`*^9, 
  3.5810153203415747`*^9}, {3.581786009960298*^9, 3.581786010960075*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cf\[Zeta]", "=", 
   RowBox[{
    RowBox[{"InertiaToCoriolis", "[", 
     RowBox[{"Df\[Zeta]", ",", "\[CapitalZeta]r", ",", "d\[CapitalZeta]r"}], 
     "]"}], "//", "ParallelSimplify"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{"Cf\[Zeta]", ",", "\"\<Crzmat\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.58099187547939*^9, 3.580991908899548*^9}, 
   3.580995346116691*^9, {3.5810134568691797`*^9, 3.581013456961652*^9}, {
   3.581107293385495*^9, 3.5811072942576437`*^9}, {3.581182120447937*^9, 
   3.581182145301003*^9}, 3.58133628974063*^9, 3.58177078474231*^9, {
   3.581781672705456*^9, 3.581781686066277*^9}, {3.5817826911625423`*^9, 
   3.581782695370182*^9}, {3.58178473477633*^9, 3.581784739438176*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate the potential energy and \[ScriptCapitalG] matrix\
\>", "Subsubsection",
 CellChangeTimes->{{3.432424030487764*^9, 3.4324240399569635`*^9}, {
   3.4329027694652*^9, 3.4329027701204*^9}, {3.434816438983*^9, 
   3.4348164411202*^9}, 3.43793555412879*^9, {3.440349144743*^9, 
   3.440349147317*^9}, 3.442411325423357*^9, {3.4856121102172585`*^9, 
   3.485612114289491*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vf", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"g", "/.", "constsubs"}], ")"}], " ", 
     RowBox[{"mm", ".", 
      RowBox[{
       RowBox[{"gf", "[", "\[Theta]", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{";;", ",", "3", ",", "4"}], "\[RightDoubleBracket]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vf\[Zeta]", "=", 
   RowBox[{
    RowBox[{"Vf", "/.", "\[CapitalZeta]subs"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.581773279095006*^9, 3.581773282377081*^9}, {
  3.581783130733349*^9, 3.581783142404891*^9}, {3.583589572799386*^9, 
  3.58358957491086*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G2D\[Zeta]", "=", 
   RowBox[{"ParallelSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"Vf", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "Qr", "}"}], "\[Transpose]"}], "}"}]}], "]"}], "/.", 
     "\[CapitalZeta]subs"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{"G2D\[Zeta]", ",", "\"\<G2Dzmat\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.581848459316073*^9, 3.5818485171488733`*^9}, {
  3.581849321153574*^9, 3.581849364420946*^9}, {3.583599453518118*^9, 
  3.583599469761971*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gf\[Zeta]", "=", 
   RowBox[{"ParallelSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"Vf\[Zeta]", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\[CapitalZeta]r", "}"}], "\[Transpose]"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{"Gf\[Zeta]", ",", "\"\<Grzmat\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.581773260391687*^9, 3.581773330325079*^9}, {
  3.581783245323372*^9, 3.581783261554785*^9}, {3.58178475605026*^9, 
  3.581784757600658*^9}, {3.5826377219344187`*^9, 3.5826377355181217`*^9}, {
  3.583589596761942*^9, 3.5835896006953382`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check transformation", "Subsubsection",
 CellChangeTimes->{{3.581785846800552*^9, 3.581785849950097*^9}, {
  3.581848896771681*^9, 3.581848897417715*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalTau]", ".", "Qr"}]], "Input",
 CellChangeTimes->{{3.5817835593801928`*^9, 3.581783575967184*^9}, 
   3.581785986135541*^9, {3.581786240692729*^9, 3.581786247212824*^9}, 
   3.583589619430048*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "(", "t", ")"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.581786250311219*^9, 3.581786251563048*^9}, 
   3.581786283870141*^9, 3.581844975047282*^9, 3.581848923262136*^9, 
   3.5818636605004263`*^9, 3.581877107785136*^9, 3.58187971350664*^9, 
   3.581886980824439*^9, 3.581887478034049*^9, 3.5818932475563374`*^9, 
   3.581940233872286*^9, 3.582277191193549*^9, 3.5822864561496563`*^9, 
   3.5824695312069197`*^9, 3.5825011066686153`*^9, 3.582570696107696*^9, 
   3.5825809191855927`*^9, 3.582635167955789*^9, 3.582649976814783*^9, 
   3.582651093496654*^9, 3.582657821322307*^9, 3.582734454297925*^9, 
   3.5829723975481663`*^9, 3.5829736375537558`*^9, 3.582975211280561*^9, 
   3.5829794505785017`*^9, 3.583001752995606*^9, 3.5830137013664913`*^9, 
   3.583016869817277*^9, 3.5830178780750237`*^9, 3.583589619778564*^9, 
   3.583592223604652*^9, 3.58359879857596*^9, 3.583599563618959*^9, 
   3.583617153188753*^9, 3.58362108378839*^9, 3.605280070648533*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Zeta]\[Zeta]subs", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
      "\[CapitalZeta]r", "\[LeftDoubleBracket]", "#", 
       "\[RightDoubleBracket]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[CapitalTau]", ".", "Qr"}], ")"}], "\[LeftDoubleBracket]", 
       "#", "\[RightDoubleBracket]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Range", "[", "n\[Zeta]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.581785521001729*^9, 3.58178553464312*^9}, {
  3.582469997157566*^9, 3.582469999745935*^9}, {3.5835896269472523`*^9, 
  3.583589659129377*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "1"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "2"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "3"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "3"], "(", "t", ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "4"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
      RowBox[{
       SubscriptBox["q", "4"], "(", "t", ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "5"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
      RowBox[{
       SubscriptBox["q", "4"], "(", "t", ")"}], "-", 
      RowBox[{
       SubscriptBox["q", "5"], "(", "t", ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "6"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
      RowBox[{
       SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
      RowBox[{
       SubscriptBox["q", "4"], "(", "t", ")"}], "-", 
      RowBox[{
       SubscriptBox["q", "5"], "(", "t", ")"}], "-", 
      RowBox[{
       SubscriptBox["q", "6"], "(", "t", ")"}]}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.581785521290832*^9, 3.58178553646838*^9}, 
   3.581786219144266*^9, 3.581786286448758*^9, 3.581844975111177*^9, 
   3.581848923330689*^9, 3.5818636605956173`*^9, 3.5818771078251877`*^9, 
   3.581879713556389*^9, 3.58188698092045*^9, 3.581887478095145*^9, 
   3.581893247656595*^9, 3.581940233970354*^9, 3.582277191288765*^9, 
   3.582286456207663*^9, 3.582469531343404*^9, 3.582501106785915*^9, 
   3.5825706961607*^9, 3.582580919252409*^9, 3.582635168044024*^9, 
   3.5826499769283667`*^9, 3.5826510936166563`*^9, 3.582657821375155*^9, 
   3.582734454405963*^9, 3.58297239762887*^9, 3.582973637668782*^9, 
   3.5829752114002123`*^9, 3.58297945066847*^9, 3.583001753079111*^9, 
   3.583013701450534*^9, 3.583016869850236*^9, 3.5830178781741037`*^9, 
   3.583589661863439*^9, 3.58359222369265*^9, 3.58359879864213*^9, 
   3.583599563692328*^9, 3.583617153254427*^9, 3.583621083856182*^9, 
   3.605280070710717*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SeedRandom", "[", "1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"testq", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"X", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
       "\[Rule]", 
       RowBox[{"Random", "[", "]"}]}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "X", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.581785299085524*^9, 3.581785390746127*^9}, {
  3.5817854591279783`*^9, 3.5817854693550873`*^9}, {3.581786450900428*^9, 
  3.5817864546292562`*^9}, {3.5817881959585733`*^9, 3.581788208925304*^9}, {
  3.581848989717346*^9, 3.5818490327629642`*^9}, {3.583589666996394*^9, 
  3.583589670665647*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "(", "t", ")"}], "\[Rule]", 
     "0.6686926778600345`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "z"], "(", "t", ")"}], "\[Rule]", 
     "0.8311998722869463`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "y"], "(", "t", ")"}], "\[Rule]", 
     "0.7818074748209513`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "\[Rule]", 
     "0.12463419022903224`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "\[Rule]", 
     "0.9345372830959425`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "\[Rule]", 
     "0.6002520340808316`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "\[Rule]", 
     "0.7583545830418578`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "\[Rule]", 
     "0.9690890062889682`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}], "\[Rule]", 
     "0.1256991791331959`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "x"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.5756361231168926`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "z"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.7550524622030328`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "y"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.821438322382038`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.6046009652062657`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.19446459094817814`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "3"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.6573069365710422`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "4"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.5595585607318685`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "5"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.836730788063133`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "6"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.16053645024784782`"}], ",", 
    RowBox[{
     RowBox[{"p", "(", "1", ")"}], "\[Rule]", 
     RowBox[{"-", "1"}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.581785391166808*^9, 3.5817853962641077`*^9}, {
   3.581785449958228*^9, 3.581785469857242*^9}, 3.581786219270525*^9, 
   3.581786286651582*^9, 3.581786455094564*^9, 3.581788209904275*^9, 
   3.581844975164534*^9, 3.581848923432457*^9, {3.581848999959045*^9, 
   3.581849034250388*^9}, 3.58186366067951*^9, 3.58187710786357*^9, 
   3.5818797135998983`*^9, 3.581886980998191*^9, 3.581887478160985*^9, 
   3.581893247801218*^9, 3.581940234080571*^9, 3.582277191387638*^9, 
   3.582286456265168*^9, 3.58246953157603*^9, 3.582501106924253*^9, 
   3.582570696206561*^9, 3.582580919308857*^9, 3.582635168121683*^9, 
   3.582649977009067*^9, 3.5826510937304497`*^9, 3.5826578214280777`*^9, 
   3.582734454505961*^9, 3.582972397711246*^9, 3.582973637813012*^9, 
   3.5829752115240383`*^9, 3.582979450741864*^9, 3.583001753162653*^9, 
   3.583013701529348*^9, 3.58301686988013*^9, 3.583017878246952*^9, 
   3.583589671977496*^9, 3.58359222382132*^9, 3.583598798698453*^9, 
   3.583599563750354*^9, 3.583617153317321*^9, 3.5836210839185333`*^9, 
   3.605280070757275*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"First", "[", "#1", "]"}], "&"}], ")"}], "/@", "testq"}], 
  ")"}]], "Input",
 CellChangeTimes->{{3.583589861537629*^9, 3.5835899075683117`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "x"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["p", "z"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "y"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "1"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "2"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "3"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "4"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "5"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "6"], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["p", "x"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["p", "z"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "y"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "3"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "4"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "5"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "6"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", 
    RowBox[{"p", "(", "1", ")"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.583589864488453*^9, 3.5835899093821583`*^9, 
  3.583592223954907*^9, 3.583598798747779*^9, 3.583599563808763*^9, 
  3.58361715337749*^9, 3.583621083924901*^9, 3.605280070790716*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test\[Zeta]", "=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"\[Zeta]\[Zeta]subs", ",", 
       RowBox[{"D", "[", 
        RowBox[{"\[Zeta]\[Zeta]subs", ",", "t"}], "]"}]}], "]"}], "/.", 
     "testq"}], ",", "\[IndentingNewLine]", 
    RowBox[{"testq", "\[LeftDoubleBracket]", 
     RowBox[{"{", "3", "}"}], "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.581785539554975*^9, 3.5817856455932217`*^9}, {
  3.5817864862972927`*^9, 3.581786487938142*^9}, {3.5818490551442137`*^9, 
  3.581849107899637*^9}, {3.583589734147253*^9, 3.583589759373811*^9}, {
  3.583589940991008*^9, 3.5835900719412537`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "1"], "(", "t", ")"}], "\[Rule]", 
     "0.12463419022903224`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "2"], "(", "t", ")"}], "\[Rule]", 
     "1.0591714733249749`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "3"], "(", "t", ")"}], "\[Rule]", 
     "1.6594235074058066`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "4"], "(", "t", ")"}], "\[Rule]", 
     "0.9010689243639487`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "5"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"-", "0.0680200819250194`"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Zeta]", "6"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"-", "0.19371926105821524`"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Zeta]", "1"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.6046009652062657`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Zeta]", "2"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.7990655561544439`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Zeta]", "3"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "1.4563724927254862`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Zeta]", "4"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.8968139319936176`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Zeta]", "5"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     "0.06008314393048475`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Zeta]", "6"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"-", "0.10045330631736316`"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "y"], "(", "t", ")"}], "\[Rule]", 
     "0.7818074748209513`"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.583589759918983*^9, {3.58359002387092*^9, 3.583590040469173*^9}, 
   3.5835900727825727`*^9, 3.5835922240380287`*^9, 3.583598798820653*^9, 
   3.583599563848957*^9, 3.583617153455752*^9, 3.5836210839712667`*^9, 
   3.6052800708422337`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tf", "=", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"vf", "\[Transpose]"}], ".", 
      RowBox[{"DiagonalMatrix", "[", "mm", "]"}], ".", "vf"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5817852661299677`*^9, 3.581785271678755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Df", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Tf", ",", 
     RowBox[{"{", 
      RowBox[{"dQr", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581785276120092*^9, 3.581785287110589*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cf", "=", 
   RowBox[{"InertiaToCoriolis", "[", 
    RowBox[{"Df", ",", "Qr", ",", "dQr"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.58099187547939*^9, 3.580991908899548*^9}, 
   3.580995346116691*^9, {3.5810134568691797`*^9, 3.581013456961652*^9}, {
   3.581107293385495*^9, 3.5811072942576437`*^9}, {3.581182120447937*^9, 
   3.581182145301003*^9}, 3.58133628974063*^9, 3.58177078474231*^9, {
   3.581781672705456*^9, 3.581781686066277*^9}, {3.5817826911625423`*^9, 
   3.581782695370182*^9}, {3.58178473477633*^9, 3.581784739438176*^9}, {
   3.581785815150199*^9, 3.581785820781373*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Round", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Df", "/.", "testq"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalTau]", "\[Transpose]"}], ".", "Df\[Zeta]", ".", 
        "\[CapitalTau]"}], "/.", "test\[Zeta]"}], "//", "N"}], ")"}]}], ",", 
   "1*^-14"}], "]"}]], "Input",
 CellChangeTimes->{{3.581785634752256*^9, 3.581785637168541*^9}, {
   3.581785681205379*^9, 3.581785767271905*^9}, 3.5817860555123653`*^9, {
   3.5817862742508173`*^9, 3.581786274576478*^9}, {3.583589820232345*^9, 
   3.583589822322118*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.5835898231903543`*^9, 3.5835922246100082`*^9, 
  3.583598798980701*^9, 3.5835995640772877`*^9, 3.5836171536530237`*^9, 
  3.583621084129464*^9, 3.605280070999226*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Round", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Cf", "/.", "testq"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalTau]", "\[Transpose]"}], ".", "Cf\[Zeta]", ".", 
        "\[CapitalTau]"}], "/.", "test\[Zeta]"}], "//", "N"}], ")"}]}], ",", 
   "1*^-13"}], "]"}]], "Input",
 CellChangeTimes->{{3.581785838118878*^9, 3.5817858897468843`*^9}, {
  3.581849122324171*^9, 3.581849122827211*^9}, {3.583589810430685*^9, 
  3.583589830481195*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.581785873118826*^9, 3.5817858915559263`*^9}, 
   3.581786459873177*^9, 3.581786492163436*^9, 3.581844977170753*^9, 
   3.581848958701456*^9, {3.581849101675425*^9, 3.5818491283590097`*^9}, 
   3.581863669852062*^9, 3.581877116519356*^9, 3.581879720649288*^9, 
   3.581886988157729*^9, 3.5818874853527184`*^9, 3.581893256894321*^9, 
   3.581940243160672*^9, 3.582277198470269*^9, 3.582286465153173*^9, 
   3.582469540723317*^9, 3.582501115876622*^9, 3.582570703053092*^9, 
   3.582580928221148*^9, 3.5826351751376743`*^9, 3.582649986297717*^9, 
   3.582651101017036*^9, 3.58265782855722*^9, 3.582734463267439*^9, 
   3.5829724068729153`*^9, 3.582973647285346*^9, 3.582975220458598*^9, 
   3.5829794597763042`*^9, 3.583001760377637*^9, 3.5830137086513577`*^9, 
   3.583016876799533*^9, 3.5830178874162483`*^9, 3.58358983147753*^9, 
   3.583592225064842*^9, 3.583598799269012*^9, 3.583599564324585*^9, 
   3.583617153925672*^9, 3.58362108439137*^9, 3.6052800712308493`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gf", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Vf", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "Qr", "}"}], "\[Transpose]"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.581786180934671*^9, 3.5817861911218452`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Round", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Gf", "/.", "testq"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalTau]", "\[Transpose]"}], ".", "Gf\[Zeta]"}], "/.", 
       "test\[Zeta]"}], "//", "N"}], ")"}]}], ",", "1*^-13"}], "]"}]], "Input",
 CellChangeTimes->{{3.5817862547206287`*^9, 3.581786259785718*^9}, {
   3.581786322578977*^9, 3.581786348667568*^9}, 3.583589838688401*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"0"},
     {"0"},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.581786257621007*^9, 3.5817862599976177`*^9}, {
   3.5817863227804337`*^9, 3.581786349013204*^9}, 3.581786459974328*^9, 
   3.5817864922601957`*^9, 3.581844977304994*^9, 3.581848958867672*^9, {
   3.5818491018566017`*^9, 3.581849128484076*^9}, 3.5818636699289017`*^9, 
   3.581877116568737*^9, 3.5818797207061443`*^9, 3.581886988250959*^9, 
   3.581887485537744*^9, 3.581893256982297*^9, 3.581940243228539*^9, 
   3.582277198545871*^9, 3.582286465229357*^9, 3.58246954080692*^9, 
   3.5825011159737377`*^9, 3.582570703106661*^9, 3.582580928300248*^9, 
   3.582635175200148*^9, 3.5826499863838177`*^9, 3.582651101102899*^9, 
   3.5826578286213007`*^9, 3.582734463345233*^9, 3.5829724069768867`*^9, 
   3.582973647398951*^9, 3.5829752205305567`*^9, 3.582979459847666*^9, 
   3.583001760452873*^9, 3.583013708721236*^9, 3.5830168768431253`*^9, 
   3.5830178875098677`*^9, 3.583589839295554*^9, 3.583592225245358*^9, 
   3.583598799333995*^9, 3.5835995643770237`*^9, 3.583617153996092*^9, 
   3.583621084444933*^9, 3.6052800712866173`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalTau]", ".", "Qr"}]], "Input",
 CellChangeTimes->{{3.581786760471257*^9, 3.581786791749185*^9}, 
   3.58359223501831*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "(", "t", ")"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "+", 
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "-", 
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.581786769261787*^9, 3.5817867935656023`*^9}, 
   3.581844977777066*^9, 3.581848961573041*^9, 3.5818491348297377`*^9, 
   3.5818636708121347`*^9, 3.581877117362735*^9, 3.5818797215115232`*^9, 
   3.581886989165642*^9, 3.581887486505018*^9, 3.581893257863812*^9, 
   3.581940244112115*^9, 3.5822771994274597`*^9, 3.582286466061109*^9, 
   3.582469541689918*^9, 3.582501116858294*^9, 3.582570703926445*^9, 
   3.5825809291698103`*^9, 3.582635176013257*^9, 3.582649987274699*^9, 
   3.5826511019948597`*^9, 3.582657829470726*^9, 3.582734464210437*^9, 
   3.582972407897387*^9, 3.582973648337904*^9, 3.5829752214177227`*^9, 
   3.582979460704021*^9, 3.583001761303883*^9, 3.5830137095740013`*^9, 
   3.583016877662705*^9, 3.583017888418597*^9, 3.583592235504097*^9, 
   3.583598799408196*^9, 3.583599564433803*^9, 3.583617154168955*^9, 
   3.583621084505863*^9, 3.605280071337102*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Forward and inverse kinematics", "Section",
 CellChangeTimes->{{3.4856130387373667`*^9, 3.4856130423055706`*^9}, {
  3.58178649281706*^9, 3.581786495952484*^9}, {3.58188802879751*^9, 
  3.5818880441485033`*^9}}],

Cell["\<\
This section contains some calculations for calculating forward kinematics of \
a few specific end-effectors as well as inverse kinematics calculations for \
use with the reset map and fsolve.\
\>", "Text",
 CellChangeTimes->{{3.5818880688446407`*^9, 3.581888157125848*^9}}],

Cell[CellGroupData[{

Cell["End-effector configurations", "Subsubsection",
 CellChangeTimes->{{3.4857072707638583`*^9, 3.4857072919330583`*^9}, 
   3.4891650427955303`*^9, 3.4909736201434555`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EffOriginsFoot", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Lft"}], "-", "Lfh"}], ",", "0", ",", "0"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "0", ",", 
        RowBox[{"ha", "+", "Lc"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "0", ",", 
        RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", 
        FractionBox["wHip", "2"], ",", 
        RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", 
        FractionBox["wHip", "2"], ",", 
        RowBox[{"ha", "+", "Lc", "+", "Lt", "+", "rTz"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "wHip", ",", 
        RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "wHip", ",", 
        RowBox[{"ha", "+", "Lc"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "wHip", ",", "ha"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Lft"}], "-", "Lfh"}], ",", "wHip", ",", "0"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "wHip", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], "/.", "constsubs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5808486004067507`*^9, 3.5808488259325457`*^9}, {
  3.580848944308564*^9, 3.580849025134637*^9}, {3.580994187047928*^9, 
  3.580994189177685*^9}, {3.581165878137802*^9, 3.581165881305472*^9}, {
  3.581173789504998*^9, 3.581173790042259*^9}, {3.581181953681736*^9, 
  3.581181954273869*^9}, {3.5813591104653254`*^9, 3.581359143277049*^9}, {
  3.581359222679607*^9, 3.581359248601527*^9}, {3.5813592940449333`*^9, 
  3.5813593603240347`*^9}, {3.581362173933092*^9, 3.58136217927565*^9}, {
  3.581362881242477*^9, 3.581362887820775*^9}, {3.583592428115592*^9, 
  3.583592469237207*^9}, {3.583592510806143*^9, 3.583592513811639*^9}, {
  3.583592548138658*^9, 3.583592558803393*^9}, {3.58359259089148*^9, 
  3.5835926061702833`*^9}, {3.5835927614665194`*^9, 3.583592790461636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nEff", "=", 
   RowBox[{"Length", "[", "EffOriginsFoot", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580994122359284*^9, 3.580994132138604*^9}, {
  3.580994201690974*^9, 3.580994203210833*^9}, {3.58116588339923*^9, 
  3.581165883883318*^9}, {3.581173797390224*^9, 3.581173797934395*^9}, {
  3.581192597631811*^9, 3.5811925981133204`*^9}, {3.581192631634166*^9, 
  3.581192632993412*^9}, {3.581336030256791*^9, 3.581336031112836*^9}, {
  3.581359374146106*^9, 3.581359375353394*^9}, {3.583592782321151*^9, 
  3.5835928091006517`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"EffList", "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<stt\>\"", ",", "\"\<sth\>\"", ",", "\"\<sta\>\"", ",", 
         "\"\<stk\>\"", ",", "\"\<stH\>\"", ",", "\"\<Tb\>\"", ",", 
         "\"\<Tt\>\"", ",", "\"\<nsH\>\"", ",", "\"\<nsk\>\"", ",", 
         "\"\<nsa\>\"", ",", "\"\<nsh\>\"", ",", "\"\<nst\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "1", ",", "1", ",", "2", ",", "3", ",", "4", ",", "4", ",", 
         "5", ",", "6", ",", "7", ",", "7", ",", "7"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], "//", "Transpose"}]}], ")"}], 
  "\[Transpose]"}]], "Input",
 CellChangeTimes->{{3.578828324168758*^9, 3.5788283847379007`*^9}, {
   3.578828420249549*^9, 3.578828423316936*^9}, {3.578828601466996*^9, 
   3.578828617329019*^9}, {3.5795725342783813`*^9, 3.5795725576810317`*^9}, {
   3.5795726002073703`*^9, 3.579572615711714*^9}, {3.5795726487032337`*^9, 
   3.579572659966653*^9}, {3.5795728043832517`*^9, 3.579572805013835*^9}, {
   3.579572854231366*^9, 3.579572857255163*^9}, {3.579572970846245*^9, 
   3.5795729947673745`*^9}, {3.579619271067364*^9, 3.579619284176479*^9}, {
   3.579619753030367*^9, 3.5796197561422424`*^9}, {3.579628468609909*^9, 
   3.579628470200899*^9}, {3.579629772332116*^9, 3.5796297739926515`*^9}, {
   3.580849077769948*^9, 3.5808490894977407`*^9}, {3.580849132426412*^9, 
   3.580849161327857*^9}, {3.580992764798657*^9, 3.580992773125231*^9}, {
   3.58099284506203*^9, 3.580992869784471*^9}, {3.580993692414856*^9, 
   3.58099384278482*^9}, {3.580993873761763*^9, 3.5809938866812973`*^9}, {
   3.58099391836957*^9, 3.580993948080406*^9}, {3.580994934425664*^9, 
   3.5809949617963448`*^9}, {3.581203765461501*^9, 3.5812037742629147`*^9}, {
   3.5813587695400877`*^9, 3.581358782683991*^9}, {3.581358812852191*^9, 
   3.581358861945487*^9}, {3.581358899633408*^9, 3.581358900034346*^9}, {
   3.58135893230658*^9, 3.5813589629881983`*^9}, {3.583592301436635*^9, 
   3.583592373919807*^9}, {3.583592539549716*^9, 3.5835925426308107`*^9}, 
   3.583592623754642*^9, {3.5835926585225477`*^9, 3.58359274365753*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"stt\"\>", "\<\"sth\"\>", "\<\"sta\"\>", "\<\"stk\"\>", \
"\<\"stH\"\>", "\<\"Tb\"\>", "\<\"Tt\"\>", "\<\"nsH\"\>", "\<\"nsk\"\>", \
"\<\"nsa\"\>", "\<\"nsh\"\>", "\<\"nst\"\>"},
     {"1", "1", "1", "2", "3", "4", "4", "5", "6", "7", "7", "7"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581783472251993*^9, 3.581786220102186*^9, 3.581845055193597*^9, 
   3.581863757699512*^9, 3.5818772045614853`*^9, 3.58187980983994*^9, 
   3.581887075595325*^9, 3.581887573627431*^9, 3.581893344688223*^9, 
   3.581940330759931*^9, 3.5822772865110493`*^9, 3.582286553483965*^9, 
   3.582469336691162*^9, 3.582469628071211*^9, 3.5825012032570963`*^9, 
   3.5825707914377317`*^9, 3.582581015981018*^9, 3.582635263475504*^9, 
   3.58265007849321*^9, 3.5826511925026484`*^9, 3.5826579166553793`*^9, 
   3.582734525345457*^9, 3.582972499717348*^9, 3.5829737398736563`*^9, 
   3.582975313529567*^9, 3.582979546729698*^9, 3.583001847301985*^9, 
   3.5830137995309772`*^9, 3.583016967449551*^9, 3.583017985267166*^9, 
   3.583592354606443*^9, {3.583592735654747*^9, 3.5835927441414413`*^9}, 
   3.583592810226804*^9, 3.583598799645286*^9, 3.5835995645670958`*^9, 
   3.583617154314316*^9, 3.583621084571512*^9, 3.605280071417344*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EffLabelMap", "[", "JLabel_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"EffList", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", "JLabel", ",",
      "1"}], "]"}], "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.580993901922316*^9, 3.580993915347747*^9}, {
  3.5809939655483932`*^9, 3.5809940347238493`*^9}, {3.580994473149459*^9, 
  3.58099452318436*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"geff", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", "#1"}], "]"}], "&"}], "/@",
     "EffOriginsFoot"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580848867617908*^9, 3.580848941835559*^9}, {
  3.5808491745738907`*^9, 3.580849177772203*^9}, {3.5811738057539186`*^9, 
  3.581173806073923*^9}, {3.581192644568186*^9, 3.581192645799872*^9}, {
  3.581336047090475*^9, 3.5813360478253517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"baseTwistArguments", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "\[Xi]bf", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "Qb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]}], "}"}],
      "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"nb", "-", "1"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5813566797141113`*^9, 3.5813568072052298`*^9}, {
  3.581848947032589*^9, 3.581848947117156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetExtStanceTwists", "[", 
   RowBox[{
    RowBox[{"bodyNumber_", "?", "IntegerQ"}], "/;", 
    RowBox[{"0", "<", "bodyNumber", "\[LessEqual]", 
     RowBox[{"nr", "+", "1"}]}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"Join", "[", 
    RowBox[{"baseTwistArguments", ",", 
     RowBox[{"GetStanceTwists", "[", "bodyNumber", "]"}]}], "]"}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.58135578311585*^9, 3.581355890032981*^9}, {
   3.58135593130789*^9, 3.581355950953436*^9}, {3.5813560297659273`*^9, 
   3.581356106679393*^9}, {3.581356155900874*^9, 3.5813562014757023`*^9}, {
   3.581356239268548*^9, 3.581356242149673*^9}, {3.581356307812584*^9, 
   3.5813563664117727`*^9}, {3.581356417499526*^9, 3.581356517412736*^9}, 
   3.581356677677006*^9, {3.581356789038993*^9, 3.581356795303422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"geff", "[", "\[Theta]", "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ParallelSimplify", "[", 
      RowBox[{
       RowBox[{"FK", "[", 
        RowBox[{
         RowBox[{"GetExtStanceTwists", "[", 
          RowBox[{"EffList", "\[LeftDoubleBracket]", 
           RowBox[{"#1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"geff", "[", "0", "]"}], "\[LeftDoubleBracket]", "#1", 
          "\[RightDoubleBracket]"}]}], "]"}], "&"}], "]"}], ")"}], "/@", 
    RowBox[{"Range", "[", "nEff", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580849181755529*^9, 3.580849280229498*^9}, {
  3.580994230736444*^9, 3.5809942523436527`*^9}, {3.581336057788938*^9, 
  3.5813360590122623`*^9}, {3.5813565385097513`*^9, 3.5813565387917767`*^9}, {
  3.58135658382452*^9, 3.581356593825116*^9}, {3.581701943887278*^9, 
  3.581701967539517*^9}, {3.583593074949048*^9, 3.583593103729876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"peff", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RigidPosition", "[", "#1", "]"}], "&"}], ")"}], "/@", 
    RowBox[{"geff", "[", "\[Theta]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5809930125239573`*^9, 3.58099305611425*^9}, {
   3.58099311266763*^9, 3.580993181642729*^9}, {3.58119271577531*^9, 
   3.581192729576235*^9}, 3.581356595335176*^9, {3.581357154579224*^9, 
   3.581357187212719*^9}, 3.581357337908696*^9, {3.581701970208362*^9, 
   3.581702023000637*^9}, {3.583593108965446*^9, 3.583593118749979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veff", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"peff", ",", "t"}], "]"}], "//", "ParallelSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.580993227499078*^9, 3.580993235699239*^9}, 
   3.581357196131123*^9, {3.581702027800124*^9, 3.5817020287036448`*^9}, {
   3.583593121176516*^9, 3.5835931235405684`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reff", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RigidOrientation", "[", "#1", "]"}], "&"}], "/@", 
    RowBox[{"geff", "[", "\[Theta]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580993246931726*^9, 3.5809932823085012`*^9}, {
  3.581192746923575*^9, 3.5811927646088037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Omega]eff", "=", 
   RowBox[{"ParallelSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CrossProd", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "t"], "#1"}], ".", 
         RowBox[{"Transpose", "[", "#1", "]"}]}], "]"}], "&"}], ")"}], "/@", 
     "Reff"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580993286949398*^9, 3.58099329182502*^9}, {
   3.580993387513631*^9, 3.580993462657041*^9}, {3.580994283270062*^9, 
   3.5809942877174664`*^9}, 3.580994884555601*^9, {3.5809949866062393`*^9, 
   3.5809949869893847`*^9}, {3.581357215854004*^9, 3.581357215880179*^9}, {
   3.581357322374995*^9, 3.581357323823495*^9}, {3.5816139735823298`*^9, 
   3.581613984014104*^9}, {3.583592961613953*^9, 3.583592965132876*^9}, {
   3.583593135031921*^9, 3.583593145034546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Rstt", "=", 
  RowBox[{"Reff", "\[LeftDoubleBracket]", 
   RowBox[{"EffLabelMap", "[", "\"\<stt\>\"", "]"}], 
   "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.581613207138397*^9, 3.58161322231164*^9}, {
  3.581613280099833*^9, 3.581613429507257*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"cos", "(", 
       RowBox[{
        SubscriptBox["q", "y"], "(", "t", ")"}], ")"}], "0", 
      RowBox[{"sin", "(", 
       RowBox[{
        SubscriptBox["q", "y"], "(", "t", ")"}], ")"}]},
     {"0", "1", "0"},
     {
      RowBox[{"-", 
       RowBox[{"sin", "(", 
        RowBox[{
         SubscriptBox["q", "y"], "(", "t", ")"}], ")"}]}], "0", 
      RowBox[{"cos", "(", 
       RowBox[{
        SubscriptBox["q", "y"], "(", "t", ")"}], ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.581783473425295*^9, 3.581786220877636*^9, 
  3.581845056023658*^9, 3.581863758517618*^9, 3.581877205219191*^9, 
  3.581879810551256*^9, 3.5818870763889427`*^9, 3.581887574472937*^9, 
  3.581893345531766*^9, 3.5819403315627203`*^9, 3.582277287352028*^9, 
  3.5822865542193947`*^9, 3.5824696288661137`*^9, 3.582501204100669*^9, 
  3.5825707921953497`*^9, 3.582581016806903*^9, 3.582635264127975*^9, 
  3.582650079338105*^9, 3.582651193296997*^9, 3.582657917476412*^9, 
  3.582734526065675*^9, 3.5829725012791157`*^9, 3.582973741520245*^9, 
  3.582975314350773*^9, 3.58297954755051*^9, 3.583001848111513*^9, 
  3.5830138003567057`*^9, 3.583016968144238*^9, 3.583017986095811*^9, 
  3.583592827422474*^9, 3.583592920177243*^9, 3.583593152188065*^9, 
  3.58359880975841*^9, 3.583599574947163*^9, 3.5836171646671457`*^9, 
  3.583621094597275*^9, 3.6052800816261272`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["q", "y"], "[", "t", "]"}], "\[Rule]", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"Rstt", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"-", 
     RowBox[{"Rstt", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.581613420285701*^9, 3.581613522440248*^9}, {
  3.583592924671805*^9, 3.583592925313583*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["q", "y"], "(", "t", ")"}], "\[Rule]", 
   RowBox[{
    SuperscriptBox["tan", 
     RowBox[{"-", "1"}]], "(", 
    RowBox[{
     RowBox[{"cos", "(", 
      RowBox[{
       SubscriptBox["q", "y"], "(", "t", ")"}], ")"}], ",", 
     RowBox[{"sin", "(", 
      RowBox[{
       SubscriptBox["q", "y"], "(", "t", ")"}], ")"}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581783473542036*^9, 3.5817862209551*^9, 3.581845056091893*^9, 
   3.5818637585720463`*^9, 3.581877205375256*^9, 3.5818798105941267`*^9, 
   3.581887076445862*^9, 3.5818875745416317`*^9, 3.5818933456224003`*^9, 
   3.581940331623198*^9, 3.582277287419594*^9, 3.582286554274716*^9, 
   3.5824696289358463`*^9, 3.582501204177162*^9, 3.582570792241088*^9, 
   3.582581016869979*^9, 3.5826352642197866`*^9, 3.582650079400055*^9, 
   3.582651193357115*^9, 3.582657917547776*^9, 3.582734526125053*^9, 
   3.5829725013796177`*^9, 3.582973741672798*^9, 3.582975314423848*^9, 
   3.582979547603907*^9, 3.5830018481666193`*^9, 3.583013800400824*^9, 
   3.583016968176116*^9, 3.583017986147105*^9, 3.583592829023281*^9, 
   3.583592932265069*^9, {3.583593153104149*^9, 3.583593164263619*^9}, 
   3.583598809789715*^9, 3.583599575002708*^9, 3.5836171647090693`*^9, 
   3.583621094634077*^9, 3.60528008167036*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]eff", "\[LeftDoubleBracket]", 
  RowBox[{"EffLabelMap", "[", "\"\<stt\>\"", "]"}], 
  "\[RightDoubleBracket]"}]], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "y"], "\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], ",", "0"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.583592955377552*^9, {3.583593162176358*^9, 3.583593164869418*^9}, 
   3.583598809798307*^9, 3.5835995750498743`*^9, 3.583617164714299*^9, 
   3.583621094638616*^9, 3.605280081674717*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Omega]eff", "\[LeftDoubleBracket]", 
        RowBox[{"EffLabelMap", "[", "\"\<stt\>\"", "]"}], 
        "\[RightDoubleBracket]"}], ")"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "wy", ",", "0"}], "}"}]}], ",", "dQb"}], "]"}], "//",
    "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.5816139940454407`*^9, 3.581614008261128*^9}, {
   3.581614046540195*^9, 3.581614069119894*^9}, {3.581614262583598*^9, 
   3.581614294204623*^9}, {3.5817010202991867`*^9, 3.58170102309518*^9}, {
   3.5819431101010933`*^9, 3.581943124249872*^9}, {3.5835928382460546`*^9, 
   3.58359283865423*^9}, {3.58359294200695*^9, 3.583592946186911*^9}, {
   3.583592982975995*^9, 3.5835930165684023`*^9}, 3.583593158608387*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"Solve", "::", "svars"}], "MessageName"], 
   RowBox[{
   ":", " "}], "\<\"Equations may not give solutions for all \\\"solve\\\" \
variables. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/svars\\\", \
ButtonNote -> \\\"Solve::svars\\\"]\\)\"\>"}], TraditionalForm]], "Message", \
"MSG",
 CellChangeTimes->{{3.583593003177331*^9, 3.583593017348146*^9}, {
   3.5835931590178843`*^9, 3.583593165460175*^9}, 3.583598809852664*^9, 
   3.583599575106206*^9, 3.583617164756008*^9, 3.583621094677286*^9, 
   3.605280081717942*^9}],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "y"], "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "wy"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581783473950193*^9, 3.581786221456162*^9, 3.581845056447234*^9, 
   3.58186375895615*^9, 3.581877205858355*^9, 3.5818798109588823`*^9, 
   3.581887076850621*^9, 3.581887574949173*^9, 3.581893345983511*^9, 
   3.581940331979257*^9, {3.581943112525096*^9, 3.5819431246089077`*^9}, 
   3.582277287822379*^9, 3.58228655466476*^9, 3.582469629327277*^9, 
   3.582501204577771*^9, 3.582570792612248*^9, 3.582581017268993*^9, 
   3.582635264590356*^9, 3.582650079794154*^9, 3.582651193716091*^9, 
   3.582657917908667*^9, 3.5827345264537163`*^9, 3.582972509213208*^9, 
   3.582973749629014*^9, 3.582975314836417*^9, 3.582979547988627*^9, 
   3.583001848527306*^9, 3.5830138007847757`*^9, 3.58301696855402*^9, 
   3.583017986497093*^9, 3.583592832480043*^9, {3.58359294241286*^9, 
   3.5835929486593933`*^9}, {3.5835929884575987`*^9, 3.583593017352253*^9}, {
   3.583593159023032*^9, 3.583593165464347*^9}, 3.583598809872713*^9, 
   3.5835995751096487`*^9, 3.5836171647599173`*^9, 3.583621094679549*^9, 
   3.605280081753645*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pstt", "=", 
   RowBox[{"peff", "\[LeftDoubleBracket]", 
    RowBox[{"EffLabelMap", "[", "\"\<stt\>\"", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pnsh", "=", 
   RowBox[{"peff", "\[LeftDoubleBracket]", 
    RowBox[{"EffLabelMap", "[", "\"\<nsh\>\"", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pnst", "=", 
   RowBox[{"peff", "\[LeftDoubleBracket]", 
    RowBox[{"EffLabelMap", "[", "\"\<nst\>\"", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.581702270884181*^9, 3.581702291232975*^9}, {
  3.581702322987729*^9, 3.581702363061376*^9}, {3.581702401276751*^9, 
  3.5817024337781687`*^9}, {3.581702477181798*^9, 3.581702529482278*^9}, {
  3.5817166086149893`*^9, 3.5817166186726427`*^9}, {3.581943142217896*^9, 
  3.581943159487605*^9}, {3.5836171186843767`*^9, 3.58361712707957*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"pstt", ",", "\"\<pstt\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"pnsh", ",", "\"\<pnsh\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.581702270884181*^9, 3.581702291232975*^9}, {
  3.581702322987729*^9, 3.581702363061376*^9}, {3.581702401276751*^9, 
  3.5817024337781687`*^9}, {3.581702477181798*^9, 3.581702529482278*^9}, {
  3.5817166086149893`*^9, 3.5817166186726427`*^9}, {3.581943142217896*^9, 
  3.5819431621113377`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pnst", "=", 
   RowBox[{"peff", "\[LeftDoubleBracket]", 
    RowBox[{"EffLabelMap", "[", "\"\<nst\>\"", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vnst", "=", 
   RowBox[{"veff", "\[LeftDoubleBracket]", 
    RowBox[{"EffLabelMap", "[", "\"\<nst\>\"", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Rnst", "=", 
   RowBox[{
    RowBox[{"Reff", "\[LeftDoubleBracket]", 
     RowBox[{"EffLabelMap", "[", "\"\<nst\>\"", "]"}], 
     "\[RightDoubleBracket]"}], "//", "ParallelSimplify"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Omega]nst", "=", 
   RowBox[{
    RowBox[{"\[Omega]eff", "\[LeftDoubleBracket]", 
     RowBox[{"EffLabelMap", "[", "\"\<nst\>\"", "]"}], 
     "\[RightDoubleBracket]"}], "//", "ParallelSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.581702270884181*^9, 3.581702291232975*^9}, {
  3.581702322987729*^9, 3.581702363061376*^9}, {3.581702401276751*^9, 
  3.5817024337781687`*^9}, {3.581702477181798*^9, 3.581702543084289*^9}, {
  3.583593045245747*^9, 3.583593067677175*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"pnst", ",", "\"\<pnst\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"vnst", ",", "\"\<vnst\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"Rnst", ",", "\"\<Rnst\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"\[Omega]nst", ",", "\"\<wnst\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.58170212808146*^9, 3.5817021658186626`*^9}, {
   3.581702261321188*^9, 3.581702310854439*^9}, {3.58170255035472*^9, 
   3.581702580098275*^9}, {3.58171659771392*^9, 3.581716603951947*^9}, {
   3.581716996563513*^9, 3.5817169975992804`*^9}, 3.5819431558436213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
x-position of the hip  for the stance heel lift controller with the sagittal \
restriction applied\
\>", "Subsection",
 CellChangeTimes->{{3.5810021408213587`*^9, 3.581002152509514*^9}, {
  3.581002377542115*^9, 3.581002390093071*^9}, {3.581614759416771*^9, 
  3.5816147606083937`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"peff\[Zeta]", "=", 
   RowBox[{
    RowBox[{"peff", "/.", "\[CapitalZeta]subs"}], "//", 
    "ParallelSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581878362660905*^9, 3.581878373789708*^9}, 
   3.581878447358857*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pHipX", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"peff", "\[LeftDoubleBracket]", 
      RowBox[{"EffLabelMap", "[", "\"\<Tb\>\"", "]"}], 
      "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}], "-", 
    RowBox[{
     RowBox[{"peff", "\[LeftDoubleBracket]", 
      RowBox[{"EffLabelMap", "[", "\"\<sta\>\"", "]"}], 
      "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.581001946674618*^9, 3.581002118213849*^9}, {
   3.581002305118183*^9, 3.581002311885735*^9}, {3.581195608438088*^9, 
   3.5811956157297688`*^9}, 3.58359318323729*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"cos", "(", 
     FractionBox[
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}], "2"], ")"}]}], " ", 
   RowBox[{"sin", "(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["q", "y"], "(", "t", ")"}]}], "+", 
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "+", 
     FractionBox[
      RowBox[{
       SubscriptBox["q", "2"], "(", "t", ")"}], "2"]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.5817834769224157`*^9, 3.581786224420561*^9, 
  3.581845059377001*^9, 3.581863761096158*^9, 3.5818772077899446`*^9, 
  3.581878443180279*^9, 3.5818799003792267`*^9, 3.581887166425394*^9, 
  3.581887664710267*^9, 3.5818934352504797`*^9, 3.581940421377887*^9, 
  3.5822773779390182`*^9, 3.582286644014339*^9, 3.58246971820857*^9, 
  3.582501293717476*^9, 3.582570881808086*^9, 3.5825811064505787`*^9, 
  3.5826353543646803`*^9, 3.582650169244566*^9, 3.582651282955855*^9, 
  3.582658006948498*^9, 3.582734601070674*^9, 3.582972609424254*^9, 
  3.5829738502121677`*^9, 3.582975403879499*^9, 3.582979637176429*^9, 
  3.583001937491393*^9, 3.583013889892309*^9, 3.583017057559022*^9, 
  3.583018075841463*^9, 3.58359318358097*^9, 3.583598811075433*^9, 
  3.583599576330091*^9, 3.583617165952814*^9, 3.583621095874446*^9, 
  3.605280082965231*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"pHipX", ",", "\"\<pHipX\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5810021580764933`*^9, 3.58100217697159*^9}, {
  3.581002262203117*^9, 3.581002300555286*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot positions", "Subsection",
 CellChangeTimes->{{3.5788281494051733`*^9, 3.57882815272318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pList", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<sta\>\"", ",", "\"\<stt\>\"", ",", "\"\<sth\>\"", ",", "\"\<sta\>\"",
      ",", "\[IndentingNewLine]", "\"\<stk\>\"", ",", "\"\<stH\>\"", ",", 
     "\"\<Tb\>\"", ",", "\"\<Tt\>\"", ",", "\"\<Tb\>\"", ",", "\"\<nsH\>\"", 
     ",", "\"\<nsk\>\"", ",", "\[IndentingNewLine]", "\"\<nsa\>\"", ",", 
     "\"\<nsh\>\"", ",", "\"\<nst\>\"", ",", "\"\<nsa\>\""}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5835932403849697`*^9, 3.5835932611366463`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"peff", "\[LeftDoubleBracket]", 
        RowBox[{"EffLabelMap", "[", "#1", "]"}], "\[RightDoubleBracket]"}], 
       "&"}], ")"}], "/@", "pList"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"WriteExpr", "[", 
     RowBox[{"pp", ",", "\"\<plotpos\>\""}], "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.578828156248925*^9, 3.578828182381076*^9}, {
   3.5788286585931587`*^9, 3.578828732373548*^9}, {3.578828797877434*^9, 
   3.5788288039640903`*^9}, {3.579573445086961*^9, 3.579573492711017*^9}, {
   3.5795735277274103`*^9, 3.579573548447579*^9}, {3.5796239625944576`*^9, 
   3.579624008176583*^9}, {3.579629558616951*^9, 3.5796295851474705`*^9}, {
   3.5796298064971623`*^9, 3.5796298091168966`*^9}, {3.580995154000506*^9, 
   3.580995220950945*^9}, 3.5809952685478497`*^9, {3.5810106909821663`*^9, 
   3.5810107171344633`*^9}, {3.581359436585627*^9, 3.5813594473624887`*^9}, 
   3.581359552422249*^9, {3.581359582667556*^9, 3.5813596408945217`*^9}, {
   3.581359691479912*^9, 3.581359733251086*^9}, {3.581359790774086*^9, 
   3.581359880835099*^9}, {3.58135995711742*^9, 3.581359981109912*^9}, {
   3.581360125008984*^9, 3.5813601273848257`*^9}, 3.581878412540268*^9, {
   3.582637690698374*^9, 3.582637691792192*^9}, {3.5835931922311068`*^9, 
   3.58359322632732*^9}, {3.58359326587075*^9, 3.5835932716837254`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp\[Zeta]", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"peff\[Zeta]", "\[LeftDoubleBracket]", 
        RowBox[{"EffLabelMap", "[", "#1", "]"}], "\[RightDoubleBracket]"}], 
       "&"}], ")"}], "/@", "pList"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{"pp\[Zeta]", ",", "\"\<plotposz\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.581878388344019*^9, 3.581878419077365*^9}, {
  3.582637694423409*^9, 3.58263769545581*^9}, {3.582643684198349*^9, 
  3.582643684857215*^9}, {3.583593283623456*^9, 3.583593288321026*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"npp", "=", 
  RowBox[{
   RowBox[{"Dimensions", "[", "pp\[Zeta]", "]"}], "\[LeftDoubleBracket]", "2",
    "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.582635651374446*^9, 3.582635656619734*^9}, {
  3.582635723275745*^9, 3.5826357476139174`*^9}, {3.582643841408102*^9, 
  3.5826438427195177`*^9}}],

Cell[BoxData[
 FormBox["15", TraditionalForm]], "Output",
 CellChangeTimes->{3.582643843030889*^9, 3.582650169470633*^9, 
  3.582651283218934*^9, 3.582658007150236*^9, 3.582734601300646*^9, 
  3.5829726101337547`*^9, 3.582973851050764*^9, 3.582975404139043*^9, 
  3.582979637472629*^9, 3.583001937720097*^9, 3.5830138901222486`*^9, 
  3.583017057731057*^9, 3.583018076068019*^9, 3.583593290398353*^9, 
  3.583598811150831*^9, 3.583599576413703*^9, 3.5836171660225983`*^9, 
  3.583621095960116*^9, 3.605280083015493*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flat heel controller", "Subsection",
 CellChangeTimes->{{3.581876955171578*^9, 3.5818769596188307`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Expressions for perturbing along the guard\
\>", "Subsubsection",
 CellChangeTimes->{{3.581942565087336*^9, 3.5819425801109333`*^9}, {
  3.583593313001987*^9, 3.583593316242599*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr\[Zeta]", "[", 
   RowBox[{
    RowBox[{"peff\[Zeta]", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"EffLabelMap", "[", "\"\<nsh\>\"", "]"}], ",", "3"}], 
     "\[RightDoubleBracket]"}], ",", " ", "\"\<hnshz\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.581941750747267*^9, 3.5819417761844397`*^9}, {
  3.58194237146096*^9, 3.5819423717721453`*^9}, {3.581942560695134*^9, 
  3.581942585171235*^9}, {3.581943176457122*^9, 3.581943176707987*^9}, {
  3.581943242966257*^9, 3.5819432660156603`*^9}, {3.583593306612685*^9, 
  3.583593307101862*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examine spatial dissipation rate", "Subsubsection",
 CellChangeTimes->{{3.581943943519989*^9, 3.581943948639605*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Rho]"}], "#1"}]], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{".01", ",", " ", ".001"}], "}"}]}], "/.", 
  RowBox[{"\[Rho]", "\[Rule]", "500"}]}]], "Input",
 CellChangeTimes->{{3.58194402500299*^9, 3.581944051646144*^9}, {
  3.583593344583974*^9, 3.583593345424851*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.006737946999085467`", ",", "0.6065306597126334`"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.581944037444036*^9, 3.5819440520151873`*^9}, 
   3.5822773898155603`*^9, 3.58228665554804*^9, 3.582469730005168*^9, 
   3.582501347518837*^9, 3.582570893241475*^9, 3.5825811182247458`*^9, 
   3.5826353659563026`*^9, 3.5826501794940166`*^9, 3.582651293316482*^9, 
   3.582658017111126*^9, 3.58273461120875*^9, 3.582975414135565*^9, 
   3.582979647671053*^9, 3.583001947665365*^9, 3.583013900108262*^9, 
   3.583017067606955*^9, 3.5830180859792128`*^9, 3.583598811164158*^9, 
   3.5835995764341908`*^9, 3.583617166028139*^9, 3.583621095976853*^9, 
   3.605280083023593*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "500"}], "x"}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", ".001"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.58194395095122*^9, 3.581944002039132*^9}, {
  3.58194410082281*^9, 3.581944102517461*^9}}],

Cell[BoxData[
 FormBox[
  GraphicsBox[{{}, {}, 
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwVxXk41HkAB+DwyFUZSkqTo7U8JSoGUebDUFlGfjrJMZYcIWQIT+yjkpTV
IRNisOpBk6OEerJqER7HdJk2nqXt6TvjmmHYdJBjd/94n9coKOZAiOKyZcs8
/vP/HKV24+DYRofeqxfmlpbkAGdbDYeXy/Qy8Al/uihHg84JoSXvDpNm0fsx
ZUGOqSllfzqvntkvvLIwOydHdoDIWIv3nLlkm9Q981kOP15TpgZPxAx5E9Ui
k8rRtr32iSpPzNyjGGY4/E6OxMXKgyq8GaZP1WLGYq0cNxiecaVxyijr+Gxp
fEyOFu4N86QhTXwd6Pu5V12O0tzA0SU1HbTNX5hqb56Egu6K27RcPXBV3rJo
kZPwCKC/++WZAZQ3kvBK/Unwyw3nBqs2YVIUX/CwdwIVZ6rPDUf9iIB5/8C1
qRMwfSjrLF4whenNzKYcqwkkMRvPNrdvwczL9EsCsQzMrZbfLgeYg66Xo9FS
KENBYmW4y/g2rIlr9Z09JENQlsik7sgO8PX+iPykKoPViprEglJL3FXwFDa1
SiFr7FVkLGcgvnF9QkiiFDHXRi+7hFhDoeTTPRsLKcwL/U9VVdmgey7dpnx8
HH0vdXM6NXcic+iFFb1sHPXWZlr2vnbIO/3lrS5nHKnt57s5rfZYIMKvtrrj
oKUPpH3ftBucVFFdyOsxvOdm8iYjHfBBtmqX9NoYeNkp4txXTFwP31vz2H0M
zjKxa9cqR2gopft0aIzBcLO6vlKdI1wjGqPqhKOYnvO6tjbYCW4OEQsqWaMI
DOl4cFiVBQFNcIDrMYq24/6x0U0s9Pj3dQZrjCLre5w5K9IZyrl8gW3PCKa2
NBQ4abqgh3pl+/XqCNzk62/rtbiAGKUk+1EjcGLf8zUI2wNdzfrmPJ0R8B2b
tP9W24ta7Yz1WYPDmOiaCE16shdmhb9qOJcM4y8pO8KBsw8ZgVWKgtBhNJe9
UB/UckVW59Lc5OZh7P4n5Vj5Y1c8CutkvZiWwHDgbqWZ30+I3bCB4dUkwbdD
szcur3RD0HbNWy/TJIg+kWCh89ANiT9YqrW5SdCvvSY0OdQdPS2mZt00CSoO
7ijKX8uGtLbZJ7lfjNXmZ86SJ2x8eXDzVtIdMbiFI0qqJz0QYPjFqDJKjFNl
adbeq/djgPb20Ro7MUSO+SHBjftxztfZQ0lFDLP4N5auYZ4w2Z0Kh9cEtNKi
o1uXU5CeNlDOKSEQnecOFalQsJx97t1QTFAQ5ha8Uo2CZCW9sZ9PsGnbt+hJ
DQo59kPZBkUEjKcHM+5rURhtKHlQnU/gM6jewNhIIVva3tVznaBsXbK2A4OC
ULnYTjOdIHTeM7/amkLvQlmr1XkCsw8m+vq2FCym3Q97nyOorxBtXrKjkLIu
M++3NIIOm+1OLaAwdIV/lZFKMH5oJGaPOwX20fcefqcJanY+/dzAphDLnIo9
m0DApfPOmOynkO9Xwi+PJ5gnrIsqXhQuZfetno4jWMUtLu46QuFP+UVuRgzB
myMJxvbeFGZ+TyT3ogny7NkCgQ+F+4EK/q9PEhgqzjVk+VHYkvIhih5FIJG8
2jXvT2E53VqJFUkg6KpoieJQePbR6HZYBEF09S/7hgIpnDpezs4+QWB1/bDQ
I4iCvXXrUl04wb+iPlEQ
      "]]}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   AxesOrigin->{0, 0.6},
   PlotRange->{{0, 0.001}, {0.6065306659017218, 0.9999999897959184}},
   PlotRangeClipping->True,
   PlotRangePadding->{
     Scaled[0.02], 
     Scaled[0.02]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.581943985317285*^9, 3.581944002319858*^9}, 
   3.5819441034287853`*^9, 3.58227738990547*^9, 3.582286655597933*^9, 
   3.582469730079382*^9, 3.582501347674809*^9, 3.582570893281143*^9, 
   3.5825811183120947`*^9, 3.582635366055711*^9, 3.5826501795755873`*^9, 
   3.582651293377246*^9, 3.582658017186816*^9, 3.5827346113055277`*^9, 
   3.582975414222302*^9, 3.582979647819311*^9, 3.583001947734069*^9, 
   3.583013900192111*^9, 3.583017067634557*^9, 3.5830180860446377`*^9, 
   3.583598811206759*^9, 3.583599576484046*^9, 3.583617166062255*^9, 
   3.5836210960340147`*^9, 3.605280083052496*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SVA Model", "Section",
 CellChangeTimes->{{3.5813381179623327`*^9, 3.581338120098489*^9}, {
  3.581345059188657*^9, 3.581345060005178*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MassesRobot", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"nb", "-", "1"}]}], "]"}], ",", 
    RowBox[{"mm", "/.", "constsubs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.578834783294169*^9, 3.5788349878914557`*^9}, {
   3.578835237226836*^9, 3.578835241708209*^9}, 3.5788353467274*^9, {
   3.5795712557446203`*^9, 3.5795712878503213`*^9}, {3.579571343998262*^9, 
   3.579571345014203*^9}, {3.5795713958782578`*^9, 3.579571487401924*^9}, {
   3.580724270990967*^9, 3.580724271828389*^9}, {3.580724326778311*^9, 
   3.580724346248258*^9}, 3.5807244270993757`*^9, {3.580725447690282*^9, 
   3.580725464906304*^9}, {3.5807255792826033`*^9, 3.5807256356944036`*^9}, {
   3.5807256686940813`*^9, 3.58072570199092*^9}, {3.580725825024007*^9, 
   3.5807260066156073`*^9}, {3.580815290295038*^9, 3.580815306934783*^9}, 
   3.5808155866232967`*^9, {3.58084412623551*^9, 3.580844126426605*^9}, {
   3.580844786547223*^9, 3.580844787387364*^9}, {3.58135156550491*^9, 
   3.58135157445756*^9}, {3.581353243768648*^9, 3.5813532451736937`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", 
    FractionBox["1", "10"], ",", 
    FractionBox["3", "2"], ",", "5", ",", "20", ",", "5", ",", 
    FractionBox["3", "2"], ",", 
    FractionBox["1", "10"]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBuL239Mjtq5/5fh0xc92EN2oOmU1iGbOPflmG5C+WcH0
B0Rf+PmCaTuQNvON3HwZSB/hcgq/CqQ36bIfuwOkky8W2T4G0kf7zcJBtNbV
7XOeAOkrvMGKL4A0T6qIJoh+eVQ3HUSLT4ixeA2ka07IiDJteOWYsP6YJohu
aTHduAxIq6zg0F8NpLnk1piD6Fvl+t+ZNr5yjNnhcoYFSCfZVdqIAOlH7qsN
zYD0HbbT+tZAeobfoTWhQNoqovhFDJB+kLa2OBZIL7ivticBSLMH5iq1AekN
tie2/QbSKy7/Ov4XSDfHVazm2PTK8WFXeyMfkC5+VsorAKQNYw/1gGiH3z8K
NDe/cnSST5fWAdLeUQLVIJrv5iFBUyCtVs341wxIq/AnrWq788oRALequCQ=

  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Offsets", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nb", "-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", 
    "JointOffsetsSTT"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Coms", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nb", "-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", 
    "ComOffsetsSTT"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.581351703242351*^9, 3.581351747321041*^9}, {
  3.581353359758847*^9, 3.581353367302415*^9}, {3.581353666000231*^9, 
  3.5813536663030033`*^9}, {3.5813541169507236`*^9, 3.5813541170463257`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], "0", 
      FractionBox["1", "10"]},
     {"0", "0", 
      FractionBox["1", "2"]},
     {"0", "0", 
      FractionBox["1", "2"]},
     {"0", 
      FractionBox[
       RowBox[{"p", "(", "1", ")"}], "4"], "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "4"], "0", 
      RowBox[{"-", 
       FractionBox["1", "10"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBmKtozMjtq5/5fjoy892EL2hdMpqEB0QcubNNiAtNoPl
D4heJ/SaaTuQdrkbufkykM7yigu/CqR5LDmP3QHSfOLFto+BdNp+s3AQXcC2
Y84TIL00OljxBZBes1xEE0TPYNFLB9Gh7LEWr0HqP6uKMm145Wj2+ZgmiG5b
a75xGZCuecKhvxpIe/itMQfRuxwCvjNtfOU45bXLGRYg/eRjtY0IkF7estrQ
DEi/CD+tbw2kFSSOrQkF0v/WFr+IAdKK69YWxwJpHzP1PQlAetr0XKU2IF0z
48S230B6n9/f439B5s2tWs2x6ZWjxuH2Rj4gXTmxjFcASItNPtIDomXlyws1
N79y/CabIa0DpNu+CFaD6BsyRwRNgXTPL6a/ZkBaRSt5VdudV44AK2y4ng==

  "]],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["1", "9"]}], "0", 
      FractionBox["1", "27"]},
     {"0", "0", 
      FractionBox["3", "8"]},
     {"0", "0", 
      FractionBox["7", "40"]},
     {"0", 
      FractionBox[
       RowBox[{"p", "(", "1", ")"}], "8"], 
      FractionBox["3", "40"]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["13", "40"]}]},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "8"]}]},
     {
      FractionBox["5", "36"], "0", 
      RowBox[{"-", 
       FractionBox["17", "270"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBmKtozMjtq5/5fjoy892EL2hdMpqEB0QcubNNiAtNoPl
D4heJ/SaaTuQdrkbufkykM7yigu/CqR5LDmP3QHSfOLFto+BdNp+s3AQXcC2
Y84TIL00OljxBZBes1xEE0TPYNFLB9Gh7LEWr0HqP6uKMm145Wj2+ZgmiG5b
a75xGZCuecKhvxpIe/itMQfRuxwCvjNtfOU45bXLGRYg/eRjtY0IkF7estrQ
DEi/CD+tbw2kFSSOrQkF0v/WFr+IAdKK69YWxwJpHzP1PQlAetr0XKU2IF0z
48S230B6n9/f439B5s2tWs2x6ZWjxuH2Rj4gXTmxjFcASItNPtIDomXlyws1
N79y/CabIa0DpNu+CFaD6BsyRwRNgXTPL6a/ZkA6yTJ5VdudV44ALcW46w==

  "]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeEffMap", "[", 
   RowBox[{
    RowBox[{"name_", "?", "StringQ"}], ",", 
    RowBox[{
     RowBox[{"linkNumber_", "?", "IntegerQ"}], "/;", 
     RowBox[{"0", "<", "linkNumber", "\[LessEqual]", "nl"}]}], ",", 
    RowBox[{"linkName_", "?", "StringQ"}], ",", 
    RowBox[{"offset_", "?", "VectorQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<name\>\"", "\[Rule]", "name"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<dof\>\"", "\[Rule]", 
     RowBox[{"linkNumber", "-", "1"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<link\>\"", "\[Rule]", "linkName"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<offset\>\"", "\[Rule]", "offset"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5824687297727633`*^9, 3.582468805340172*^9}, {
  3.58246887985148*^9, 3.582468954930018*^9}, {3.582469097006503*^9, 
  3.58246911443009*^9}, {3.582469810166285*^9, 3.58246985543261*^9}, {
  3.582470036310115*^9, 3.582470042645998*^9}, {3.582470117634433*^9, 
  3.582470138338335*^9}, {3.5824702739996853`*^9, 3.582470276174015*^9}, {
  3.582470506868862*^9, 3.582470534483391*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effYAML", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<stt\>\"", ",", "\"\<SFoot\>\"", ",", "1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<sth\>\"", ",", "\"\<SFoot\>\"", ",", "1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<nst\>\"", ",", "\"\<NSFoot\>\"", ",", "nl"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<nsh\>\"", ",", "\"\<NSFoot\>\"", ",", "nl"}], "}"}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.582469319248975*^9, 3.582469330695238*^9}, {
  3.582469394190358*^9, 3.5824693944455853`*^9}, {3.582469535893586*^9, 
  3.582469554852091*^9}, {3.582469586773096*^9, 3.582469624230199*^9}, {
  3.582470236064711*^9, 3.582470242449802*^9}, {3.582470495988584*^9, 
  3.582470496955648*^9}, {3.582470541259426*^9, 3.5824705911386642`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"stt\"\>", "\<\"SFoot\"\>", "1"},
     {"\<\"sth\"\>", "\<\"SFoot\"\>", "1"},
     {"\<\"nst\"\>", "\<\"NSFoot\"\>", "7"},
     {"\<\"nsh\"\>", "\<\"NSFoot\"\>", "7"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5824697302345037`*^9, {3.582470243258308*^9, 3.5824702517286997`*^9}, {
   3.58247049728447*^9, 3.582470535797906*^9}, {3.5824705887455273`*^9, 
   3.582470591457896*^9}, 3.582501348229465*^9, 3.582570893433025*^9, 
   3.5825811184466743`*^9, 3.5826353662251053`*^9, 3.5826501797010317`*^9, 
   3.5826512934477997`*^9, 3.58265801731782*^9, 3.5827346115137863`*^9, 
   3.582975414368853*^9, 3.5829796479346313`*^9, 3.583001947856409*^9, 
   3.58301390031989*^9, 3.583017067891923*^9, 3.5830180861910667`*^9, 
   3.583593364546722*^9, 3.5835988112949553`*^9, 3.5835995766168833`*^9, 
   3.583617166190284*^9, 3.583621096155402*^9, 3.605280083153277*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParentOriginsSTT", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
     "JointOriginsSTT", ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.582469735391841*^9, 3.582469787634943*^9}, 
   3.582470060036824*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"effMap", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"MakeEffMap", "[", 
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"EffOriginsFoot", "\[LeftDoubleBracket]", 
          RowBox[{"EffLabelMap", "[", 
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"ParentOriginsSTT", "\[LeftDoubleBracket]", 
          RowBox[{
          "#1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], "//", "N"}]}], "]"}], "&"}], ")"}], "/@",
    "effYAML"}]}]], "Input",
 CellChangeTimes->{{3.5824695749904547`*^9, 3.582469647809062*^9}, {
  3.582469723674893*^9, 3.5824697263574543`*^9}, {3.582470158412204*^9, 
  3.582470264206214*^9}, {3.582470376289871*^9, 3.582470389449539*^9}, {
  3.5824704330110064`*^9, 3.5824704464055767`*^9}, {3.582470493368651*^9, 
  3.582470493556788*^9}, {3.58247061584931*^9, 3.582470646918311*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"stt\"\>"}], ",", 
      RowBox[{"\<\"dof\"\>", "\[Rule]", "0"}], ",", 
      RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"SFoot\"\>"}], ",", 
      RowBox[{"\<\"offset\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"sth\"\>"}], ",", 
      RowBox[{"\<\"dof\"\>", "\[Rule]", "0"}], ",", 
      RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"SFoot\"\>"}], ",", 
      RowBox[{"\<\"offset\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.3125`"}], ",", "0.`", ",", "0.`"}], "}"}]}]}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"nst\"\>"}], ",", 
      RowBox[{"\<\"dof\"\>", "\[Rule]", "6"}], ",", 
      RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"NSFoot\"\>"}], ",", 
      RowBox[{"\<\"offset\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.25`", ",", "0.`", ",", 
         RowBox[{"-", "0.1`"}]}], "}"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"nsh\"\>"}], ",", 
      RowBox[{"\<\"dof\"\>", "\[Rule]", "6"}], ",", 
      RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"NSFoot\"\>"}], ",", 
      RowBox[{"\<\"offset\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.0625`"}], ",", "0.`", ",", 
         RowBox[{"-", "0.1`"}]}], "}"}]}]}], "}"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.582470654914091*^9, 3.58247089781705*^9, 
  3.582501348458126*^9, 3.5825708934996367`*^9, 3.582581118542836*^9, 
  3.582635366325138*^9, 3.58265017978815*^9, 3.582651293486916*^9, 
  3.582658017403946*^9, 3.582734611591549*^9, 3.5829754143871107`*^9, 
  3.5829796479759607`*^9, 3.5830019479350023`*^9, 3.583013900392375*^9, 
  3.583017067978243*^9, 3.583018086295373*^9, 3.583593376119966*^9, 
  3.583598811350685*^9, 3.58359957666851*^9, 3.583617166245635*^9, 
  3.583621096232957*^9, 3.605280083192041*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"left", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<coms\>\"", "\[Rule]", "Coms"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<offsets\>\"", "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ne", ",", "3"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<preOffsets\>\"", "\[Rule]", "Offsets"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<inertias\>\"", "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ne", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<extras\>\"", "\[Rule]", "effMap"}]}], 
      "\[IndentingNewLine]", "}"}], "/.", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "//", "N"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581338177880033*^9, 3.581338258473564*^9}, {
   3.5813475620149527`*^9, 3.5813475709587803`*^9}, {3.581351760266148*^9, 
   3.581351772377089*^9}, {3.582465895854727*^9, 3.5824660448776827`*^9}, 
   3.582466087397931*^9, {3.582470907558989*^9, 3.582470930438842*^9}, {
   3.582470986982945*^9, 3.582470994200013*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"right", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<coms\>\"", "\[Rule]", "Coms"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<offsets\>\"", "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ne", ",", "3"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<preOffsets\>\"", "\[Rule]", "Offsets"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<inertias\>\"", "\[Rule]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"ne", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<extras\>\"", "\[Rule]", "effMap"}]}], 
      "\[IndentingNewLine]", "}"}], "/.", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"+", "1"}]}]}], "//", "N"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.58246606710161*^9, 3.582466079798284*^9}, 
   3.582468958108067*^9, {3.582470925559073*^9, 3.582470927446903*^9}, {
   3.582470997446644*^9, 3.582471001599765*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"svaModel", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<name\>\"", "\[Rule]", "\"\<3dFoot-amberx\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<nBaseDof\>\"", "\[Rule]", "nb"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<extDof\>\"", "\[Rule]", "TwistAxesExt"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<aniplotNames\>\"", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<closedFormJacobianNames\>\"", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<sva\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<parentDofs\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"Range", "[", "ne", "]"}], "-", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<masses\>\"", "->", "MassesRobot"}], "//", "N"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<left\>\"", "->", "left"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<right\>\"", "->", "right"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\n", "}"}]}]], "Input",
 CellChangeTimes->{{3.5813304311119003`*^9, 3.58133046809621*^9}, {
  3.581332134008*^9, 3.581332135999946*^9}, {3.581336329816304*^9, 
  3.581336539790883*^9}, {3.581338261761278*^9, 3.581338271749048*^9}, {
  3.5813452871518393`*^9, 3.581345315924172*^9}, {3.581345463964507*^9, 
  3.5813454746821127`*^9}, {3.581345561749745*^9, 3.581345563338667*^9}, {
  3.58134579298072*^9, 3.581345801966535*^9}, {3.581347435673957*^9, 
  3.581347558557176*^9}, {3.581351166404956*^9, 3.581351205439399*^9}, {
  3.581351237830742*^9, 3.581351250845203*^9}, {3.581351296289239*^9, 
  3.581351341809353*^9}, {3.5824657160807257`*^9, 3.582465809331615*^9}, {
  3.582465863947953*^9, 3.582465883297015*^9}, {3.582468257309552*^9, 
  3.582468274243251*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"3dFoot-amberx\"\>"}], ",", 
    RowBox[{"\<\"nBaseDof\"\>", "\[Rule]", "3"}], ",", 
    RowBox[{"\<\"extDof\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"Px\"\>", ",", "\<\"Pz\"\>", ",", "\<\"Ry\"\>", 
       ",", "\<\"-Ry\"\>", ",", "\<\"-Ry\"\>", ",", "\<\"-Ry\"\>", 
       ",", "\<\"Ry\"\>", ",", "\<\"Ry\"\>", ",", "\<\"Ry\"\>"}], "}"}]}], 
    ",", 
    RowBox[{"\<\"aniplotNames\"\>", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"\<\"closedFormJacobianNames\"\>", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"\<\"sva\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"parentDofs\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",",
           "7", ",", "8"}], "}"}]}], ",", 
       RowBox[{"\<\"masses\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "0.`", ",", "0.`", ",", "0.1`", ",", "1.5`", ",", "5.`", ",", "20.`",
           ",", "5.`", ",", "1.5`", ",", "0.1`"}], "}"}]}], ",", 
       RowBox[{"\<\"left\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\<\"coms\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {
               RowBox[{"-", "0.1111111111111111`"}], "0.`", 
               "0.037037037037037035`"},
              {"0.`", "0.`", "0.375`"},
              {"0.`", "0.`", "0.175`"},
              {"0.`", 
               RowBox[{"-", "0.125`"}], "0.075`"},
              {"0.`", "0.`", 
               RowBox[{"-", "0.325`"}]},
              {"0.`", "0.`", 
               RowBox[{"-", "0.125`"}]},
              {"0.1388888888888889`", "0.`", 
               RowBox[{"-", "0.06296296296296296`"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"offsets\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"preOffsets\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {
               RowBox[{"-", "0.25`"}], "0.`", "0.1`"},
              {"0.`", "0.`", "0.5`"},
              {"0.`", "0.`", "0.5`"},
              {"0.`", 
               RowBox[{"-", "0.25`"}], "0.`"},
              {"0.`", "0.`", 
               RowBox[{"-", "0.5`"}]},
              {"0.`", "0.`", 
               RowBox[{"-", "0.5`"}]},
              {"0.25`", "0.`", 
               RowBox[{"-", "0.1`"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"inertias\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"extras\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"stt\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "0.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"SFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"sth\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "0.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"SFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.3125`"}], ",", "0.`", ",", "0.`"}], 
                 "}"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"nst\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "6.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"NSFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0.25`", ",", "0.`", ",", 
                  RowBox[{"-", "0.1`"}]}], "}"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"nsh\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "6.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"NSFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.0625`"}], ",", "0.`", ",", 
                  RowBox[{"-", "0.1`"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
         "}"}]}], ",", 
       RowBox[{"\<\"right\"\>", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\<\"coms\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {
               RowBox[{"-", "0.1111111111111111`"}], "0.`", 
               "0.037037037037037035`"},
              {"0.`", "0.`", "0.375`"},
              {"0.`", "0.`", "0.175`"},
              {"0.`", "0.125`", "0.075`"},
              {"0.`", "0.`", 
               RowBox[{"-", "0.325`"}]},
              {"0.`", "0.`", 
               RowBox[{"-", "0.125`"}]},
              {"0.1388888888888889`", "0.`", 
               RowBox[{"-", "0.06296296296296296`"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"offsets\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"preOffsets\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0.`", "0.`", "0.`"},
              {"0.`", "0.`", "0.`"},
              {
               RowBox[{"-", "0.25`"}], "0.`", "0.1`"},
              {"0.`", "0.`", "0.5`"},
              {"0.`", "0.`", "0.5`"},
              {"0.`", "0.25`", "0.`"},
              {"0.`", "0.`", 
               RowBox[{"-", "0.5`"}]},
              {"0.`", "0.`", 
               RowBox[{"-", "0.5`"}]},
              {"0.25`", "0.`", 
               RowBox[{"-", "0.1`"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"inertias\"\>", "\[Rule]", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]},
              {
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], 
               RowBox[{"{", 
                RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
          ",", 
          RowBox[{"\<\"extras\"\>", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"stt\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "0.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"SFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"sth\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "0.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"SFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.3125`"}], ",", "0.`", ",", "0.`"}], 
                 "}"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"nst\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "6.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"NSFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"0.25`", ",", "0.`", ",", 
                  RowBox[{"-", "0.1`"}]}], "}"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\<\"name\"\>", "\[Rule]", "\<\"nsh\"\>"}], ",", 
               RowBox[{"\<\"dof\"\>", "\[Rule]", "6.`"}], ",", 
               RowBox[{"\<\"link\"\>", "\[Rule]", "\<\"NSFoot\"\>"}], ",", 
               RowBox[{"\<\"offset\"\>", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.0625`"}], ",", "0.`", ",", 
                  RowBox[{"-", "0.1`"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
         "}"}]}]}], "}"}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.581782724854268*^9, 3.581783103868572*^9, 3.581783388716268*^9, 
   3.581785958455248*^9, 3.581786080228249*^9, 3.5817861354353313`*^9, 
   3.5818448909798594`*^9, 3.5818482522170763`*^9, 3.581863472376102*^9, 
   3.581876715648391*^9, 3.5818769217550783`*^9, 3.5818795257984943`*^9, 
   3.581886730674427*^9, 3.581886792708424*^9, 3.5818872896247807`*^9, 
   3.581893058975876*^9, 3.58193988124864*^9, 3.58194004628251*^9, 
   3.582277001906126*^9, 3.582286200331112*^9, 3.582286269429163*^9, 
   3.5824660903090773`*^9, 3.58246973032883*^9, 3.5824708981852407`*^9, 
   3.582470932436575*^9, 3.582471003858735*^9, {3.5824711234404383`*^9, 
   3.5824711266145477`*^9}, 3.582501348782688*^9, 3.582570893591358*^9, 
   3.582581118643491*^9, 3.582635366424315*^9, 3.582650179888139*^9, 
   3.582651293556197*^9, 3.58265801751145*^9, 3.5827346117755404`*^9, 
   3.5829754145060387`*^9, 3.582979648058627*^9, 3.583001948077237*^9, 
   3.5830139004905863`*^9, 3.583017068135214*^9, 3.5830180863803883`*^9, 
   3.583593399037167*^9, 3.5835988114238234`*^9, 3.5835995767570953`*^9, 
   3.583617166364828*^9, 3.5836210963148108`*^9, 3.605280083242774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"YamlWriteFile", "[", 
  RowBox[{"svaModel", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"builddir", ",", "\"\<sva-ambersuite.yaml\>\""}], "}"}], "]"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.581338293191868*^9, 3.58133829971244*^9}, 
   3.5813387382419*^9, {3.581345452977366*^9, 3.5813454591941643`*^9}, {
   3.581886723092197*^9, 3.5818867237475367`*^9}, 3.581886778323097*^9, {
   3.582584612838849*^9, 3.5825846156547403`*^9}}],

Cell[BoxData[
 FormBox["\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/build_old-\
model-2d-feet-amber-suite/sva-ambersuite.yaml\"\>", 
  TraditionalForm]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBeJD7zZGbF3/yvHFLqEOEJ2TtW41iM5Qe/pmG5AO0pT/
A6L59rAwbwfSEiGlmy8Dac64/eFXQXxh5WN3gPSiuc22j4G0BYN7OIi+13ti
zhMg7eWYpfgCSBvc0tQE0VUH3dNBtGJ6icVrID1lra0o04ZXjk9a72iCaLu2
kI3LgPQNIUn91SDx/7vNQfSMizvZmTe+ctRbV3eGBUgbJNtVswJp/birNiJA
WmTxDUMzIP3lFoeBNZB2ebn1qQ2QPsf3eU0okH63aeOLGBD/3MviWCDdMCtj
TwKQPma2UqkNSPtVcWz/DaRPuFmd+AukrWV2rObY9MqRSftoIx+QLuvezSsA
pBmeMvSC6B/3e8o1N79yVJo5R1oHSOv5uFWD6DTVj4KmQNrpjdVfMyDN8bp2
VdudV44AC+XAKA==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["COMPAT: Old form of SVA", "Subsection",
 CellChangeTimes->{{3.58258459920819*^9, 3.58258460762422*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"leftx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<offsets\>\"", "\[Rule]", "Offsets"}], ",", 
       RowBox[{"\"\<comOffsets\>\"", "\[Rule]", "Coms"}]}], "}"}], "/.", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rightx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<offsets\>\"", "\[Rule]", "Offsets"}], ",", 
       RowBox[{"\"\<comOffsets\>\"", "\[Rule]", "Coms"}]}], "}"}], "/.", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"+", "1"}]}]}], "//", "N"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.581338177880033*^9, 3.581338258473564*^9}, {
  3.5813475620149527`*^9, 3.5813475709587803`*^9}, {3.581351760266148*^9, 
  3.581351772377089*^9}, {3.582584639354835*^9, 3.582584639955242*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"svaModelx", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<nBaseDof\>\"", "->", "nb"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<extDof\>\"", "->", "TwistAxesExt"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<masses\>\"", "->", "MassesRobot"}], "//", "N"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<parentDofs\>\"", "\[Rule]", 
     RowBox[{
      RowBox[{"Range", "[", "ne", "]"}], "-", "1"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<left\>\"", "->", "leftx"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<right\>\"", "->", "rightx"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5813304311119003`*^9, 3.58133046809621*^9}, {
  3.581332134008*^9, 3.581332135999946*^9}, {3.581336329816304*^9, 
  3.581336539790883*^9}, {3.581338261761278*^9, 3.581338271749048*^9}, {
  3.5813452871518393`*^9, 3.581345315924172*^9}, {3.581345463964507*^9, 
  3.5813454746821127`*^9}, {3.581345561749745*^9, 3.581345563338667*^9}, {
  3.58134579298072*^9, 3.581345801966535*^9}, {3.581347435673957*^9, 
  3.581347558557176*^9}, {3.581351166404956*^9, 3.581351205439399*^9}, {
  3.581351237830742*^9, 3.581351250845203*^9}, {3.581351296289239*^9, 
  3.581351341809353*^9}, {3.5825846436583138`*^9, 3.582584647346499*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\<\"nBaseDof\"\>", "\[Rule]", "3"}], ",", 
    RowBox[{"\<\"extDof\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\<\"Px\"\>", ",", "\<\"Pz\"\>", ",", "\<\"Ry\"\>", 
       ",", "\<\"-Ry\"\>", ",", "\<\"-Ry\"\>", ",", "\<\"-Ry\"\>", 
       ",", "\<\"Ry\"\>", ",", "\<\"Ry\"\>", ",", "\<\"Ry\"\>"}], "}"}]}], 
    ",", 
    RowBox[{"\<\"masses\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "0.1`", ",", "1.5`", ",", "5.`", ",", "20.`", 
       ",", "5.`", ",", "1.5`", ",", "0.1`"}], "}"}]}], ",", 
    RowBox[{"\<\"parentDofs\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
       "7", ",", "8"}], "}"}]}], ",", 
    RowBox[{"\<\"left\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"offsets\"\>", "\[Rule]", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.`", "0.`", "0.`"},
           {"0.`", "0.`", "0.`"},
           {
            RowBox[{"-", "0.25`"}], "0.`", "0.1`"},
           {"0.`", "0.`", "0.5`"},
           {"0.`", "0.`", "0.5`"},
           {"0.`", 
            RowBox[{"-", "0.25`"}], "0.`"},
           {"0.`", "0.`", 
            RowBox[{"-", "0.5`"}]},
           {"0.`", "0.`", 
            RowBox[{"-", "0.5`"}]},
           {"0.25`", "0.`", 
            RowBox[{"-", "0.1`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ",", 
       RowBox[{"\<\"comOffsets\"\>", "\[Rule]", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.`", "0.`", "0.`"},
           {"0.`", "0.`", "0.`"},
           {
            RowBox[{"-", "0.1111111111111111`"}], "0.`", 
            "0.037037037037037035`"},
           {"0.`", "0.`", "0.375`"},
           {"0.`", "0.`", "0.175`"},
           {"0.`", 
            RowBox[{"-", "0.125`"}], "0.075`"},
           {"0.`", "0.`", 
            RowBox[{"-", "0.325`"}]},
           {"0.`", "0.`", 
            RowBox[{"-", "0.125`"}]},
           {"0.1388888888888889`", "0.`", 
            RowBox[{"-", "0.06296296296296296`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
      "}"}]}], ",", 
    RowBox[{"\<\"right\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"offsets\"\>", "\[Rule]", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.`", "0.`", "0.`"},
           {"0.`", "0.`", "0.`"},
           {
            RowBox[{"-", "0.25`"}], "0.`", "0.1`"},
           {"0.`", "0.`", "0.5`"},
           {"0.`", "0.`", "0.5`"},
           {"0.`", "0.25`", "0.`"},
           {"0.`", "0.`", 
            RowBox[{"-", "0.5`"}]},
           {"0.`", "0.`", 
            RowBox[{"-", "0.5`"}]},
           {"0.25`", "0.`", 
            RowBox[{"-", "0.1`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ",", 
       RowBox[{"\<\"comOffsets\"\>", "\[Rule]", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0.`", "0.`", "0.`"},
           {"0.`", "0.`", "0.`"},
           {
            RowBox[{"-", "0.1111111111111111`"}], "0.`", 
            "0.037037037037037035`"},
           {"0.`", "0.`", "0.375`"},
           {"0.`", "0.`", "0.175`"},
           {"0.`", "0.125`", "0.075`"},
           {"0.`", "0.`", 
            RowBox[{"-", "0.325`"}]},
           {"0.`", "0.`", 
            RowBox[{"-", "0.125`"}]},
           {"0.1388888888888889`", "0.`", 
            RowBox[{"-", "0.06296296296296296`"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}], 
      "}"}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB2KtsNkRW9e/cow4/bsdRK9+PW01iE6ZeO7NNiB90Zf9
D4i2efeWaTuQZoqO33wZSHt9agu/CqTZOXmO3QHS8/aX2D4G0rM0LcJBtEvv
zjlPgPSLKaGKL4B05moxTRBt8s84HUQnWMVbvAbSd76oizJteOUYxHVSE0T/
+WezcRmQrpjBpb8aSG/ZvdYcRE+45blJZ+MrRzUr7pc2QHryrG9rQoG0ptK2
FzFAet+fN8WxQPr/69w9CUBaoGyNUhuQthHk3f4bSLedsT3xF0hX79u9mmPT
K8ekfSca+YB019S9vAJA+pwqWy+I3sQzX1pn8ytHhwue1SD627QvgqZAetVR
u79mQLrvWsOqtjuvHAEZkq4a
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"YamlWriteFile", "[", 
  RowBox[{"svaModelx", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"builddir", ",", "\"\<sva.yaml\>\""}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.581338293191868*^9, 3.58133829971244*^9}, 
   3.5813387382419*^9, {3.581345452977366*^9, 3.5813454591941643`*^9}, {
   3.581886723092197*^9, 3.5818867237475367`*^9}, 3.581886778323097*^9, {
   3.582584612838849*^9, 3.5825846156547403`*^9}, {3.5825846645584373`*^9, 
   3.582584677774651*^9}}],

Cell[BoxData[
 FormBox["\<\"/home/rsinnet/Documents/MATLAB/kneefoot3d-sva-v33/build_old-\
model-2d-feet-amber-suite/sva.yaml\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{{3.582584667506558*^9, 3.5825846783568583`*^9}, 
   3.582635368034367*^9, 3.58265018218926*^9, 3.5826512958638783`*^9, 
   3.582658019917831*^9, 3.582734613860054*^9, 3.582975416901371*^9, 
   3.582979650399193*^9, 3.583001950346986*^9, 3.583013902754588*^9, 
   3.583017070365672*^9, 3.583018088686846*^9, 3.58359881324063*^9, 
   3.5835995786682*^9, 3.583617167894908*^9, 3.583621098351247*^9, 
   3.60528008418254*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion to MATLAB", "Section",
 CellChangeTimes->{{3.581336191555889*^9, 3.58133619185188*^9}, {
  3.5813381362911253`*^9, 3.581338136618453*^9}, {3.581888471061969*^9, 
  3.58188847818112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Run", "[", 
  RowBox[{"\"\<perl \>\"", "<>", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"utildir", ",", "\"\<math2mat.pl\>\""}], "}"}], "]"}], "<>", 
   "\"\< \>\"", "<>", "builddir", "<>", "\"\< \>\"", "<>", "builddir"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5784142663864326`*^9, 3.5784142862558084`*^9}, {
  3.578414345336445*^9, 3.5784143835117483`*^9}, {3.5784144350173807`*^9, 
  3.578414478379481*^9}, {3.5818872776770277`*^9, 3.5818872783161707`*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQA+JNUu+3bV3/ypFByKpyG5B+8iucbzuQ5lnaW7wTSCu9
3nLiMpD2EXe8dBVInxJzegKiS4wLX90B0sU3dxc9AdK2n76fBtElM/UiXgDp
yz7fU0H0xtyWaSB6zbK76a+BtEmoVCTThleO31SfOjMD6V9b3viAaC3p/nQQ
3bWf+RGIfvMug48FSKuWl3aA6JY5lx8uA9JmfOwZq0G018wzLBtfOZ4IeW8j
AqRtlD8amgFp5UnKBtZA2nO36NpQIK0zU2F/JJCW3TXxIYhW+XnlRQyQPrSI
qyQWSG840r0nAUgvEjul1AakJa9qbf8NpOOORp34C9KfeHM1x6ZXjq+DnzXy
AWkTj1u8AkC6w16lF0Qb/n5dobn5laOExCppHSD93TO8GkQnq/8TNAXStld9
/poB6dD97ava7rxyBAAKjMa1
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dl2", "=", 
  RowBox[{"DateString", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.4755248724793*^9, 3.4755248752560997`*^9}, 
   3.4755249570937*^9, {3.4918297990723767`*^9, 3.4918297998424206`*^9}, {
   3.5818794160543127`*^9, 3.581879417725977*^9}}],

Cell[BoxData[
 FormBox["\<\"Mon 31 Mar 2014 13:41:24\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{3.5817834794820833`*^9, 3.581786226885686*^9, 
  3.5818450616645813`*^9, 3.581863763545967*^9, 3.581877209351017*^9, 
  3.581879515118067*^9, 3.581879903754304*^9, 3.581887169571507*^9, 
  3.581887283960895*^9, 3.581887668143704*^9, 3.581893438936748*^9, 
  3.581940424832673*^9, 3.582277390632865*^9, 3.582286656227211*^9, 
  3.582469732800489*^9, 3.582501351557745*^9, 3.5825708955417433`*^9, 
  3.582581121145465*^9, 3.582635368744442*^9, 3.582650182749524*^9, 
  3.582651296401277*^9, 3.582658020497072*^9, 3.5827346144026737`*^9, 
  3.582975417450728*^9, 3.582979650922061*^9, 3.583001950873919*^9, 
  3.5830139032957163`*^9, 3.583017070827442*^9, 3.583018089346971*^9, 
  3.583593417520155*^9, 3.583598813358308*^9, 3.583599578781686*^9, 
  3.583617167982201*^9, 3.583621098444848*^9, 3.605280084246018*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Computation time:      \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"DateDifference", "[", 
       RowBox[{"dl1", ",", "dl2", ",", "\"\<Second\>\""}], "]"}], "//", 
      "First"}], "]"}], "<>", "\"\< seconds\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4939935436084003`*^9, 3.4939935487408*^9}, {
  3.4939935851823997`*^9, 3.4939936013128*^9}, {3.4939937276104*^9, 
  3.4939937459248*^9}, {3.581879432471252*^9, 3.5818795044558973`*^9}}],

Cell[BoxData[
 FormBox["\<\"Computation time:      25. seconds\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{
  3.5817834794984903`*^9, 3.581786226965754*^9, 3.581845061682312*^9, 
   3.581863763561206*^9, 3.581877209360776*^9, {3.581879443201701*^9, 
   3.581879473145699*^9}, 3.581879505059972*^9, 3.581879903820977*^9, 
   3.58188716966343*^9, 3.581887284805882*^9, 3.581887668194963*^9, 
   3.581893439032113*^9, 3.5819404248941*^9, 3.582277390863594*^9, 
   3.582286656300494*^9, 3.582469732854797*^9, 3.582501351676341*^9, 
   3.582570895602846*^9, 3.5825811212426243`*^9, 3.582635368778822*^9, 
   3.582650182793648*^9, 3.5826512964393473`*^9, 3.58265802056481*^9, 
   3.5827346144503527`*^9, 3.5829754175068693`*^9, 3.58297965097016*^9, 
   3.583001950920493*^9, 3.5830139033432417`*^9, 3.583017070856399*^9, 
   3.583018089416019*^9, 3.583593419453079*^9, 3.583598813479931*^9, 
   3.5835995788493156`*^9, 3.583617168020108*^9, 3.58362109850696*^9, 
   3.605280084377098*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion to CPP", "Section",
 CellChangeTimes->{{3.582501413540752*^9, 3.5825014154200287`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "getCFormNoPowers", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getCFormNoPowers", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "times", "}"}], ",", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"code", ",", 
         RowBox[{"Hold", "[", 
          RowBox[{"CForm", "[", "code", "]"}], "]"}], ",", "HoldAll"}], "]"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "[", "#", "]"}], "&"}], "[", 
         RowBox[{"expr", "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "^", "y_Integer"}], "/;", 
            RowBox[{"3", ">", "y", ">", "1"}]}], "\[RuleDelayed]", 
           RowBox[{"times", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", "y", "}"}]}], "]"}]}]}]}], "]"}], "/.", 
        RowBox[{"times", "\[Rule]", "Times"}]}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.582504033914756*^9, 3.582504033915965*^9}, {
  3.5825041479863663`*^9, 3.582504151514696*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Ccform", "=", 
    RowBox[{"String", "[", 
     RowBox[{"HoldForm", "@@", 
      RowBox[{"getCFormNoPowers", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", "C\[Alpha]\[Zeta]", "]"}], "/.", 
         "\[CapitalZeta]xsubs"}], "/.", "Cstatesubs"}], "]"}]}], "]"}]}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5825042174735193`*^9, 3.582504318052413*^9}, 
   3.582504790037189*^9, {3.582505180572933*^9, 3.582505203723278*^9}, {
   3.582505776259897*^9, 3.582505777884976*^9}, {3.582506246555941*^9, 
   3.582506250315259*^9}, 3.582506853773115*^9, {3.58250700433149*^9, 
   3.5825070055644903`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cstatesubs", "=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"#", "+", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
        RowBox[{"HoldForm", "@", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}]}], 
       "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], "-", "1"}], ")"}]}], ")"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"dQ", "\[LeftDoubleBracket]", 
         RowBox[{"#", "+", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
        RowBox[{"HoldForm", "@", 
         RowBox[{
         "dq", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}]}], 
       "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", "ne", "]"}], "-", "1"}], ")"}]}], ")"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"#", "+", "1"}], "]"}], "\[Rule]", 
        RowBox[{"HoldForm", "@", 
         RowBox[{
         "p", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}]}]}], 
       "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Range", "[", "np", "]"}], "-", "1"}], ")"}]}], ")"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.582503346609538*^9, 3.582503356593934*^9}, {
  3.582506582673208*^9, 3.582506588871344*^9}, {3.582506635983451*^9, 
  3.582506675754468*^9}, {3.582506717415374*^9, 3.5825068030982513`*^9}, {
  3.582506839464766*^9, 3.582506843931644*^9}, {3.582506884600952*^9, 
  3.582506931357576*^9}, {3.582506971524385*^9, 3.582506988716957*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "z"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "y"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"q", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "x"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "z"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "y"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "3"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "4"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "5"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "6"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"dq", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}],
      HoldForm]}], ",", 
    RowBox[{
     RowBox[{"p", "(", "1", ")"}], "\[Rule]", 
     TagBox[
      RowBox[{"p", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}],
      HoldForm]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.582506908785448*^9, 3.582506989267796*^9, 
  3.582507045016148*^9, 3.582549142744711*^9, 3.582570895705471*^9, 
  3.582581121440996*^9, 3.582635368827244*^9, 3.58265018286952*^9, 
  3.5826512964996433`*^9, 3.582658020693664*^9, 3.582734614517733*^9, 
  3.5829754175942907`*^9, 3.582979651032628*^9, 3.58300195099677*^9, 
  3.583013903417304*^9, 3.583017070937056*^9, 3.583018089508443*^9, 
  3.583593433758246*^9, 3.58359881354023*^9, 3.583599578903304*^9, 
  3.583617168090888*^9, 3.5836210985906982`*^9, 3.60528008442528*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToCForm", "[", 
    RowBox[{"expr_", "?", "MatrixQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"(", 
       RowBox[{"expr", "\[Transpose]"}], ")"}]}], "/.", 
     "\[CapitalZeta]xsubs"}], "/.", "Cstatesubs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToCForm", "[", 
    RowBox[{
     RowBox[{"expr_", "?", "VectorQ"}], "[", "expr", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"expr", "/.", "\[CapitalZeta]xsubs"}], "/.", "Cstatesubs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToCForm", "[", 
    RowBox[{"expr_", "/;", 
     RowBox[{"!", 
      RowBox[{"ListQ", "[", "expr", "]"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "@", "expr"}], "/.", "\[CapitalZeta]xsubs"}], "/.", 
    "Cstatesubs"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5826361401775303`*^9, 3.58263625739771*^9}, {
  3.582644030961295*^9, 3.582644049044187*^9}, {3.582644299546834*^9, 
  3.582644345737033*^9}, {3.582644394556511*^9, 3.582644446242248*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DDf\[Chi]z", "=", 
   RowBox[{"ParallelSimplify", "[", 
    RowBox[{"DDf\[Chi]", "/.", "\[VeryThinSpace]", "\[CapitalZeta]subs"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"WriteExpr\[Zeta]", "[", 
     RowBox[{"DDf\[Chi]z", ",", "\"\<DM1Dqzmat\>\""}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.582577978294264*^9, 3.5825779813611937`*^9}, {
  3.5825780377701597`*^9, 3.5825780456633472`*^9}, {3.58257808572458*^9, 
  3.582578090378519*^9}, {3.582578155090541*^9, 3.582578155252556*^9}, {
  3.58263776666199*^9, 3.58263776781371*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotposcform", "=", 
   RowBox[{"ToCForm", "@", "pp\[Zeta]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hnshcform", "=", 
   RowBox[{"ToCForm", "@", 
    RowBox[{
    "pnsh", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hnstcform", "=", 
   RowBox[{"ToCForm", "@", 
    RowBox[{
    "pnst", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.582506277363909*^9, 3.5825063225067043`*^9}, {
   3.5825504858840933`*^9, 3.582550486636097*^9}, {3.582571743143894*^9, 
   3.582571794891954*^9}, {3.582576938256514*^9, 3.582576947847825*^9}, {
   3.582577710699791*^9, 3.5825777291727324`*^9}, 3.5825781400124693`*^9, {
   3.5826360981341543`*^9, 3.582636128908916*^9}, {3.58263626128876*^9, 
   3.582636309278132*^9}, {3.582638288885421*^9, 3.582638305588826*^9}, {
   3.582638364069326*^9, 3.582638365876666*^9}, 3.583593463323001*^9, {
   3.5836171035765533`*^9, 3.583617109761484*^9}}],

Cell[CellGroupData[{

Cell["Splice code into templates", "Subsubsection",
 CellChangeTimes->{{3.582580871142709*^9, 3.5825808830959*^9}, {
  3.58263629073038*^9, 3.582636292449855*^9}, {3.582638367722682*^9, 
  3.582638368553895*^9}, {3.5826444507109537`*^9, 3.5826444513311234`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeCpp", "[", 
   RowBox[{"file_", "?", "StringQ"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Splice", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"nbdir", ",", "\"\<templates\>\"", ",", 
       RowBox[{"file", "<>", "\"\<.mcc\>\""}]}], "}"}], "]"}], ",", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"builddir", ",", 
       RowBox[{"file", "<>", "\"\<.cc\>\""}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.582502071525703*^9, 3.5825022559041157`*^9}, {
  3.582504337368081*^9, 3.5825043401301727`*^9}, {3.582504435812789*^9, 
  3.582504440203767*^9}, {3.582504492104746*^9, 3.582504495047187*^9}, {
  3.582504558304215*^9, 3.58250457077142*^9}, {3.58250461008771*^9, 
  3.5825046837124453`*^9}, {3.5825047228338537`*^9, 3.58250473789124*^9}, {
  3.5825049105508823`*^9, 3.5825049145349216`*^9}, {3.582505062448083*^9, 
  3.582505064254909*^9}, {3.582580892923773*^9, 3.5825808965797253`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeCpp", "[", "\"\<PlotPositions\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCpp", "[", "\"\<HeightNSH\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCpp", "[", "\"\<HeightNST\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.58250228034234*^9, 3.582502289000864*^9}, {
   3.582504331369946*^9, 3.5825043506578293`*^9}, {3.582504419593961*^9, 
   3.582504422882181*^9}, {3.582504576481723*^9, 3.582504578665797*^9}, 
   3.582504612857627*^9, 3.58250473905075*^9, 3.582505067017449*^9, 
   3.5825511527142477`*^9, {3.582577736064673*^9, 3.582577755632062*^9}, 
   3.582577789658887*^9, {3.582635775860198*^9, 3.582635784895784*^9}, 
   3.582636335828827*^9, {3.582638318599072*^9, 3.582638323608665*^9}, {
   3.583593469185568*^9, 3.583593471682704*^9}, {3.583617094788639*^9, 
   3.583617097534316*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{6, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
ShowSelection->True,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 657, 10, 83, "Title"],
Cell[1227, 34, 261, 5, 72, "Section",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[1513, 43, 398, 8, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[1914, 53, 2213, 32, 31, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[4130, 87, 448, 8, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[4581, 97, 2225, 33, 31, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[6809, 132, 886, 23, 69, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[7698, 157, 773, 15, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[8474, 174, 3477, 54, 92, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[11954, 230, 401, 7, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[12358, 239, 936, 16, 50, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Open  ]],
Cell[13309, 258, 130, 2, 24, "Print"],
Cell[CellGroupData[{
Cell[13464, 264, 924, 18, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[14391, 284, 2268, 33, 31, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[16662, 319, 911, 17, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[17576, 338, 221, 5, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[17800, 345, 241, 6, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[18044, 353, 16317, 263, 587, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Open  ]],
Cell[34376, 619, 1738, 47, 51, "Output"],
Cell[CellGroupData[{
Cell[36139, 670, 513, 12, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[36655, 684, 704, 10, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[37362, 696, 1225, 31, 88, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[38590, 729, 2297, 44, 88, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[40890, 775, 2522, 46, 33, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[43415, 823, 501, 12, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[43919, 837, 815, 21, 88, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[44737, 860, 326, 5, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[45066, 867, 407, 8, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[45476, 877, 1236, 29, 69, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[46715, 908, 11464, 171, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[58182, 1081, 5137, 124, 57, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[63322, 1207, 965, 18, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[64290, 1227, 601, 9, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[64894, 1238, 783, 17, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[65680, 1257, 1685, 40, 69, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[67368, 1299, 1404, 36, 69, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[68775, 1337, 545, 12, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[69323, 1351, 562, 15, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[69888, 1368, 365, 6, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[70256, 1376, 1304, 29, 126, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[71563, 1407, 969, 19, 30, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[72535, 1428, 616, 14, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[73154, 1444, 274, 4, 37, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[73431, 1450, 251, 4, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[73685, 1456, 795, 20, 69, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[74483, 1478, 256, 4, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[74742, 1484, 1723, 39, 50, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[76468, 1525, 363, 6, 28, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[76834, 1533, 1603, 38, 50, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[78474, 1576, 156, 2, 72, "Section"],
Cell[78633, 1580, 232, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[78890, 1588, 1127, 31, 69, "Input"],
Cell[80020, 1621, 1497, 24, 31, "Output"]
}, Open  ]],
Cell[81532, 1648, 1945, 39, 183, "Input"],
Cell[83480, 1689, 244, 3, 30, "Text"],
Cell[83727, 1694, 1163, 17, 30, "Input"],
Cell[84893, 1713, 2160, 48, 233, "Input"],
Cell[CellGroupData[{
Cell[87078, 1765, 1404, 29, 88, "Input"],
Cell[88485, 1796, 2662, 68, 212, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[91196, 1870, 265, 4, 72, "Section"],
Cell[CellGroupData[{
Cell[91486, 1878, 100, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[91611, 1883, 106, 1, 28, "Subsubsection"],
Cell[91720, 1886, 1902, 29, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93659, 1920, 320, 4, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[94004, 1928, 339, 10, 30, "Input"],
Cell[94346, 1940, 1848, 35, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96243, 1981, 263, 3, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[96531, 1988, 586, 16, 30, "Input"],
Cell[97120, 2006, 2475, 59, 180, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99644, 2071, 327, 4, 28, "Subsubsection"],
Cell[99974, 2077, 494, 12, 30, "Input"],
Cell[100471, 2091, 1724, 41, 88, "Input"],
Cell[102198, 2134, 565, 13, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102800, 2152, 228, 5, 28, "Subsubsection"],
Cell[103031, 2159, 707, 17, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103787, 2182, 96, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[103908, 2187, 183, 2, 28, "Subsubsection"],
Cell[104094, 2191, 243, 5, 30, "Input"],
Cell[104340, 2198, 1280, 36, 30, "Input"],
Cell[105623, 2236, 1534, 36, 69, "Input"],
Cell[107160, 2274, 485, 11, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107682, 2290, 438, 6, 28, "Subsubsection"],
Cell[108123, 2298, 530, 14, 32, "Input"],
Cell[108656, 2314, 230, 6, 30, "Input"],
Cell[108889, 2322, 501, 12, 54, "Input"],
Cell[109393, 2336, 659, 15, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110089, 2356, 268, 3, 28, "Subsubsection"],
Cell[110360, 2361, 788, 15, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111185, 2381, 390, 7, 28, "Subsubsection"],
Cell[111578, 2390, 694, 19, 50, "Input"],
Cell[112275, 2411, 625, 16, 50, "Input"],
Cell[112903, 2429, 692, 16, 50, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113632, 2450, 160, 2, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[113817, 2456, 228, 4, 30, "Input"],
Cell[114048, 2462, 2491, 64, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116576, 2531, 620, 16, 30, "Input"],
Cell[117199, 2549, 3113, 83, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120349, 2637, 886, 22, 50, "Input"],
Cell[121238, 2661, 4068, 112, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125343, 2778, 228, 7, 30, "Input"],
Cell[125574, 2787, 2090, 61, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127701, 2853, 746, 16, 88, "Input"],
Cell[128450, 2871, 2462, 72, 34, "Output"]
}, Open  ]],
Cell[130927, 2946, 334, 10, 54, "Input"],
Cell[131264, 2958, 244, 7, 30, "Input"],
Cell[131511, 2967, 632, 11, 30, "Input"],
Cell[CellGroupData[{
Cell[132168, 2982, 617, 16, 30, "Input"],
Cell[132788, 3000, 930, 23, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133755, 3028, 541, 15, 30, "Input"],
Cell[134299, 3045, 1735, 34, 114, "Output"]
}, Open  ]],
Cell[136049, 3082, 282, 9, 30, "Input"],
Cell[CellGroupData[{
Cell[136356, 3095, 488, 13, 30, "Input"],
Cell[136847, 3110, 1649, 35, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138533, 3150, 153, 3, 30, "Input"],
Cell[138689, 3155, 2468, 64, 33, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[141230, 3227, 217, 3, 72, "Section"],
Cell[141450, 3232, 284, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[141759, 3241, 174, 2, 28, "Subsubsection"],
Cell[141936, 3245, 2846, 69, 355, "Input"],
Cell[144785, 3316, 572, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[145382, 3330, 2253, 39, 88, "Input"],
Cell[147638, 3371, 1725, 32, 48, "Output"]
}, Open  ]],
Cell[149378, 3406, 538, 12, 30, "Input"],
Cell[149919, 3420, 546, 13, 30, "Input"],
Cell[150468, 3435, 545, 16, 30, "Input"],
Cell[151016, 3453, 833, 17, 30, "Input"],
Cell[151852, 3472, 976, 21, 30, "Input"],
Cell[152831, 3495, 581, 12, 30, "Input"],
Cell[153415, 3509, 364, 9, 30, "Input"],
Cell[153782, 3520, 321, 8, 30, "Input"],
Cell[154106, 3530, 871, 19, 30, "Input"],
Cell[CellGroupData[{
Cell[155002, 3553, 289, 6, 30, "Input"],
Cell[155294, 3561, 1877, 43, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157208, 3609, 500, 13, 30, "Input"],
Cell[157711, 3624, 1352, 29, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159100, 3658, 154, 3, 30, "Input"],
Cell[159257, 3663, 448, 12, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159742, 3680, 866, 18, 30, "Input"],
Cell[160611, 3700, 671, 14, 24, "Message"],
Cell[161285, 3716, 1824, 38, 46, "Output"]
}, Open  ]],
Cell[163124, 3757, 936, 20, 69, "Input"],
Cell[164063, 3779, 555, 11, 50, "Input"],
Cell[164621, 3792, 1116, 26, 88, "Input"],
Cell[165740, 3820, 771, 16, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166548, 3841, 296, 6, 37, "Subsection"],
Cell[166847, 3849, 260, 7, 30, "Input"],
Cell[CellGroupData[{
Cell[167132, 3860, 718, 16, 30, "Input"],
Cell[167853, 3878, 1364, 31, 49, "Output"]
}, Open  ]],
Cell[169232, 3912, 236, 5, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169505, 3922, 103, 1, 37, "Subsection"],
Cell[169611, 3925, 545, 11, 69, "Input"],
Cell[170159, 3938, 1498, 28, 50, "Input"],
Cell[171660, 3968, 671, 15, 50, "Input"],
Cell[CellGroupData[{
Cell[172356, 3987, 336, 7, 30, "Input"],
Cell[172695, 3996, 519, 8, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[173263, 4010, 110, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[173398, 4015, 192, 4, 28, "Subsubsection"],
Cell[173593, 4021, 607, 13, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174237, 4039, 123, 1, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[174385, 4044, 391, 11, 32, "Input"],
Cell[174779, 4057, 738, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175554, 4075, 337, 9, 34, "Input"],
Cell[175894, 4086, 2689, 49, 239, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178656, 4143, 145, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[178826, 4149, 1127, 19, 30, "Input"],
Cell[179956, 4170, 739, 17, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180732, 4192, 778, 21, 50, "Input"],
Cell[181513, 4215, 1541, 47, 243, "Output"],
Cell[183057, 4264, 1573, 48, 243, "Output"]
}, Open  ]],
Cell[184645, 4315, 1205, 24, 145, "Input"],
Cell[CellGroupData[{
Cell[185875, 4343, 950, 20, 126, "Input"],
Cell[186828, 4365, 1374, 28, 82, "Output"]
}, Open  ]],
Cell[188217, 4396, 352, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[188594, 4410, 1302, 29, 30, "Input"],
Cell[189899, 4441, 2147, 49, 31, "Output"]
}, Open  ]],
Cell[192061, 4493, 1351, 32, 145, "Input"],
Cell[193415, 4527, 1199, 30, 145, "Input"],
Cell[CellGroupData[{
Cell[194639, 4561, 1899, 36, 259, "Input"],
Cell[196541, 4599, 20077, 463, 476, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216655, 5067, 486, 10, 30, "Input"],
Cell[217144, 5079, 660, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217841, 5097, 109, 1, 37, "Subsection"],
Cell[217953, 5100, 956, 25, 50, "Input"],
Cell[CellGroupData[{
Cell[218934, 5129, 1332, 25, 164, "Input"],
Cell[220269, 5156, 5813, 149, 214, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226119, 5310, 528, 11, 30, "Input"],
Cell[226650, 5323, 600, 9, 31, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[227311, 5339, 203, 3, 72, "Section"],
Cell[CellGroupData[{
Cell[227539, 5346, 510, 10, 30, "Input"],
Cell[228052, 5358, 551, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228640, 5374, 275, 5, 30, "Input"],
Cell[228918, 5381, 920, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229875, 5399, 540, 11, 30, "Input"],
Cell[230418, 5412, 994, 16, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[231461, 5434, 104, 1, 72, "Section"],
Cell[231568, 5437, 1161, 32, 50, "Input"],
Cell[232732, 5471, 683, 16, 30, "Input"],
Cell[CellGroupData[{
Cell[233440, 5491, 1847, 50, 107, "Input"],
Cell[235290, 5543, 5008, 142, 57, "Output"]
}, Open  ]],
Cell[240313, 5688, 1103, 32, 69, "Input"],
Cell[241419, 5722, 644, 15, 50, "Input"],
Cell[242066, 5739, 1053, 23, 69, "Input"],
Cell[CellGroupData[{
Cell[243144, 5766, 262, 3, 28, "Subsubsection"],
Cell[243409, 5771, 1021, 21, 50, "Input"],
Cell[244433, 5794, 896, 17, 69, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
