(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    180767,       4361]
NotebookOptionsPosition[    175528,       4190]
NotebookOutlinePosition[    176030,       4210]
CellTagsIndexPosition[    175987,       4207]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Old Point-Foot, 2D Simulation Model", "Title",
 CellChangeTimes->{{3.4404350275828004`*^9, 3.4404350344780006`*^9}, {
   3.4419833227303467`*^9, 3.4419833238067465`*^9}, {3.4420861759203467`*^9, 
   3.4420861767471466`*^9}, 3.4424113254077573`*^9, {3.4891631024901485`*^9, 
   3.489163105828339*^9}, {3.578417641978129*^9, 3.5784176513447905`*^9}, {
   3.5787422951875677`*^9, 3.57874229742337*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.4404350142604003`*^9, 3.4404350171308002`*^9}, 
   3.4424113254077573`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dl1", "=", 
  RowBox[{"DateString", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.4831815714484*^9, 3.48318159081*^9}, {
  3.581888323635229*^9, 3.581888325721225*^9}}],

Cell[BoxData[
 FormBox["\<\"Tue 23 Jul 2013 11:06:23\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.578395165097934*^9, 3.5784097921387177`*^9, 3.578412854358611*^9, 
   3.57841308350252*^9, 3.578414019531145*^9, 3.578414522415204*^9, 
   3.5784146544893446`*^9, 3.5784149007280626`*^9, {3.5784150273371487`*^9, 
   3.57841505722679*^9}, 3.578415306803595*^9, {3.578415347685402*^9, 
   3.578415359640457*^9}, 3.578417658125061*^9, 3.5784177042597256`*^9, 
   3.578418117796158*^9, 3.5784200507387133`*^9, 3.5786851963223734`*^9, {
   3.578685242845397*^9, 3.5786852565440655`*^9}, 3.578685313842054*^9, 
   3.5786853678129654`*^9, 3.5786854030215254`*^9, 3.5786894769800606`*^9, {
   3.5786895898264184`*^9, 3.578689605690089*^9}, 3.578742308094146*^9, 
   3.578742428052702*^9, 3.5787427407015667`*^9, 3.578743807668412*^9, 
   3.57882490217719*^9, 3.5788251847712297`*^9, 3.578828829578821*^9, 
   3.578833659750313*^9, 3.57883374042188*^9, 3.5788338230381107`*^9, 
   3.5788341865420027`*^9, 3.578834635783862*^9, 3.578834752679442*^9, {
   3.578835074626801*^9, 3.578835089065366*^9}, 3.578835160074567*^9, 
   3.578835247177826*^9, 3.578835356770422*^9, 3.579553607377276*^9, 
   3.57955381398841*^9, 3.5795538724645057`*^9, 3.5795539879273195`*^9, 
   3.579554990674952*^9, 3.5795709876115723`*^9, 3.579571198619774*^9, 
   3.579572051722972*^9, 3.579573600057322*^9, 3.5796032120415993`*^9, 
   3.5796183391755514`*^9, 3.579624166015473*^9, 3.5798116854453516`*^9, 
   3.579823902941422*^9, 3.579824707508981*^9, 3.5798252797248073`*^9, 
   3.579993941035266*^9, 3.5799993274032497`*^9, 3.581014040299794*^9, {
   3.581888533661785*^9, 3.581888561025895*^9}, 3.581890521686553*^9, 
   3.583584383113659*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nbdir", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.4918480983167477`*^9, 3.4918481000267496`*^9}, 
   3.4923395121731296`*^9, {3.5782300318375397`*^9, 3.5782300330177307`*^9}, {
   3.578418119964163*^9, 3.5784181246745186`*^9}}],

Cell[BoxData[
 FormBox["\<\"/share/rsinnet/reduction/kneefoot3d-sva-v25-x/\"\>", 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.578395165151984*^9, 3.578409792220793*^9, 3.578412854413662*^9, 
   3.57841308354556*^9, 3.578414019570182*^9, 3.5784145224662514`*^9, 
   3.578414654536388*^9, 3.57841490074708*^9, {3.578415027356166*^9, 
   3.5784150572718315`*^9}, 3.5784153068456335`*^9, {3.57841534770542*^9, 
   3.5784153596704855`*^9}, 3.578417661149858*^9, 3.5784177047882147`*^9, 
   3.57841812520601*^9, 3.578420050793764*^9, 3.578685196697721*^9, {
   3.5786852428764257`*^9, 3.578685256580099*^9}, 3.5786853138580685`*^9, 
   3.57868536783899*^9, 3.5786854030485516`*^9, 3.5786894770030813`*^9, {
   3.578689589869458*^9, 3.5786896057131104`*^9}, 3.578742428493176*^9, 
   3.5787427407558813`*^9, 3.578743807762926*^9, 3.578824902258061*^9, 
   3.578825185083055*^9, 3.578828829644526*^9, 3.5788336598460207`*^9, 
   3.5788337405133266`*^9, 3.578833823116495*^9, 3.578834186631075*^9, 
   3.578834635901943*^9, 3.578834752943307*^9, {3.5788350746810637`*^9, 
   3.5788350891333427`*^9}, 3.5788351601379004`*^9, 3.578835247241252*^9, 
   3.578835356854604*^9, 3.5795536073982954`*^9, 3.579553730142845*^9, 
   3.5795538140104303`*^9, 3.579553872487527*^9, 3.57955398793933*^9, 
   3.579554990699975*^9, 3.579570988909773*^9, 3.5795711986618137`*^9, 
   3.579572051772018*^9, 3.5795736002284803`*^9, 3.5796032120706263`*^9, 
   3.5796183392115836`*^9, 3.579624166074559*^9, 3.5798116854893928`*^9, 
   3.579823902985463*^9, 3.579824707560029*^9, 3.5798252797728515`*^9, 
   3.579993941116341*^9, 3.5799993274472904`*^9, 3.5810140403290377`*^9, {
   3.5818885336896*^9, 3.5818885610729237`*^9}, 3.581890521845347*^9, 
   3.5835843832126493`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"builddir", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"nbdir", ",", "\"\<build-old-2d-feet\>\""}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.578230037447628*^9, 3.5782300930886917`*^9}, {
   3.578230136960682*^9, 3.5782301508327503`*^9}, {3.578323384951927*^9, 
   3.578323385144105*^9}, {3.5784176645299835`*^9, 3.5784176875953145`*^9}, 
   3.578418128859389*^9, {3.578742301842122*^9, 3.578742303664324*^9}, {
   3.579572045838529*^9, 3.5795720466943207`*^9}}],

Cell[BoxData[
 FormBox["\<\"/share/rsinnet/reduction/kneefoot3d-sva-v25-x/build-old-2d-feet\
\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5784181291056166`*^9, 3.578420050823792*^9, 3.5786851971101017`*^9, {
   3.5786852429074545`*^9, 3.57868525661413*^9}, 3.5786853138740835`*^9, 
   3.5786853678850327`*^9, 3.578685403094594*^9, 3.5786894770251017`*^9, {
   3.5786895898914785`*^9, 3.578689605757151*^9}, 3.578742428667037*^9, 
   3.578742740790492*^9, 3.578743807877203*^9, 3.57882490237156*^9, 
   3.5788251852619963`*^9, 3.578828829700506*^9, 3.578833659971946*^9, 
   3.5788337405949383`*^9, 3.578833823286224*^9, 3.578834186736597*^9, 
   3.5788346361120358`*^9, 3.5788347530504417`*^9, {3.578835074692973*^9, 
   3.578835089294916*^9}, 3.5788351601844587`*^9, 3.5788352472891073`*^9, 
   3.5788353569461327`*^9, 3.57955360741431*^9, 3.57955381403145*^9, 
   3.579553872509547*^9, 3.5795539879483385`*^9, 3.5795549907249985`*^9, 
   3.579570989157002*^9, 3.5795711987138615`*^9, 3.5795720518230653`*^9, 
   3.5795736002505007`*^9, 3.5796032120786333`*^9, 3.579618339227599*^9, 
   3.579624166126607*^9, 3.5798116855054073`*^9, 3.5798239030024796`*^9, 
   3.5798247075770445`*^9, 3.5798252797898684`*^9, 3.5799939411393633`*^9, 
   3.579999327466308*^9, 3.581014040475369*^9, {3.581888533720315*^9, 
   3.581888561115321*^9}, 3.581890521889069*^9, 3.5835843832532*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"utildir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"nbdir", ",", "\"\<util\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"screwsdir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"nbdir", ",", "\"\<third\>\"", ",", "\"\<Screws\>\""}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.581888351265629*^9, 3.5818883516432247`*^9}, {
  3.5818884266828413`*^9, 3.581888440990039*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Path", " ", "=", " ", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"$Path", ",", 
     RowBox[{"{", 
      RowBox[{"utildir", ",", "screwsdir"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.581888365347361*^9, {3.581888555609352*^9, 3.581888556473728*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"/usr/local/Wolfram/Mathematica/8.0/SystemFiles/Links\"\>", 
    ",", "\<\"/home/amberadmin/.Mathematica/Kernel\"\>", 
    ",", "\<\"/home/amberadmin/.Mathematica/Autoload\"\>", 
    ",", "\<\"/home/amberadmin/.Mathematica/Applications\"\>", 
    ",", "\<\"/usr/share/Mathematica/Kernel\"\>", 
    ",", "\<\"/usr/share/Mathematica/Autoload\"\>", 
    ",", "\<\"/usr/share/Mathematica/Applications\"\>", ",", "\<\".\"\>", 
    ",", "\<\"/home/amberadmin\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/Packages\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/LegacyPackages\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/SystemFiles/Autoload\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/Autoload\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/Applications\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/AddOns/ExtraPackages\"\>", 
    ",", "\<\"/usr/local/Wolfram/Mathematica/8.0/SystemFiles/Kernel/Packages\"\
\>", ",", \
"\<\"/usr/local/Wolfram/Mathematica/8.0/Documentation/English/System\"\>", 
    ",", "\<\"/share/rsinnet/reduction/kneefoot3d-sva-v25-x/util\"\>", 
    ",", "\<\"/share/rsinnet/reduction/kneefoot3d-sva-v25-x/third/Screws\"\>"}\
], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.581888533767281*^9, 3.581888561175323*^9}, 
   3.5818905219010353`*^9, 3.583584383261726*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<RobotLinks`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.4318808284558*^9, 3.4318808288146*^9}, {
   3.4318982003682003`*^9, 3.4318982006022*^9}, {3.4318997009954*^9, 
   3.431899728701*^9}, {3.4318998612718*^9, 3.4318998753118*^9}, {
   3.4319128101837997`*^9, 3.4319128106518*^9}, {3.432421752743364*^9, 
   3.432421754740164*^9}, {3.432548929994*^9, 3.4325489344868*^9}, {
   3.4329945466292*^9, 3.432994547222*^9}, 3.4424113254077573`*^9, {
   3.4856123824268274`*^9, 3.4856123825788364`*^9}, {3.4911385679710393`*^9, 
   3.4911385689290943`*^9}, {3.4911392339581313`*^9, 
   3.4911392343281527`*^9}, {3.5782301001352367`*^9, 3.578230120632717*^9}, {
   3.5783233828349705`*^9, 3.5783233833914847`*^9}, {3.581888370642158*^9, 
   3.5818883822333937`*^9}, {3.581888539794578*^9, 3.581888539953858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "builddir", "]"}], ",", ",", 
    RowBox[{"CreateDirectory", "[", "builddir", "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4318808284558*^9, 3.4318808288146*^9}, {
   3.4318982003682003`*^9, 3.4318982006022*^9}, {3.4318997009954*^9, 
   3.431899728701*^9}, {3.4318998612718*^9, 3.4318998753118*^9}, {
   3.4319128101837997`*^9, 3.4319128106518*^9}, 3.454242597217705*^9, 
   3.4554579110104094`*^9, {3.4832079699653997`*^9, 3.4832079712623997`*^9}, {
   3.4918313821329226`*^9, 3.4918313843370485`*^9}, {3.5782301283444767`*^9, 
   3.5782301577542753`*^9}, {3.578417713537305*^9, 3.5784177416903405`*^9}, {
   3.5784181362512255`*^9, 3.578418143507936*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"constsubs", "=", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Lft", "\[Rule]", 
      FractionBox["1", "4"]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"foot", " ", "ankle"}], "\[Dash]", 
       RowBox[{"toe", " ", "length"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Lfh", "\[Rule]", 
      FractionBox[
       RowBox[{"1", " ", "1"}], 
       RowBox[{"4", " ", "4"}]]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"foot", " ", "ankle"}], "\[Dash]", 
       RowBox[{"heel", " ", "length"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ha", "\[Rule]", 
      FractionBox[
       RowBox[{"1", " ", "1"}], 
       RowBox[{"5", " ", "2"}]]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"height", " ", "of", " ", "ankle"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Lc", "\[Rule]", "0.50"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"calf", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Lt", "\[Rule]", "0.50"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"thigh", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rfx", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "1"}], 
        RowBox[{"3", " ", "6"}]]}]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"foot", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rfz", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", "1", " ", "1"}], 
       RowBox[{"3", " ", "3", " ", "6"}]]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"foot", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rcx", "\[Rule]", "0"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"calf", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rcz", "\[Rule]", "0.375"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"calf", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rtx", "\[Rule]", "0"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"thigh", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rtz", "\[Rule]", "0.175"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"thigh", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rTx", "\[Rule]", "0"}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"torso", " ", "CoM", " ", "x"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rTz", "\[Rule]", "0.05"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"torso", " ", "CoM", " ", "z"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mf", "\[Rule]", ".1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"mc", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"mt", "\[Rule]", "5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"mT", "\[Rule]", "20"}], ",", "\[IndentingNewLine]", 
     RowBox[{"g", "\[Rule]", "9.81"}]}], "\[IndentingNewLine]", "}"}], "//", 
   "Rationalize"}]}]], "Input",
 CellChangeTimes->{{3.4349049195298*^9, 3.4349049437878*^9}, {
   3.4349993545274*^9, 3.4349993797214003`*^9}, {3.435000560398*^9, 
   3.4350005632528*^9}, {3.4350707572384*^9, 3.4350707618248*^9}, {
   3.4350772253014*^9, 3.4350772254262*^9}, {3.435078153829*^9, 
   3.4350782220322*^9}, {3.4350782615002003`*^9, 3.435078291811*^9}, 
   3.4350790937412*^9, {3.4350808724442*^9, 3.4350808770618*^9}, {
   3.4350815963042*^9, 3.4350815983789997`*^9}, {3.43508206077*^9, 
   3.4350820940136003`*^9}, {3.4350823303828*^9, 3.4350823363887997`*^9}, {
   3.435082521709*^9, 3.435082526545*^9}, {3.4353196505144*^9, 
   3.4353196948028*^9}, {3.435319873376*^9, 3.435319887572*^9}, {
   3.4353208165694*^9, 3.4353208194554*^9}, 3.4353210966127996`*^9, {
   3.4353212670866003`*^9, 3.4353212719694*^9}, {3.4353221386418*^9, 
   3.4353221496865997`*^9}, {3.4353223965699997`*^9, 3.4353223966792*^9}, {
   3.4353226242363997`*^9, 3.4353226261084003`*^9}, 3.4353235871907997`*^9, {
   3.4353368037764*^9, 3.4353368071616*^9}, {3.4353408653612003`*^9, 
   3.4353408717572002`*^9}, {3.4402457169728003`*^9, 
   3.4402457170039997`*^9}, {3.4402460597356*^9, 3.4402460624344*^9}, {
   3.440246662159*^9, 3.4402466701774*^9}, {3.4402712213442*^9, 
   3.4402712531052*^9}, {3.4402718403542*^9, 3.4402718491412*^9}, {
   3.4403487309802*^9, 3.4403487681082*^9}, {3.4403558159737997`*^9, 
   3.4403558578733997`*^9}, {3.4404236020412006`*^9, 
   3.4404236097008004`*^9}, {3.4404259997788005`*^9, 
   3.4404260399010005`*^9}, {3.4404385449296007`*^9, 
   3.4404385890630007`*^9}, {3.4404386440508003`*^9, 3.4404386584964004`*^9}, 
   3.4404395871088004`*^9, {3.440512097489174*^9, 3.4405121122935734`*^9}, 
   3.4406969117755737`*^9, {3.440705955990574*^9, 3.440705977159774*^9}, {
   3.440706170350174*^9, 3.4407061722065735`*^9}, {3.4407063815585737`*^9, 
   3.4407063820889735`*^9}, {3.4407067030823736`*^9, 
   3.4407067030823736`*^9}, {3.4407067839059734`*^9, 
   3.4407067883675737`*^9}, {3.4407068923727736`*^9, 3.4407068946347733`*^9}, 
   3.440768144048174*^9, {3.4407685888667736`*^9, 3.4407685998491735`*^9}, {
   3.4407690714937735`*^9, 3.440769106734174*^9}, 3.440780711814364*^9, {
   3.4409368493343477`*^9, 3.4409368579143476`*^9}, 3.440937052120748*^9, 
   3.4409512258825846`*^9, {3.440956158778185*^9, 3.440956158856185*^9}, {
   3.440956558182585*^9, 3.440956558712985*^9}, {3.440958204138585*^9, 
   3.4409582151365848`*^9}, {3.4409594130609846`*^9, 3.4409594175069847`*^9}, 
   3.441022061446353*^9, {3.4410228332095532`*^9, 3.4410228364699535`*^9}, {
   3.4410230877683535`*^9, 3.441023092479553*^9}, 3.441023136414753*^9, 
   3.441023168408553*^9, 3.441023627056353*^9, {3.441023820573553*^9, 
   3.441023834084153*^9}, 3.4410368933567533`*^9, 3.4410370482313533`*^9, {
   3.441038713002353*^9, 3.4410387191955533`*^9}, {3.441039431232353*^9, 
   3.4410394353819532`*^9}, {3.441136957010053*^9, 3.441136962251653*^9}, {
   3.4411372581532536`*^9, 3.441137262115653*^9}, {3.4415512244094*^9, 
   3.4415512464678*^9}, {3.4415516053494*^9, 3.4415516054742002`*^9}, {
   3.441998499572547*^9, 3.4419985050637465`*^9}, {3.442062672618947*^9, 
   3.4420626763005466`*^9}, {3.442065799594947*^9, 3.442065800920947*^9}, 
   3.442411325423357*^9, {3.455459616851609*^9, 3.455459620720409*^9}, {
   3.455632439318109*^9, 3.4556325240729094`*^9}, {3.4564869824795*^9, 
   3.4564870056455*^9}, {3.4564877199238997`*^9, 3.4564877233403*^9}, {
   3.457703557511973*^9, 3.457703557792773*^9}, 3.4577037077459726`*^9, {
   3.4831100776988*^9, 3.4831100778236*^9}, {3.4831102065236*^9, 
   3.4831102068512*^9}, {3.4831246610252*^9, 3.4831246622108*^9}, 
   3.4831885579214*^9, {3.4831888486552*^9, 3.4831888502464*^9}, {
   3.4831888982164*^9, 3.4831889029588003`*^9}, {3.4831892709578*^9, 
   3.4831892750762*^9}, {3.4831894285824003`*^9, 3.4831894537296*^9}, {
   3.4831954980938*^9, 3.4831955030702*^9}, {3.4831957806684*^9, 
   3.4831957809024*^9}, {3.4831959049547997`*^9, 3.4831959094632*^9}, {
   3.4831959744332*^9, 3.4831959822799997`*^9}, {3.4831961390518*^9, 
   3.4831961447302*^9}, {3.4831962051949997`*^9, 3.4831962100934*^9}, {
   3.4831963744941998`*^9, 3.4831963788154*^9}, {3.4831965001776*^9, 
   3.48319650024*^9}, {3.4831966132066*^9, 3.4831966175278*^9}, 
   3.4831967075312*^9, {3.4832268151275997`*^9, 3.4832268215704*^9}, {
   3.4832268967478*^9, 3.4832269037834*^9}, {3.4832269452304*^9, 
   3.4832269828398*^9}, {3.48328266052*^9, 3.4832826627352*^9}, {
   3.4832828444351997`*^9, 3.4832828520168*^9}, {3.4832838323996*^9, 
   3.4832838353324003`*^9}, {3.4832839270184*^9, 3.4832839490924*^9}, {
   3.4832841018272*^9, 3.4832841499063997`*^9}, {3.4832848887022*^9, 
   3.4832848913542*^9}, {3.4832859365924*^9, 3.4832859395408*^9}, {
   3.483286230758*^9, 3.483286234502*^9}, {3.483286514528*^9, 
   3.4832865204091997`*^9}, {3.4832867553842*^9, 3.483286763309*^9}, 
   3.484816737328931*^9, {3.4848218831551*^9, 3.484821884785102*^9}, {
   3.484822006125275*^9, 3.484822008725279*^9}, {3.4848224874192257`*^9, 
   3.4848224899392295`*^9}, {3.4848225433593044`*^9, 
   3.4848225508493147`*^9}, {3.4848269284363728`*^9, 
   3.4848269286393843`*^9}, {3.484827282888646*^9, 3.4848272847107506`*^9}, 
   3.484827399002288*^9, {3.4848283446413755`*^9, 3.4848283446983786`*^9}, {
   3.4848284469372263`*^9, 3.484828446966228*^9}, {3.484828550201133*^9, 
   3.4848285859191756`*^9}, {3.4848301764965596`*^9, 3.4848301785713634`*^9}, 
   3.4848306463432703`*^9, {3.48483120953685*^9, 3.484831223116869*^9}, {
   3.4848330221038723`*^9, 3.484833026455121*^9}, {3.484833082697338*^9, 
   3.4848331083778067`*^9}, {3.4848331670571632`*^9, 3.484833167232173*^9}, {
   3.484833213673829*^9, 3.4848332418394403`*^9}, 3.484833281952735*^9, {
   3.4848333129135056`*^9, 3.4848333396630354`*^9}, {3.4848335540893*^9, 
   3.484833556432434*^9}, {3.4848336932432594`*^9, 3.484833695899411*^9}, {
   3.4848339707931337`*^9, 3.484833973095266*^9}, {3.4856123915183477`*^9, 
   3.485612422821138*^9}, {3.4863903390634003`*^9, 3.48639041552*^9}, {
   3.4863904950956*^9, 3.4863904984496*^9}, {3.486400968980678*^9, 
   3.4864009697067194`*^9}, {3.4864014375874805`*^9, 3.486401443504819*^9}, {
   3.4864688787018003`*^9, 3.4864688824146*^9}, {3.486468987585*^9, 
   3.4864689891605997`*^9}, {3.486469233889*^9, 3.4864692542938004`*^9}, {
   3.4864711921730003`*^9, 3.4864712206429996`*^9}, {3.4867480347042*^9, 
   3.4867480364358*^9}, {3.4867481319234*^9, 3.4867481334834003`*^9}, {
   3.4867483290202*^9, 3.4867483409698*^9}, {3.4921659225198526`*^9, 
   3.492166046371937*^9}, {3.4921691741448355`*^9, 3.4921691855484877`*^9}, {
   3.4921879975834217`*^9, 3.4921881184413347`*^9}, 3.4921882018191037`*^9, {
   3.492277260820487*^9, 3.4922772772584267`*^9}, {3.4922777953010573`*^9, 
   3.4922778047395973`*^9}, 3.4922780255822287`*^9, {3.4922832515609217`*^9, 
   3.4922832623605394`*^9}, 3.4923429715279937`*^9, {3.4927756166174994`*^9, 
   3.49277566540129*^9}, {3.4927759034689064`*^9, 3.4927759060930567`*^9}, {
   3.4927889996717625`*^9, 3.4927890003227997`*^9}, 3.4927892543013268`*^9, {
   3.4927902190878315`*^9, 3.492790226855275*^9}, {3.4927908139108534`*^9, 
   3.4927908325419188`*^9}, 3.4927909931471047`*^9, 3.4929495622029724`*^9, {
   3.4929607972273912`*^9, 3.4929608099951215`*^9}, {3.492961149218524*^9, 
   3.492961153382762*^9}, {3.4929614574801555`*^9, 3.4929614659606404`*^9}, {
   3.4929656954565535`*^9, 3.492965701445896*^9}, {3.4929664615983744`*^9, 
   3.492966461882391*^9}, {3.493987401292*^9, 3.4939874046148*^9}, {
   3.4939956223234*^9, 3.493995625459*^9}, 3.4939959174354*^9, {
   3.4940849076731997`*^9, 3.4940849108087997`*^9}, {3.4940851696862*^9, 
   3.4940851717922*^9}, {3.494171928530195*^9, 3.4941719303709955`*^9}, {
   3.494172120098195*^9, 3.494172121470995*^9}, 3.4941722020937953`*^9, 
   3.494174973218395*^9, {3.4942487727191954`*^9, 3.494248773467995*^9}, {
   3.494248808427595*^9, 3.494248808536795*^9}, {3.494248863214795*^9, 
   3.4942488714671955`*^9}, {3.494259904747795*^9, 3.494259905293795*^9}, {
   3.494264544928195*^9, 3.494264545224595*^9}, {3.494264905030795*^9, 
   3.494264907791995*^9}, {3.4942649905421953`*^9, 3.4942649942549953`*^9}, {
   3.4942653546383953`*^9, 3.494265357789595*^9}, {3.494266386375595*^9, 
   3.494266390447195*^9}, {3.4942703487415953`*^9, 3.494270352875595*^9}, {
   3.4942831411646953`*^9, 3.494283143192695*^9}, {3.494284565631895*^9, 
   3.494284567597495*^9}, {3.494285628350695*^9, 3.4942856319698954`*^9}, {
   3.494339417782056*^9, 3.4943394186088557`*^9}, {3.494339874431256*^9, 
   3.4943398751488557`*^9}, {3.4943399776876554`*^9, 
   3.4943399966104555`*^9}, {3.4943554965789967`*^9, 3.494355497826997*^9}, 
   3.494356740498597*^9, {3.494357307809597*^9, 3.494357307871997*^9}, {
   3.494370752258197*^9, 3.494370752507797*^9}, {3.494420794734397*^9, 
   3.4944208029243965`*^9}, {3.494421053586997*^9, 3.494421056067397*^9}, {
   3.494422391154397*^9, 3.4944224006547966`*^9}, {3.494423121156397*^9, 
   3.494423122575997*^9}, 3.494423808461197*^9, {3.4944356069039965`*^9, 
   3.4944356071223965`*^9}, {3.4944409384582624`*^9, 3.494440938723462*^9}, 
   3.4944438111382623`*^9, {3.4944521517846622`*^9, 3.4944521520030622`*^9}, {
   3.494502618698262*^9, 3.494502620788662*^9}, {3.4945029712096624`*^9, 
   3.494502971459262*^9}, 3.494503516196662*^9, 3.494503829677462*^9, 
   3.4945040884168625`*^9, {3.4945048365734625`*^9, 3.4945048388510623`*^9}, 
   3.4945053234112625`*^9, 3.494506585125662*^9, 3.494506989658062*^9, {
   3.494507295281062*^9, 3.4945072955150623`*^9}, {3.4945075946772623`*^9, 
   3.4945075948956623`*^9}, {3.4945080026654625`*^9, 
   3.4945080029462624`*^9}, {3.494531453510415*^9, 3.494531454419467*^9}, {
   3.494531829613927*^9, 3.494531829820939*^9}, {3.4945321328362703`*^9, 
   3.4945321341843476`*^9}, 3.494532991937408*^9, 3.494533610210771*^9, 
   3.49453420549782*^9, {3.495041265836632*^9, 3.495041278581854*^9}, {
   3.495041314978017*^9, 3.4950413186752234`*^9}, {3.4951440584373565`*^9, 
   3.495144059529358*^9}, {3.495213330135436*^9, 3.4952133379722624`*^9}, {
   3.4952133745053883`*^9, 3.4952134053429775`*^9}, {3.495214105250867*^9, 
   3.4952141109981956`*^9}, {3.4952141420569725`*^9, 3.495214211231929*^9}, {
   3.4952145558114347`*^9, 3.4952145885619125`*^9}, {3.4952271134024*^9, 
   3.4952272389514203`*^9}, {3.495237670283049*^9, 3.495237696959096*^9}, {
   3.496253756776331*^9, 3.496253773106265*^9}, {3.4988454174251833`*^9, 
   3.4988454196559873`*^9}, {3.498847125603893*^9, 3.4988471266490946`*^9}, {
   3.5783235540091653`*^9, 3.578323667710244*^9}, {3.578323763393673*^9, 
   3.5783238385741525`*^9}, {3.578323942691374*^9, 3.5783239653923545`*^9}, {
   3.578324000728011*^9, 3.578324141384001*^9}, {3.5783243568160973`*^9, 
   3.5783245702653604`*^9}, {3.5786853610286922`*^9, 3.578685376483986*^9}, {
   3.578742337582098*^9, 3.578742458803244*^9}, {3.5787437774455423`*^9, 
   3.5787437854837513`*^9}, {3.578833630690712*^9, 3.578833653865943*^9}, 
   3.578834183409741*^9, {3.578834630516046*^9, 3.578834632454303*^9}, {
   3.578834749486186*^9, 3.578834749591056*^9}, {3.578835353489999*^9, 
   3.578835354137299*^9}, 3.5795549891295223`*^9, {3.5795701521967373`*^9, 
   3.5795704311678114`*^9}, {3.579570462518814*^9, 3.579570609192501*^9}, {
   3.579570663466709*^9, 3.5795706658819437`*^9}, {3.579570733545538*^9, 
   3.579570773416422*^9}, {3.579571006542085*^9, 3.579571032134761*^9}, {
   3.579571078286455*^9, 3.5795711393239202`*^9}, {3.579571175724594*^9, 
   3.579571222284666*^9}, {3.579733296393281*^9, 3.579733297729516*^9}, {
   3.5798116833334007`*^9, 3.5798116840170317`*^9}, {3.5798233929521046`*^9, 
   3.579823395027022*^9}, {3.57982352417838*^9, 3.579823526530554*^9}, {
   3.5798236133868246`*^9, 3.5798236292584925`*^9}, 3.5798239008244658`*^9, {
   3.5798247026755147`*^9, 3.5798247059935803`*^9}, {3.579825274900349*^9, 
   3.579825278527701*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Lft", "\[Rule]", 
     FractionBox["1", "4"]}], ",", 
    RowBox[{"Lfh", "\[Rule]", 
     FractionBox["1", "16"]}], ",", 
    RowBox[{"ha", "\[Rule]", 
     FractionBox["1", "10"]}], ",", 
    RowBox[{"Lc", "\[Rule]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{"Lt", "\[Rule]", 
     FractionBox["1", "2"]}], ",", 
    RowBox[{"rfx", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["1", "9"]}]}], ",", 
    RowBox[{"rfz", "\[Rule]", 
     FractionBox["1", "27"]}], ",", 
    RowBox[{"rcx", "\[Rule]", "0"}], ",", 
    RowBox[{"rcz", "\[Rule]", 
     FractionBox["3", "8"]}], ",", 
    RowBox[{"rtx", "\[Rule]", "0"}], ",", 
    RowBox[{"rtz", "\[Rule]", 
     FractionBox["7", "40"]}], ",", 
    RowBox[{"rTx", "\[Rule]", "0"}], ",", 
    RowBox[{"rTz", "\[Rule]", 
     FractionBox["1", "20"]}], ",", 
    RowBox[{"mf", "\[Rule]", 
     FractionBox["1", "10"]}], ",", 
    RowBox[{"mc", "\[Rule]", "1"}], ",", 
    RowBox[{"mt", "\[Rule]", "5"}], ",", 
    RowBox[{"mT", "\[Rule]", "20"}], ",", 
    RowBox[{"g", "\[Rule]", 
     FractionBox["981", "100"]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.579570253320286*^9, {3.5795706435112486`*^9, 3.579570671083756*^9}, {
   3.5795707339569187`*^9, 3.5795707749017963`*^9}, 3.5795709908405595`*^9, 
   3.579571051048257*^9, 3.5795710828336625`*^9, {3.5795711909987245`*^9, 
   3.5795712249841633`*^9}, 3.57957205193717*^9, 3.579573600293541*^9, 
   3.5796032122327757`*^9, 3.5796183393036695`*^9, 3.5796241662006755`*^9, 
   3.5798116855854816`*^9, 3.579823903062535*^9, 3.5798247076371*^9, 
   3.579825279849923*^9, 3.5799939412794914`*^9, 3.579999327528365*^9, 
   3.581014040537056*^9, {3.581888534191208*^9, 3.5818885613167973`*^9}, 
   3.581890521996229*^9, 3.583584383327774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["State space", "Subsubsection",
 CellChangeTimes->{{3.485611105489791*^9, 3.4856111154013577`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Qb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "[", "t", "]"}], ",", 
     RowBox[{
      SubscriptBox["p", "z"], "[", "t", "]"}], ",", 
     RowBox[{
      SubscriptBox["q", "0"], "[", "t", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dQb", "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "Qb"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Xb", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Qb", ",", "dQb"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"Length", "[", "Qb", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5783246803370857`*^9, 3.5783247132324877`*^9}, {
   3.5783247474390993`*^9, 3.578324795920906*^9}, 3.5783261442720146`*^9, {
   3.578326368144912*^9, 3.578326420134959*^9}, 3.57882490280514*^9, 
   3.5795712070375614`*^9, {3.579571687589115*^9, 3.579571703436776*^9}, 
   3.579571735596527*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nr", "=", "6"}], ";"}], "\n", 
 RowBox[{"Qr", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "#1"], "[", "t", "]"}], "&"}], ")"}], "/@", 
   RowBox[{"Range", "[", "nr", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"dQr", "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "t"], "Qr"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Xr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Qr", ",", "dQr"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4348998415914*^9, 3.4348998728382*^9}, {
   3.4348999758606*^9, 3.4348999820226*^9}, {3.4349000605685997`*^9, 
   3.434900078727*^9}, {3.4349002076142*^9, 3.4349002108746*^9}, {
   3.4349003921622*^9, 3.4349003968733997`*^9}, {3.4349031044564*^9, 
   3.4349031222092*^9}, {3.4349033544463997`*^9, 3.4349033847416*^9}, {
   3.434905033987*^9, 3.4349050435498*^9}, {3.4349052201886*^9, 
   3.4349052448688*^9}, {3.4350699032511997`*^9, 3.4350699037192*^9}, {
   3.435070016105*^9, 3.4350700168694*^9}, {3.4350703243970003`*^9, 
   3.435070324475*^9}, {3.43507063726*^9, 3.4350706395688*^9}, {
   3.4401625846896*^9, 3.4401625912316*^9}, {3.4404362916660004`*^9, 
   3.4404363701808004`*^9}, 3.442411325423357*^9, 3.455458349569009*^9, {
   3.4554588219994087`*^9, 3.455458901606209*^9}, {3.483182288981*^9, 
   3.4831822896986*^9}, 3.4831830194066*^9, {3.485610958414379*^9, 
   3.4856109855399303`*^9}, {3.4864645280864*^9, 3.4864645343576*^9}, {
   3.4864658750662003`*^9, 3.4864658796526003`*^9}, {3.4891631242463927`*^9, 
   3.4891632301684513`*^9}, {3.4891638028646107`*^9, 
   3.4891638065628223`*^9}, {3.4909727687047563`*^9, 
   3.4909727986054664`*^9}, {3.490973742044428*^9, 3.4909737607144957`*^9}, {
   3.4947646041195755`*^9, 3.494764609566887*^9}, {3.494764655668524*^9, 
   3.494764663716984*^9}, {3.5783246422969303`*^9, 3.5783246658797245`*^9}, {
   3.5783247260803614`*^9, 3.578324765208522*^9}, {3.578326370520108*^9, 
   3.5783264192391315`*^9}, 3.578417759155493*^9, 3.579570795853178*^9, {
   3.5795716785727744`*^9, 3.5795717332643695`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "2"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "3"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "4"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "5"], "(", "t", ")"}], ",", 
    RowBox[{
     SubscriptBox["q", "6"], "(", "t", ")"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.5795717217286973`*^9, 3.57957172744899*^9}, 
   3.5795720538069005`*^9, 3.5795736003175626`*^9, 3.5796032122618027`*^9, 
   3.5796183393366995`*^9, 3.579624166245717*^9, 3.5798116856075015`*^9, 
   3.579823903086556*^9, 3.579824707661122*^9, 3.5798252798739448`*^9, 
   3.579993941301512*^9, 3.579999327551386*^9, 3.58101404058235*^9, {
   3.5818885342418337`*^9, 3.5818885613613977`*^9}, 3.5818905220456*^9, 
   3.583584383388669*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Qb", ",", "Qr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dQ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"dQb", ",", "dQr"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"Q", ",", "dQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ne", "=", 
   RowBox[{"Length", "[", "Q", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.578324719333125*^9, 3.5783248115043077`*^9}, {
   3.5783263733277016`*^9, 3.5783264147830133`*^9}, {3.5795717407733154`*^9, 
   3.5795717748698583`*^9}, 3.581027340616795*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"statesubs", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Q", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"q", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "Q", "]"}], "]"}]}], ")"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"dQ", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
        "\[Rule]", 
        RowBox[{"dq", "[", "#", "]"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "dQ", "]"}], "]"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4349049195298*^9, 3.4349049437878*^9}, {
   3.4349993545274*^9, 3.4349993797214003`*^9}, {3.435000560398*^9, 
   3.4350005632528*^9}, {3.4350707572384*^9, 3.4350707618248*^9}, {
   3.4350772253014*^9, 3.4350772254262*^9}, {3.435078153829*^9, 
   3.4350782220322*^9}, {3.4350782615002003`*^9, 3.435078291811*^9}, 
   3.4350790937412*^9, {3.4350808724442*^9, 3.4350808770618*^9}, {
   3.4350815963042*^9, 3.4350815983789997`*^9}, {3.43508206077*^9, 
   3.4350820940136003`*^9}, {3.4350823303828*^9, 3.4350823363887997`*^9}, {
   3.435082521709*^9, 3.435082526545*^9}, {3.4353196505144*^9, 
   3.4353196948028*^9}, {3.435319873376*^9, 3.435319887572*^9}, {
   3.4353208165694*^9, 3.4353208194554*^9}, 3.4353210966127996`*^9, {
   3.4353212670866003`*^9, 3.4353212719694*^9}, {3.4353221386418*^9, 
   3.4353221496865997`*^9}, {3.4353223965699997`*^9, 3.4353223966792*^9}, {
   3.4353226242363997`*^9, 3.4353226261084003`*^9}, 3.4353235871907997`*^9, {
   3.4353368037764*^9, 3.4353368071616*^9}, {3.4353408653612003`*^9, 
   3.4353408717572002`*^9}, {3.4402457169728003`*^9, 
   3.4402457170039997`*^9}, {3.4402460597356*^9, 3.4402460624344*^9}, {
   3.440246662159*^9, 3.4402466701774*^9}, {3.4402712213442*^9, 
   3.4402712531052*^9}, {3.4402718403542*^9, 3.4402718491412*^9}, {
   3.4403487309802*^9, 3.4403487681082*^9}, {3.4403558159737997`*^9, 
   3.4403558578733997`*^9}, {3.4404236020412006`*^9, 
   3.4404236097008004`*^9}, {3.4404259997788005`*^9, 
   3.4404260399010005`*^9}, {3.4404385449296007`*^9, 
   3.4404385890630007`*^9}, {3.4404386440508003`*^9, 3.4404386584964004`*^9}, 
   3.4404395871088004`*^9, {3.440512097489174*^9, 3.4405121122935734`*^9}, 
   3.4406969117755737`*^9, {3.440705955990574*^9, 3.440705977159774*^9}, {
   3.440706170350174*^9, 3.4407061722065735`*^9}, {3.4407063815585737`*^9, 
   3.4407063820889735`*^9}, {3.4407067030823736`*^9, 
   3.4407067030823736`*^9}, {3.4407067839059734`*^9, 
   3.4407067883675737`*^9}, {3.4407068923727736`*^9, 3.4407068946347733`*^9}, 
   3.440768144048174*^9, {3.4407685888667736`*^9, 3.4407685998491735`*^9}, {
   3.4407690714937735`*^9, 3.440769106734174*^9}, 3.440780711814364*^9, {
   3.4409368493343477`*^9, 3.4409368579143476`*^9}, 3.440937052120748*^9, 
   3.4409512258825846`*^9, {3.440956158778185*^9, 3.440956158856185*^9}, {
   3.440956558182585*^9, 3.440956558712985*^9}, {3.440958204138585*^9, 
   3.4409582151365848`*^9}, {3.4409594130609846`*^9, 3.4409594175069847`*^9}, 
   3.441022061446353*^9, {3.4410228332095532`*^9, 3.4410228364699535`*^9}, {
   3.4410230877683535`*^9, 3.441023092479553*^9}, 3.441023136414753*^9, 
   3.441023168408553*^9, 3.441023627056353*^9, {3.441023820573553*^9, 
   3.441023834084153*^9}, 3.4410368933567533`*^9, 3.4410370482313533`*^9, {
   3.441038713002353*^9, 3.4410387191955533`*^9}, {3.441039431232353*^9, 
   3.4410394353819532`*^9}, {3.441136957010053*^9, 3.441136962251653*^9}, {
   3.4411372581532536`*^9, 3.441137262115653*^9}, {3.4415512244094*^9, 
   3.4415512464678*^9}, {3.4415516053494*^9, 3.4415516054742002`*^9}, {
   3.441998499572547*^9, 3.4419985050637465`*^9}, {3.442062672618947*^9, 
   3.4420626763005466`*^9}, {3.442065799594947*^9, 3.442065800920947*^9}, 
   3.442411325423357*^9, {3.455459616851609*^9, 3.455459620720409*^9}, {
   3.455632439318109*^9, 3.4556325240729094`*^9}, {3.4564869824795*^9, 
   3.4564870056455*^9}, {3.4564877199238997`*^9, 3.4564877233403*^9}, {
   3.457703557511973*^9, 3.457703557792773*^9}, 3.4577037077459726`*^9, {
   3.4831100776988*^9, 3.4831100778236*^9}, {3.4831102065236*^9, 
   3.4831102068512*^9}, {3.4831246610252*^9, 3.4831246622108*^9}, 
   3.4831885579214*^9, {3.4831888486552*^9, 3.4831888502464*^9}, {
   3.4831888982164*^9, 3.4831889029588003`*^9}, {3.4831892709578*^9, 
   3.4831892750762*^9}, {3.4831894285824003`*^9, 3.4831894537296*^9}, {
   3.4831954980938*^9, 3.4831955030702*^9}, {3.4831957806684*^9, 
   3.4831957809024*^9}, {3.4831959049547997`*^9, 3.4831959094632*^9}, {
   3.4831959744332*^9, 3.4831959822799997`*^9}, {3.4831961390518*^9, 
   3.4831961447302*^9}, {3.4831962051949997`*^9, 3.4831962100934*^9}, {
   3.4831963744941998`*^9, 3.4831963788154*^9}, {3.4831965001776*^9, 
   3.48319650024*^9}, {3.4831966132066*^9, 3.4831966175278*^9}, 
   3.4831967075312*^9, {3.4832268151275997`*^9, 3.4832268215704*^9}, {
   3.4832268967478*^9, 3.4832269037834*^9}, {3.4832269452304*^9, 
   3.4832269828398*^9}, {3.48328266052*^9, 3.4832826627352*^9}, {
   3.4832828444351997`*^9, 3.4832828520168*^9}, {3.4832838323996*^9, 
   3.4832838353324003`*^9}, {3.4832839270184*^9, 3.4832839490924*^9}, {
   3.4832841018272*^9, 3.4832841499063997`*^9}, {3.4832848887022*^9, 
   3.4832848913542*^9}, {3.4832859365924*^9, 3.4832859395408*^9}, {
   3.483286230758*^9, 3.483286234502*^9}, {3.483286514528*^9, 
   3.4832865204091997`*^9}, {3.4832867553842*^9, 3.483286763309*^9}, 
   3.484816737328931*^9, {3.4848218831551*^9, 3.484821884785102*^9}, {
   3.484822006125275*^9, 3.484822008725279*^9}, {3.4848224874192257`*^9, 
   3.4848224899392295`*^9}, {3.4848225433593044`*^9, 
   3.4848225508493147`*^9}, {3.4848269284363728`*^9, 
   3.4848269286393843`*^9}, {3.484827282888646*^9, 3.4848272847107506`*^9}, 
   3.484827399002288*^9, {3.4848283446413755`*^9, 3.4848283446983786`*^9}, {
   3.4848284469372263`*^9, 3.484828446966228*^9}, {3.484828550201133*^9, 
   3.4848285859191756`*^9}, {3.4848301764965596`*^9, 3.4848301785713634`*^9}, 
   3.4848306463432703`*^9, {3.48483120953685*^9, 3.484831223116869*^9}, {
   3.4848330221038723`*^9, 3.484833026455121*^9}, {3.484833082697338*^9, 
   3.4848331083778067`*^9}, {3.4848331670571632`*^9, 3.484833167232173*^9}, {
   3.484833213673829*^9, 3.4848332418394403`*^9}, 3.484833281952735*^9, {
   3.4848333129135056`*^9, 3.4848333396630354`*^9}, {3.4848335540893*^9, 
   3.484833556432434*^9}, {3.4848336932432594`*^9, 3.484833695899411*^9}, {
   3.4848339707931337`*^9, 3.484833973095266*^9}, {3.4856123915183477`*^9, 
   3.485612422821138*^9}, {3.4863903390634003`*^9, 3.48639041552*^9}, {
   3.4863904950956*^9, 3.4863904984496*^9}, {3.486400968980678*^9, 
   3.4864009697067194`*^9}, {3.4864014375874805`*^9, 3.486401443504819*^9}, {
   3.4864688787018003`*^9, 3.4864688824146*^9}, {3.486468987585*^9, 
   3.4864689891605997`*^9}, {3.486469233889*^9, 3.4864692542938004`*^9}, {
   3.4864711921730003`*^9, 3.4864712206429996`*^9}, {3.4867480347042*^9, 
   3.4867480364358*^9}, {3.4867481319234*^9, 3.4867481334834003`*^9}, {
   3.4867483290202*^9, 3.4867483409698*^9}, {3.4921659225198526`*^9, 
   3.492166046371937*^9}, {3.4921691741448355`*^9, 3.4921691855484877`*^9}, {
   3.4921879975834217`*^9, 3.4921881184413347`*^9}, 3.4921882018191037`*^9, {
   3.492277260820487*^9, 3.4922772772584267`*^9}, {3.4922777953010573`*^9, 
   3.4922778047395973`*^9}, 3.4922780255822287`*^9, {3.4922832515609217`*^9, 
   3.4922832623605394`*^9}, 3.4923429715279937`*^9, {3.4927756166174994`*^9, 
   3.49277566540129*^9}, {3.4927759034689064`*^9, 3.4927759060930567`*^9}, {
   3.4927889996717625`*^9, 3.4927890003227997`*^9}, 3.4927892543013268`*^9, {
   3.4927902190878315`*^9, 3.492790226855275*^9}, {3.4927908139108534`*^9, 
   3.4927908325419188`*^9}, 3.4927909931471047`*^9, 3.4929495622029724`*^9, {
   3.4929607972273912`*^9, 3.4929608099951215`*^9}, {3.492961149218524*^9, 
   3.492961153382762*^9}, {3.4929614574801555`*^9, 3.4929614659606404`*^9}, {
   3.4929656954565535`*^9, 3.492965701445896*^9}, {3.4929664615983744`*^9, 
   3.492966461882391*^9}, {3.493987401292*^9, 3.4939874046148*^9}, {
   3.4939956223234*^9, 3.493995625459*^9}, 3.4939959174354*^9, {
   3.4940849076731997`*^9, 3.4940849108087997`*^9}, {3.4940851696862*^9, 
   3.4940851717922*^9}, {3.494171928530195*^9, 3.4941719303709955`*^9}, {
   3.494172120098195*^9, 3.494172121470995*^9}, 3.4941722020937953`*^9, 
   3.494174973218395*^9, {3.4942487727191954`*^9, 3.494248773467995*^9}, {
   3.494248808427595*^9, 3.494248808536795*^9}, {3.494248863214795*^9, 
   3.4942488714671955`*^9}, {3.494259904747795*^9, 3.494259905293795*^9}, {
   3.494264544928195*^9, 3.494264545224595*^9}, {3.494264905030795*^9, 
   3.494264907791995*^9}, {3.4942649905421953`*^9, 3.4942649942549953`*^9}, {
   3.4942653546383953`*^9, 3.494265357789595*^9}, {3.494266386375595*^9, 
   3.494266390447195*^9}, {3.4942703487415953`*^9, 3.494270352875595*^9}, {
   3.4942831411646953`*^9, 3.494283143192695*^9}, {3.494284565631895*^9, 
   3.494284567597495*^9}, {3.494285628350695*^9, 3.4942856319698954`*^9}, {
   3.494339417782056*^9, 3.4943394186088557`*^9}, {3.494339874431256*^9, 
   3.4943398751488557`*^9}, {3.4943399776876554`*^9, 
   3.4943399966104555`*^9}, {3.4943554965789967`*^9, 3.494355497826997*^9}, 
   3.494356740498597*^9, {3.494357307809597*^9, 3.494357307871997*^9}, {
   3.494370752258197*^9, 3.494370752507797*^9}, {3.494420794734397*^9, 
   3.4944208029243965`*^9}, {3.494421053586997*^9, 3.494421056067397*^9}, {
   3.494422391154397*^9, 3.4944224006547966`*^9}, {3.494423121156397*^9, 
   3.494423122575997*^9}, 3.494423808461197*^9, {3.4944356069039965`*^9, 
   3.4944356071223965`*^9}, {3.4944409384582624`*^9, 3.494440938723462*^9}, 
   3.4944438111382623`*^9, {3.4944521517846622`*^9, 3.4944521520030622`*^9}, {
   3.494502618698262*^9, 3.494502620788662*^9}, {3.4945029712096624`*^9, 
   3.494502971459262*^9}, 3.494503516196662*^9, 3.494503829677462*^9, 
   3.4945040884168625`*^9, {3.4945048365734625`*^9, 3.4945048388510623`*^9}, 
   3.4945053234112625`*^9, 3.494506585125662*^9, 3.494506989658062*^9, {
   3.494507295281062*^9, 3.4945072955150623`*^9}, {3.4945075946772623`*^9, 
   3.4945075948956623`*^9}, {3.4945080026654625`*^9, 
   3.4945080029462624`*^9}, {3.494531453510415*^9, 3.494531454419467*^9}, {
   3.494531829613927*^9, 3.494531829820939*^9}, {3.4945321328362703`*^9, 
   3.4945321341843476`*^9}, 3.494532991937408*^9, 3.494533610210771*^9, 
   3.49453420549782*^9, {3.495041265836632*^9, 3.495041278581854*^9}, {
   3.495041314978017*^9, 3.4950413186752234`*^9}, {3.4951440584373565`*^9, 
   3.495144059529358*^9}, {3.495213330135436*^9, 3.4952133379722624`*^9}, {
   3.4952133745053883`*^9, 3.4952134053429775`*^9}, {3.495214105250867*^9, 
   3.4952141109981956`*^9}, {3.4952141420569725`*^9, 3.495214211231929*^9}, {
   3.4952145558114347`*^9, 3.4952145885619125`*^9}, {3.4952271134024*^9, 
   3.4952272389514203`*^9}, {3.495237670283049*^9, 3.495237696959096*^9}, 
   3.496253756776331*^9, {3.497179598420119*^9, 3.497179602708788*^9}, {
   3.5783263005044003`*^9, 3.5783263378729353`*^9}, {3.57839511403271*^9, 
   3.5783951407614284`*^9}, {3.578742490455744*^9, 3.578742490766797*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "1", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "z"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "2", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "0"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "3", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "4", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "5", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "6", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "7", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "8", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"q", "(", "9", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "x"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "1", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "z"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "2", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "0"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "3", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "4", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "5", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "3"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "6", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "4"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "7", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "5"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "8", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "6"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"dq", "(", "9", ")"}]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.578395165262086*^9, 3.57840979238995*^9, 3.5784128545317717`*^9, 
   3.5784130836496563`*^9, 3.5784140230924377`*^9, 3.578414522579356*^9, 
   3.578414654633478*^9, 3.578414900852177*^9, {3.578415027448251*^9, 
   3.5784150573749266`*^9}, 3.57841530694973*^9, {3.5784153477784877`*^9, 
   3.578415359787593*^9}, 3.5784177648947997`*^9, 3.578418152792522*^9, 
   3.5784200509769335`*^9, 3.5786852053297033`*^9, {3.5786852430185566`*^9, 
   3.5786852567322397`*^9}, 3.57868531397818*^9, 3.5786853679871264`*^9, 
   3.5786854031936855`*^9, 3.5786894771191883`*^9, {3.578689589982563*^9, 
   3.578689605851238*^9}, 3.578742491465912*^9, 3.578742740988665*^9, 
   3.578743808092835*^9, 3.578824903297*^9, 3.578825185805786*^9, 
   3.578828829899239*^9, 3.5788336603254137`*^9, 3.578833740903619*^9, 
   3.578833823736824*^9, 3.5788341871279573`*^9, 3.578834636355875*^9, 
   3.5788347533189497`*^9, {3.578835074968417*^9, 3.578835089542561*^9}, 
   3.5788351604035873`*^9, 3.578835247523398*^9, 3.578835357249106*^9, 
   3.579553607571456*^9, 3.5795538141825895`*^9, 3.579553872651679*^9, 
   3.5795539880474305`*^9, 3.5795549908671293`*^9, 3.579570803495248*^9, {
   3.5795712127998915`*^9, 3.579571227297304*^9}, 3.5795717838982105`*^9, 
   3.5795720546977243`*^9, 3.5795736003445883`*^9, 3.5796032122908297`*^9, 
   3.5796183393877463`*^9, 3.579624166285754*^9, 3.5798116856325245`*^9, 
   3.5798239031105785`*^9, 3.579824707686145*^9, 3.5798252798989677`*^9, 
   3.579993941326535*^9, 3.5799993275744076`*^9, 3.581014040683262*^9, {
   3.581888534306631*^9, 3.581888561407014*^9}, 3.581890522092649*^9, 
   3.583584383435657*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mf", ",", "mc", ",", "mt", ",", "mT", ",", "mt", ",", "mc", ",", "mf"}],
      "}"}], "/.", "constsubs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.455459467232009*^9, 3.455459479540409*^9}, {
  3.4554595164032087`*^9, 3.455459517292409*^9}, {3.492188011584223*^9, 
  3.4921880120392485`*^9}, {3.5783261208563747`*^9, 3.57832612151198*^9}, {
  3.5784178965145197`*^9, 3.578417898410273*^9}, {3.57841834867467*^9, 
  3.578418353755369*^9}, {3.578742496594079*^9, 3.578742499192305*^9}, {
  3.5795708092605815`*^9, 3.5795708127478075`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Useful functions", "Subsubsection",
 CellChangeTimes->{{3.4404317665824003`*^9, 3.4404317725728006`*^9}, {
  3.4427788776184*^9, 3.4427788792564*^9}, {3.4857074415682583`*^9, 
  3.485707447948658*^9}, {3.4954551277859*^9, 3.4954551288623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CrossProd", "[", "\[CapitalOmega]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"\[CapitalOmega]", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.485706888267458*^9, 3.485706935348258*^9}, {
  3.4857070676674585`*^9, 3.485707073392658*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelSimplify", "[", 
   RowBox[{"A_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelSimplify", "[", 
   RowBox[{"A_", "?", "VectorQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelSimplify", "[", "A_", "]"}], ":=", 
  RowBox[{"Simplify", "[", "A", "]"}]}]}], "Input",
 CellChangeTimes->{{3.525444031603923*^9, 3.525444057323394*^9}, 
   3.525444167371688*^9, {3.5254442077009945`*^9, 3.5254442142373686`*^9}, {
   3.5254442656763105`*^9, 3.52544431862834*^9}, {3.5254446389836626`*^9, 
   3.525444643198904*^9}, {3.5273464706540365`*^9, 3.527346473775215*^9}, 
   3.527423798626493*^9, {3.5387532837469378`*^9, 3.5387532943515444`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ParallelFullSimplify", "[", 
   RowBox[{"A_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "A", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelFullSimplify", "[", 
   RowBox[{"A_", "?", "VectorQ"}], "]"}], ":=", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ParallelFullSimplify", "[", "A_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", "A", "]"}]}]}], "Input",
 CellChangeTimes->{{3.581008894965406*^9, 3.581008912634509*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Homogeneous Transformations", "Subsubsection",
 CellChangeTimes->{{3.4438784331203923`*^9, 3.4438784402963924`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"fname_", "?", "StringQ"}]}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stream", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"builddir", ",", 
         RowBox[{"fname", "<>", "\"\<.math\>\""}]}], "}"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Write", "[", 
     RowBox[{"stream", ",", 
      RowBox[{"expr", "/.", "statesubs"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "stream", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "stream", "]"}], ";"}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5783512518387775`*^9, 3.578351515833716*^9}, {
   3.578351691684667*^9, 3.578351694675142*^9}, {3.5784130545207186`*^9, 
   3.5784130692713594`*^9}, {3.578414646377844*^9, 3.578414650035226*^9}, {
   3.5784153008200617`*^9, 3.5784153040750737`*^9}, 3.578828120680715*^9, {
   3.5795713120457034`*^9, 3.579571334495472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Coms", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rfx", ",", "0", ",", "rfz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rcx", ",", "0", ",", "rcz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rtx", ",", "0", ",", "rtz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rTx", ",", "0", ",", "rTz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rtx", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "Lt"}], "+", "rtz"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"rcx", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "Lc"}], "+", "rcz"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Lft", "+", "rfx"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "ha"}], "+", "rfz"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], "/.", "constsubs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Offsets", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Lc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Lt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "Lt"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "Lc"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Lft", ",", "0", ",", 
        RowBox[{"-", "ha"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    "constsubs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Masses", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "mm"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.578834783294169*^9, 3.5788349878914557`*^9}, {
   3.578835237226836*^9, 3.578835241708209*^9}, 3.5788353467274*^9, {
   3.5795712557446203`*^9, 3.5795712878503213`*^9}, {3.579571343998262*^9, 
   3.579571345014203*^9}, {3.5795713958782578`*^9, 3.579571487401924*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"Coms", ",", "\"\<Model_Coms\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"Offsets", ",", "\"\<Model_Offsets\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"Masses", ",", "\"\<Model_Masses\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.578834989411374*^9, 3.5788350854629393`*^9}, {
  3.579571303349659*^9, 3.579571332781887*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematics and Dynamics", "Section",
 CellChangeTimes->{{3.4864650144454*^9, 3.4864650153658*^9}, {
  3.4909741264094124`*^9, 3.490974127139454*^9}, {3.578415016119775*^9, 
  3.578415022167368*^9}}],

Cell[CellGroupData[{

Cell["Define twists", "Subsubsection",
 CellChangeTimes->{{3.4348155465694*^9, 3.4348155500794*^9}, 
   3.4349030872184*^9, 3.442411325423357*^9, 3.489163860407902*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "0"], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "px"], "=", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "pz"], "=", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q0"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}], ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q1"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q2"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q3"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q4"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q5"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}], ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Xi]", "q6"], "=", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}], ",", "0"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4402720698982*^9, 3.4402720709282*^9}, {
   3.4402721864062*^9, 3.4402722488272*^9}, {3.4402722791132*^9, 
   3.4402722797082*^9}, {3.4402723198352003`*^9, 3.4402723551052*^9}, {
   3.4402724855052*^9, 3.4402724855792*^9}, {3.4402727516622*^9, 
   3.4402729073012*^9}, {3.4403401347148*^9, 3.4403401672876*^9}, {
   3.4415516485769997`*^9, 3.4415516619774*^9}, 3.442411325423357*^9, {
   3.455458666639009*^9, 3.455458702581409*^9}, {3.485611086693716*^9, 
   3.485611088213803*^9}, {3.485611149238293*^9, 3.4856111837682686`*^9}, {
   3.4856115268658924`*^9, 3.485611568033247*^9}, {3.4856117593341885`*^9, 
   3.4856118277371016`*^9}, {3.485611913392*^9, 3.485611957202506*^9}, {
   3.4856246457932425`*^9, 3.4856246493532476`*^9}, {3.4863904818044*^9, 
   3.4863904884968*^9}, {3.4864658161294003`*^9, 3.486465816925*^9}, {
   3.489163262470299*^9, 3.489163387710462*^9}, {3.489163548175043*^9, 
   3.489163575427602*^9}, {3.489163613304768*^9, 3.4891636740492425`*^9}, {
   3.4891637562279425`*^9, 3.489163770599765*^9}, 3.4891638604099016`*^9, {
   3.4909726797386675`*^9, 3.4909727020469437`*^9}, {3.490972733790759*^9, 
   3.490972752789846*^9}, {3.4909741452484903`*^9, 3.490974175111198*^9}, {
   3.4954562663675003`*^9, 3.4954562671942997`*^9}, {3.578324854046624*^9, 
   3.57832486757913*^9}, {3.5784149327807045`*^9, 3.5784149342360506`*^9}, {
   3.5784177786515226`*^9, 3.5784178050289164`*^9}, {3.5795715133909664`*^9, 
   3.5795715791558056`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalXi]b", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Xi]", "#1"], "&"}], ")"}], "/@", 
    RowBox[{"{", 
     RowBox[{"px", ",", "pz", ",", "q0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalXi]r", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Xi]", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<q\>\"", "<>", 
         RowBox[{"ToString", "[", "#1", "]"}]}], "]"}]], "&"}], ")"}], "/@", 
    RowBox[{"Range", "[", "nr", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalXi]", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"\[CapitalXi]b", ",", "\[CapitalXi]r"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5783248944289436`*^9, 3.5783249769682245`*^9}, {
  3.5783255976638546`*^9, 3.57832559915223*^9}, {3.5784178130363207`*^9, 
  3.5784178138120384`*^9}, {3.579571600861884*^9, 3.57957161115841*^9}, {
  3.5795716454070935`*^9, 3.5795716689668884`*^9}, {3.5795718256067944`*^9, 
  3.5795718275185633`*^9}, {3.5796281465613427`*^9, 3.5796281480086803`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Base configuration", "Subsubsection",
 CellChangeTimes->{{3.4402723662482*^9, 3.4402723751851997`*^9}, {
   3.4403491303598003`*^9, 3.4403491303754*^9}, 3.442411325423357*^9, {
   3.455632572510909*^9, 3.455632572869709*^9}, {3.4867430692058*^9, 
   3.4867430715769997`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "1"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"rfx", ",", "0", ",", "rfz"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "2"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "+", "rcx"}], ",", "0", ",", 
       RowBox[{"ha", "+", "rcz"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "3"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "+", "rtx"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "rtz"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "4"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "+", "rTx"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt", "+", "rTz"}]}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "5"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "+", "rtx"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "rtz"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "6"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "+", "rcx"}], ",", "0", ",", 
       RowBox[{"ha", "+", "rcz"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", 
     SubscriptBox["sl", "7"]], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"rfx", ",", "0", ",", "rfz"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4318771891098003`*^9, 3.4318772252862*^9}, {
   3.4318775138238*^9, 3.4318775411706*^9}, {3.4318776089370003`*^9, 
   3.4318776963438*^9}, {3.4318779788258*^9, 3.4318779789974003`*^9}, {
   3.4318780149086*^9, 3.4318780247366*^9}, {3.4318780914890003`*^9, 
   3.4318781200369997`*^9}, {3.4318781625938*^9, 3.4318784663414*^9}, 
   3.4318785749630003`*^9, {3.4318786617146*^9, 3.4318786799354*^9}, {
   3.4318787126692*^9, 3.4318787609688*^9}, 3.4318795326956*^9, 
   3.4318808257258*^9, {3.4318819866636*^9, 3.431881989612*^9}, 
   3.431883310811*^9, {3.4318964255358*^9, 3.4318964325246*^9}, {
   3.4318975554936*^9, 3.4318975700952*^9}, {3.4318979431224003`*^9, 
   3.4318979481924*^9}, {3.4318979805136003`*^9, 3.4318979966752*^9}, 
   3.4318981861098003`*^9, {3.4318982463414*^9, 3.4318983434358*^9}, {
   3.4318984551786003`*^9, 3.4318985237874002`*^9}, {3.431898649539*^9, 
   3.4318986510053997`*^9}, {3.4318999808311996`*^9, 3.4319000233412*^9}, {
   3.4319005959558*^9, 3.431900633115*^9}, 3.4319046039323997`*^9, {
   3.4319464318132*^9, 3.4319464855396*^9}, {3.431946535054*^9, 
   3.431946805718*^9}, {3.4319468419568*^9, 3.4319468657468*^9}, {
   3.4319469451352*^9, 3.4319470590931997`*^9}, {3.4319474653796*^9, 
   3.4319475736904*^9}, {3.4319476122858*^9, 3.4319476916274*^9}, {
   3.4319477673654003`*^9, 3.431947930479*^9}, 3.4319479833006*^9, 
   3.4319481795954*^9, {3.4319518302636003`*^9, 3.4319518601219997`*^9}, {
   3.4319525549002*^9, 3.431952558613*^9}, {3.4319526568462*^9, 
   3.4319526883114*^9}, 3.4319528435938*^9, {3.431952878413*^9, 
   3.4319528793022003`*^9}, {3.4319529547438*^9, 3.4319529862558002`*^9}, {
   3.4319532090861998`*^9, 3.4319532506446*^9}, {3.4319536489594*^9, 
   3.4319536493962*^9}, {3.4319537284414*^9, 3.4319537576134*^9}, {
   3.431959500242*^9, 3.4319595589916*^9}, {3.431959669035*^9, 
   3.4319596718742*^9}, {3.4319597254133997`*^9, 3.4319597264118*^9}, {
   3.4319597923882*^9, 3.4319598564574003`*^9}, {3.4319598988738003`*^9, 
   3.4319599161274*^9}, {3.4319599589026003`*^9, 3.431959962163*^9}, {
   3.4319600815186*^9, 3.4319601287866*^9}, {3.4319601627946*^9, 
   3.4319602535397997`*^9}, {3.4319603062678003`*^9, 3.4319603455954*^9}, {
   3.4319604033622*^9, 3.431960458634*^9}, {3.4319606297046003`*^9, 
   3.4319606528238*^9}, {3.4319608020690002`*^9, 3.4319608042218*^9}, 
   3.431960857527*^9, {3.431962506019*^9, 3.4319625488254004`*^9}, 
   3.4319625878722*^9, {3.4319766531037636`*^9, 3.4319766567541637`*^9}, {
   3.4319766912769637`*^9, 3.4319766961909637`*^9}, {3.431976903171764*^9, 
   3.431976913904564*^9}, {3.4319779098165636`*^9, 3.4319779166493635`*^9}, {
   3.4402724204712*^9, 3.4402724482872*^9}, {3.4403401412200003`*^9, 
   3.4403401444024*^9}, {3.4403489395522003`*^9, 3.4403489434678*^9}, {
   3.441551713473*^9, 3.4415517353129997`*^9}, {3.4415526264432*^9, 
   3.4415526270204*^9}, 3.442411325423357*^9, {3.455458713376609*^9, 
   3.4554587496466093`*^9}, {3.485611196839016*^9, 3.4856112266167192`*^9}, {
   3.485611840272818*^9, 3.4856118783609967`*^9}, {3.486400985031596*^9, 
   3.486400985782639*^9}, {3.4891638852623234`*^9, 3.489163900505195*^9}, {
   3.578324987053545*^9, 3.578325023960654*^9}, {3.578325057280447*^9, 
   3.5783250762639914`*^9}, {3.578325125014045*^9, 3.5783252334342427`*^9}, 
   3.5783267263179255`*^9, {3.5784178186124773`*^9, 3.578417878885216*^9}, {
   3.5795718324781504`*^9, 3.579571923772607*^9}, {3.5796281783277006`*^9, 
   3.579628179889143*^9}, {3.581025932082691*^9, 3.581025932137671*^9}, {
   3.581888650061297*^9, 3.581888650468319*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Subsection",
 CellChangeTimes->{{3.4402741299372*^9, 3.4402741309681997`*^9}, {
   3.4404242232176003`*^9, 3.4404242402528005`*^9}, 3.4404361446456003`*^9, 
   3.442411325423357*^9, 3.578743842850342*^9}],

Cell[CellGroupData[{

Cell["Calculate the forward kinematics", "Subsubsection",
 CellChangeTimes->{{3.485611263993857*^9, 3.485611268537117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["g", "i"], "[", "\[Theta]", "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"ForwardKinematics", "@@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\[CapitalXi]", "\[LeftDoubleBracket]", "#1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "Q", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]}], 
             "}"}], "&"}], ")"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"2", "+", "i"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["g", 
            SubscriptBox["sl", "i"]], "[", "0", "]"}], "}"}]}], "]"}]}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "mm", "]"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.485611277352621*^9, 3.4856114999953556`*^9}, {
   3.4856119672600813`*^9, 3.4856119898893757`*^9}, {3.485612564103219*^9, 
   3.485612564770257*^9}, {3.4909728608650274`*^9, 3.4909729930555887`*^9}, {
   3.4909740120638723`*^9, 3.4909740174341793`*^9}, {3.4909742339035606`*^9, 
   3.4909742605320835`*^9}, {3.491046895928237*^9, 3.491046915828375*^9}, 
   3.5783254221396403`*^9, {3.5783258386755905`*^9, 3.5783259163774004`*^9}, 
   3.578326462441057*^9, {3.5783275273532195`*^9, 3.578327531232806*^9}, {
   3.578417889765279*^9, 3.578417892307629*^9}, {3.5784181802619257`*^9, 
   3.5784181827091885`*^9}, {3.579628263667569*^9, 3.579628270050468*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate the kinetic energy and manipulator inertia matrix", \
"Subsubsection",
 CellChangeTimes->{{3.432034707783764*^9, 3.432034716738164*^9}, {
   3.4348164244282*^9, 3.4348164316666*^9}, 3.43793555653119*^9, {
   3.4403491407962*^9, 3.4403491422158003`*^9}, 3.442411325423357*^9, {
   3.48561167578541*^9, 3.4856116779615345`*^9}, {3.490973632931187*^9, 
   3.490973644399843*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "mm", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{
    SubscriptBox["v", "i"], "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"{", "t", "}"}]], 
      RowBox[{"RigidPosition", "[", 
       RowBox[{
        SubscriptBox["g", "i"], "[", "\[Theta]", "]"}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4856115845611925`*^9, 3.4856116304758186`*^9}, {
  3.5783259345471926`*^9, 3.5783259381825523`*^9}, {3.5784179070502625`*^9, 
  3.578417910091076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", "i", 
       RowBox[{"Length", "[", "mm", "]"}]], 
      RowBox[{
       RowBox[{"mm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       " ", 
       RowBox[{
        SubscriptBox["v", "i"], ".", 
        SubscriptBox["v", "i"]}]}]}]}], "/.", "constsubs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.485611635709118*^9, 3.4856116709951363`*^9}, {
   3.485611905411544*^9, 3.485611906514607*^9}, 3.485612004812229*^9, {
   3.4909737871970105`*^9, 3.4909737900281725`*^9}, {3.4921673276182203`*^9, 
   3.492167330274372*^9}, {3.578325947071767*^9, 3.578325947222906*^9}, {
   3.5784147036167765`*^9, 3.578414707177069*^9}, {3.578414750168827*^9, 
   3.5784147519044333`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xtest", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"X", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}], 
      "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0.0510", ",", "0.2255", ",", 
         RowBox[{"-", "0.2727"}], ",", "0.0843", ",", "0.1712", ",", "0", ",",
          "\[IndentingNewLine]", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "0.6404"}], ",", "0.5087", ",", "0.0969", ",", "0.3463",
          ",", "0.0177", ",", "0"}], "}"}], "\[LeftDoubleBracket]", "#1", 
       "\[RightDoubleBracket]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "X", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5783265470252275`*^9, 3.578326565816594*^9}, {
  3.5783284305699472`*^9, 3.578328539065216*^9}, {3.5784179309073257`*^9, 
  3.5784179559254627`*^9}, {3.5784182577475824`*^9, 3.5784183157562304`*^9}, {
  3.5787438792127867`*^9, 3.578743933605633*^9}, {3.5787439983419323`*^9, 
  3.57874400031614*^9}, {3.579571985103343*^9, 3.579572006222881*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["p", "x"], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "z"], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "0"], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "1"], "(", "t", ")"}], "\[Rule]", "0.051`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "(", "t", ")"}], "\[Rule]", "0.2255`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "3"], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"-", "0.2727`"}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "4"], "(", "t", ")"}], "\[Rule]", "0.0843`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "5"], "(", "t", ")"}], "\[Rule]", "0.1712`"}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "6"], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "x"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["p", "z"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "0"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
     RowBox[{"-", "0.6404`"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0.5087`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "3"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0.0969`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "4"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0.3463`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "5"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0.0177`"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "6"], "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[Rule]", "0"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5784183161175623`*^9, 3.578420053334113*^9, {3.578685217970393*^9, 
   3.5786852591034327`*^9}, 3.5786853164174356`*^9, 3.5786853703302937`*^9, 
   3.578685405526843*^9, 3.578689479504395*^9, {3.5786895923997984`*^9, 
   3.5786896082054157`*^9}, 3.578742581800956*^9, 3.5787427433627367`*^9, 
   3.5787438104188643`*^9, 3.578744001000458*^9, 3.578824906190947*^9, 
   3.578825188322592*^9, 3.578828832458157*^9, 3.5788336628313103`*^9, 
   3.578833743390794*^9, 3.578833826409565*^9, 3.578834189834495*^9, 
   3.5788346387338047`*^9, 3.5788347558828163`*^9, {3.578835077815321*^9, 
   3.57883509216147*^9}, 3.57883516302211*^9, 3.578835250098043*^9, 
   3.57883535990272*^9, 3.5795536114180136`*^9, 3.5795538167970085`*^9, 
   3.5795538750769224`*^9, 3.57955399040361*^9, 3.579554992979083*^9, 
   3.579571977761551*^9, 3.5795720131012444`*^9, 3.5795720732288666`*^9, 
   3.5796032215704055`*^9, 3.579618348568841*^9, 3.5796241753666873`*^9, 
   3.579628321823786*^9, 3.579811694390619*^9, 3.5798239119417405`*^9, 
   3.5798247164382334`*^9, 3.5798252887621593`*^9, 3.579993950384898*^9, 
   3.579999336561705*^9, 3.581014048811137*^9, 3.581888534645816*^9, 
   3.5818885702651443`*^9, 3.581890530142613*^9, 3.5835843918514633`*^9}]
}, Open  ]],

Cell[TextData[{
 "This ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalD]", TraditionalForm]]],
 " matrix checks out with the test values.:"
}], "Text",
 CellChangeTimes->{{3.5783952567897296`*^9, 3.5783952760055*^9}, {
  3.578744001452063*^9, 3.578744002642103*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalD]", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"T", ",", 
      RowBox[{"{", 
       RowBox[{"dQ", ",", "2"}], "}"}]}], "]"}], "//", "ParallelSimplify"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.5786895734102373`*^9, 3.5786895998106527`*^9}, {
  3.5818885182439747`*^9, 3.581888519947719*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalD]", "/.", "constsubs"}], "/.", "\[VeryThinSpace]",
    "xtest"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.5783261669509726`*^9, 3.5783261677036686`*^9}, {
  3.5783262471280713`*^9, 3.5783262476235285`*^9}, {3.5783264877594557`*^9, 
  3.578326500231982*^9}, {3.578326573280493*^9, 3.5783267078398476`*^9}, {
  3.578326779615181*^9, 3.5783267894392595`*^9}, {3.5783268240002003`*^9, 
  3.57832682455171*^9}, {3.5783284250478477`*^9, 3.5783284264161086`*^9}, {
  3.578742592052678*^9, 3.578742592728529*^9}, {3.578744006869904*^9, 
  3.578744008760388*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"32.2`", "0.`", "31.167075075198262`", 
      RowBox[{"-", "27.95337137149456`"}], 
      RowBox[{"-", "12.049077345390991`"}], "1.3470065200741188`", 
      RowBox[{"-", "2.346999300082807`"}], 
      RowBox[{"-", "0.17904276710613828`"}], 
      RowBox[{"-", "0.009556940962871366`"}]},
     {"0.`", "32.2`", "12.859722744192595`", 
      RowBox[{"-", "4.823611633081484`"}], 
      RowBox[{"-", "4.011788665159093`"}], 
      RowBox[{"-", "0.21039917321994256`"}], "0.20659918236526925`", 
      "0.03170072289868923`", 
      RowBox[{"-", "0.011883158715208973`"}]},
     {"31.167075075198262`", "12.859722744192595`", "37.00775317464978`", 
      RowBox[{"-", "30.677891387117466`"}], 
      RowBox[{"-", "14.849919514891074`"}], "0.28518469375401473`", 
      RowBox[{"-", "1.417100717571884`"}], 
      RowBox[{"-", "0.04061734593001037`"}], 
      RowBox[{"-", "0.005461783370207314`"}]},
     {
      RowBox[{"-", "27.95337137149456`"}], 
      RowBox[{"-", "4.823611633081484`"}], 
      RowBox[{"-", "30.677891387117466`"}], "26.676651341697642`", 
      "12.642064614062201`", 
      RowBox[{"-", "0.2030838350515884`"}], "1.2340505831549202`", 
      "0.030638249944068836`", "0.0015352995951179334`"},
     {
      RowBox[{"-", "12.049077345390991`"}], 
      RowBox[{"-", "4.011788665159093`"}], 
      RowBox[{"-", "14.849919514891074`"}], "12.642064614062201`", 
      "6.523102886426764`", "0.4641808704142054`", "0.06734273429532456`", 
      RowBox[{"-", "0.057958718230320797`"}], 
      RowBox[{"-", "0.003539847037224087`"}]},
     {"1.3470065200741188`", 
      RowBox[{"-", "0.21039917321994256`"}], "0.28518469375401473`", 
      RowBox[{"-", "0.2030838350515884`"}], "0.4641808704142054`", 
      "1.0833838544016463`", 
      RowBox[{"-", "1.0333838544016463`"}], 
      RowBox[{"-", "0.13975279825706455`"}], 
      RowBox[{"-", "0.009758809238551347`"}]},
     {
      RowBox[{"-", "2.346999300082807`"}], "0.20659918236526925`", 
      RowBox[{"-", "1.417100717571884`"}], "1.2340505831549202`", 
      "0.06734273429532456`", 
      RowBox[{"-", "1.0333838544016463`"}], "1.0333838544016463`", 
      "0.13975279825706455`", "0.009758809238551347`"},
     {
      RowBox[{"-", "0.17904276710613828`"}], "0.03170072289868923`", 
      RowBox[{"-", "0.04061734593001037`"}], "0.030638249944068836`", 
      RowBox[{"-", "0.057958718230320797`"}], 
      RowBox[{"-", "0.13975279825706455`"}], "0.13975279825706455`", 
      "0.04924674211248285`", "0.005473593964334705`"},
     {
      RowBox[{"-", "0.009556940962871366`"}], 
      RowBox[{"-", "0.011883158715208973`"}], 
      RowBox[{"-", "0.005461783370207314`"}], "0.0015352995951179334`", 
      RowBox[{"-", "0.003539847037224087`"}], 
      RowBox[{"-", "0.009758809238551347`"}], "0.009758809238551347`", 
      "0.005473593964334705`", "0.002325445816186557`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5786894795254135`*^9, {3.5786895952444286`*^9, 3.578689610912919*^9}, 
   3.578742745807825*^9, 3.578743812638289*^9, {3.5787440070127373`*^9, 
   3.5787440090708733`*^9}, 3.57882490841815*^9, 3.5788251905457897`*^9, 
   3.578828834544587*^9, 3.578833665449435*^9, 3.578833745484479*^9, 
   3.578833828517667*^9, 3.578834191980332*^9, 3.5788346408233967`*^9, 
   3.578834758109427*^9, {3.5788350800662193`*^9, 3.578835094285164*^9}, 
   3.5788351651866407`*^9, 3.57883525220891*^9, 3.5788353620210133`*^9, 
   3.579553613500941*^9, 3.5795538188348937`*^9, 3.579553877093788*^9, 
   3.579553992470522*^9, 3.5795549945615473`*^9, 3.579572032379077*^9, 
   3.579572087170764*^9, 3.5796032361398706`*^9, 3.5796183625824475`*^9, 
   3.5796241893368225`*^9, 3.5796283605993304`*^9, 3.579811707859066*^9, 
   3.5798239291246195`*^9, 3.579824733692179*^9, 3.5798253031794834`*^9, 
   3.579993964633053*^9, 3.579999350730787*^9, 3.581014060885723*^9, 
   3.5818885758727083`*^9, 3.581890538829336*^9, 3.5835844040478983`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"\[ScriptCapitalD]", ",", "\"\<Mmat\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.57868943439668*^9, 3.578689457009592*^9}, 
   3.5818885126099463`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Coriolis matrix", "Subsubsection",
 CellChangeTimes->{{3.4558938735559998`*^9, 3.4558938782204*^9}, {
  3.4922829997605195`*^9, 3.4922830012316036`*^9}}],

Cell["\<\
Simplifying is extremely slow. You can remove it for testing purposes.\
\>", "Text",
 CellChangeTimes->{{3.5783274771988688`*^9, 3.578327499142147*^9}, {
  3.5787425978647747`*^9, 3.578742599427287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalC]", "=", 
   RowBox[{"PSimple", "[", 
    RowBox[{"InertiaToCoriolis", "[", 
     RowBox[{"\[ScriptCapitalD]", ",", "Q", ",", "dQ"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4558938797648*^9, 3.4558939032584*^9}, {
   3.4558940943896*^9, 3.4558940973224*^9}, 3.4831814752265997`*^9, {
   3.4909737309487934`*^9, 3.4909737368101287`*^9}, {3.49113429117142*^9, 
   3.4911343711649957`*^9}, {3.4911349135770197`*^9, 3.491134931472043*^9}, 
   3.491135313180876*^9, {3.491138287989025*^9, 3.4911382928523035`*^9}, {
   3.491139665135793*^9, 3.491139668292974*^9}, {3.4911435142949524`*^9, 
   3.4911435287907815`*^9}, {3.4911443383030834`*^9, 3.4911443490827*^9}, {
   3.491144396944437*^9, 3.4911444100991898`*^9}, {3.49372691011043*^9, 
   3.49372692388523*^9}, {3.578326882024825*^9, 3.578326921464274*^9}, {
   3.5784150500011077`*^9, 3.578415050689745*^9}, {3.578742603147615*^9, 
   3.578742608331819*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"\[ScriptCapitalC]", ",", "\"\<Cmat\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.57868946282497*^9, 3.5786894676504326`*^9}, {
  3.581888508859695*^9, 3.581888509769245*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate the potential energy and \[ScriptCapitalG] matrix\
\>", "Subsubsection",
 CellChangeTimes->{{3.432424030487764*^9, 3.4324240399569635`*^9}, {
   3.4329027694652*^9, 3.4329027701204*^9}, {3.434816438983*^9, 
   3.4348164411202*^9}, 3.43793555412879*^9, {3.440349144743*^9, 
   3.440349147317*^9}, 3.442411325423357*^9, {3.4856121102172585`*^9, 
   3.485612114289491*^9}}],

Cell["CoM Heights:", "Text",
 CellChangeTimes->{{3.578327733934136*^9, 3.578327741622241*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["h", "#1"], "=", 
       RowBox[{
        RowBox[{
         SubscriptBox["g", "#1"], "[", "\[Theta]", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], ")"}], "&"}], 
    ")"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "mm", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.432423824129964*^9, 3.4324238864363637`*^9}, {
   3.432423971144364*^9, 3.432423999723564*^9}, {3.432424052561764*^9, 
   3.4324241734149637`*^9}, {3.432424278995764*^9, 3.432424314438964*^9}, {
   3.432424436462164*^9, 3.4324244434977636`*^9}, {3.4324245212793636`*^9, 
   3.432424524149764*^9}, {3.4324246021809635`*^9, 3.4324246571921635`*^9}, {
   3.432424726783764*^9, 3.432424766298564*^9}, {3.4324251395285635`*^9, 
   3.432425167093764*^9}, {3.4324252869359636`*^9, 3.4324252894163637`*^9}, {
   3.4324253946851635`*^9, 3.4324254633699636`*^9}, {3.432466552285364*^9, 
   3.432466563361364*^9}, {3.432472550951764*^9, 3.4324725555693636`*^9}, 
   3.4324855973822002`*^9, {3.4324900950524*^9, 3.4324901000755997`*^9}, {
   3.4329023557844*^9, 3.4329025164332*^9}, 3.4329026965976*^9, {
   3.4329027730376*^9, 3.4329027738176003`*^9}, {3.433010535407*^9, 
   3.4330105409606*^9}, {3.4348164336322002`*^9, 3.4348165832674*^9}, {
   3.4349000267946*^9, 3.4349000545158*^9}, {3.4349001137802*^9, 
   3.434900128491*^9}, {3.4350811228208*^9, 3.4350811521644*^9}, {
   3.4350830880368*^9, 3.4350830958368*^9}, {3.4353197600888*^9, 
   3.4353197759384003`*^9}, {3.4353199019863997`*^9, 3.435319913546*^9}, {
   3.4353204863212*^9, 3.435320494558*^9}, {3.4379345646009903`*^9, 
   3.4379345799825897`*^9}, {3.43793463376299*^9, 3.4379346513441896`*^9}, {
   3.43793476884339*^9, 3.43793477801619*^9}, {3.43793568353479*^9, 
   3.43793568359719*^9}, {3.43793592474199*^9, 3.43793592739399*^9}, {
   3.4401610608496*^9, 3.4401610683375998`*^9}, {3.4401611193808002`*^9, 
   3.4401611200204*^9}, {3.440170282039*^9, 3.440170291693*^9}, {
   3.440173833365*^9, 3.4401738398199997`*^9}, {3.4402459914856*^9, 
   3.4402459953856*^9}, {3.440246324611*^9, 3.4402463326294003`*^9}, {
   3.4402731844642*^9, 3.4402732918142*^9}, {3.4402733284462*^9, 
   3.4402733876591997`*^9}, {3.4403407291026*^9, 3.4403407291806*^9}, {
   3.4403521782918*^9, 3.4403521809906*^9}, {3.4403618205132003`*^9, 
   3.4403618498100004`*^9}, {3.4403618844732003`*^9, 
   3.4403618893404007`*^9}, {3.4404234273524003`*^9, 
   3.4404234287252007`*^9}, {3.4405109052077737`*^9, 
   3.4405109244893737`*^9}, {3.4407689323747735`*^9, 
   3.4407689941195736`*^9}, {3.440769115828974*^9, 3.4407691531909733`*^9}, {
   3.4407692245921736`*^9, 3.440769225699774*^9}, {3.440852662710164*^9, 
   3.4408526689041643`*^9}, {3.440852919340164*^9, 3.440852922318164*^9}, {
   3.440853478608164*^9, 3.440853479436164*^9}, {3.440853755047164*^9, 
   3.440853756403164*^9}, {3.4408598817023478`*^9, 3.440859884619548*^9}, {
   3.440863710291148*^9, 3.440863713785548*^9}, {3.440934907752348*^9, 
   3.440934909749148*^9}, {3.440935055858748*^9, 3.440935073221548*^9}, {
   3.440935150909548*^9, 3.4409351588343477`*^9}, {3.440935362351948*^9, 
   3.440935381227948*^9}, {3.440936429625948*^9, 3.440936442137148*^9}, {
   3.441039212145953*^9, 3.4410392125983534`*^9}, {3.441039283266353*^9, 
   3.441039286713953*^9}, {3.442409473534757*^9, 3.4424094741275573`*^9}, 
   3.442411325423357*^9, {3.455459396313409*^9, 3.455459452973609*^9}, {
   3.455459548554809*^9, 3.455459610533609*^9}, {3.4831814758974*^9, 
   3.4831814765994*^9}, {3.485611735333816*^9, 3.48561173714892*^9}, {
   3.4856120435744467`*^9, 3.48561206147047*^9}, {3.4856124429142876`*^9, 
   3.4856124504347177`*^9}, {3.4863916362566*^9, 3.4863916516070004`*^9}, {
   3.4867472927418003`*^9, 3.4867472950193996`*^9}, {3.4867478624646*^9, 
   3.4867478626986*^9}, {3.490973807057146*^9, 3.4909738290234027`*^9}, {
   3.492167340665966*^9, 3.49216734370514*^9}, {3.492187915654736*^9, 
   3.492187983528618*^9}, {3.4921882200341454`*^9, 3.4921882218522496`*^9}, {
   3.492267629019311*^9, 3.4922676292193227`*^9}, {3.4922772890961037`*^9, 
   3.4922773366558247`*^9}, 3.4947767065155954`*^9, {3.49547025770188*^9, 
   3.4954702898535366`*^9}, {3.5783276158900433`*^9, 
   3.5783276649754057`*^9}, {3.5783277004401817`*^9, 
   3.5783277321655016`*^9}, {3.578327779344103*^9, 3.578327811880172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PE", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", "i", 
      RowBox[{"Length", "[", "mm", "]"}]], 
     RowBox[{
      RowBox[{"mm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      " ", "g", " ", 
      SubscriptBox["h", "i"]}]}], "/.", "constsubs"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.432423824129964*^9, 3.4324238864363637`*^9}, {
   3.432423971144364*^9, 3.432423999723564*^9}, {3.432424052561764*^9, 
   3.4324241734149637`*^9}, {3.432424278995764*^9, 3.432424314438964*^9}, {
   3.432424436462164*^9, 3.4324244434977636`*^9}, {3.4324245212793636`*^9, 
   3.432424524149764*^9}, {3.4324246021809635`*^9, 3.4324246571921635`*^9}, {
   3.432424726783764*^9, 3.432424766298564*^9}, {3.4324251395285635`*^9, 
   3.432425167093764*^9}, {3.4324252869359636`*^9, 3.4324252894163637`*^9}, {
   3.4324253946851635`*^9, 3.4324254633699636`*^9}, {3.432466552285364*^9, 
   3.432466563361364*^9}, {3.432472550951764*^9, 3.4324725555693636`*^9}, 
   3.4324855973822002`*^9, {3.4324900950524*^9, 3.4324901000755997`*^9}, {
   3.4329023557844*^9, 3.4329025164332*^9}, 3.4329026965976*^9, {
   3.4329027730376*^9, 3.4329027738176003`*^9}, {3.433010535407*^9, 
   3.4330105409606*^9}, {3.4348164336322002`*^9, 3.4348165832674*^9}, {
   3.4349000267946*^9, 3.4349000545158*^9}, {3.4349001137802*^9, 
   3.434900128491*^9}, {3.4350811228208*^9, 3.4350811521644*^9}, {
   3.4350830880368*^9, 3.4350830958368*^9}, {3.4353197600888*^9, 
   3.4353197759384003`*^9}, {3.4353199019863997`*^9, 3.435319913546*^9}, {
   3.4353204863212*^9, 3.435320494558*^9}, {3.4379345646009903`*^9, 
   3.4379345799825897`*^9}, {3.43793463376299*^9, 3.4379346513441896`*^9}, {
   3.43793476884339*^9, 3.43793477801619*^9}, {3.43793568353479*^9, 
   3.43793568359719*^9}, {3.43793592474199*^9, 3.43793592739399*^9}, {
   3.4401610608496*^9, 3.4401610683375998`*^9}, {3.4401611193808002`*^9, 
   3.4401611200204*^9}, {3.440170282039*^9, 3.440170291693*^9}, {
   3.440173833365*^9, 3.4401738398199997`*^9}, {3.4402459914856*^9, 
   3.4402459953856*^9}, {3.440246324611*^9, 3.4402463326294003`*^9}, {
   3.4402731844642*^9, 3.4402732918142*^9}, {3.4402733284462*^9, 
   3.4402733876591997`*^9}, {3.4403407291026*^9, 3.4403407291806*^9}, {
   3.4403521782918*^9, 3.4403521809906*^9}, {3.4403618205132003`*^9, 
   3.4403618498100004`*^9}, {3.4403618844732003`*^9, 
   3.4403618893404007`*^9}, {3.4404234273524003`*^9, 
   3.4404234287252007`*^9}, {3.4405109052077737`*^9, 
   3.4405109244893737`*^9}, {3.4407689323747735`*^9, 
   3.4407689941195736`*^9}, {3.440769115828974*^9, 3.4407691531909733`*^9}, {
   3.4407692245921736`*^9, 3.440769225699774*^9}, {3.440852662710164*^9, 
   3.4408526689041643`*^9}, {3.440852919340164*^9, 3.440852922318164*^9}, {
   3.440853478608164*^9, 3.440853479436164*^9}, {3.440853755047164*^9, 
   3.440853756403164*^9}, {3.4408598817023478`*^9, 3.440859884619548*^9}, {
   3.440863710291148*^9, 3.440863713785548*^9}, {3.440934907752348*^9, 
   3.440934909749148*^9}, {3.440935055858748*^9, 3.440935073221548*^9}, {
   3.440935150909548*^9, 3.4409351588343477`*^9}, {3.440935362351948*^9, 
   3.440935381227948*^9}, {3.440936429625948*^9, 3.440936442137148*^9}, {
   3.441039212145953*^9, 3.4410392125983534`*^9}, {3.441039283266353*^9, 
   3.441039286713953*^9}, {3.442409473534757*^9, 3.4424094741275573`*^9}, 
   3.442411325423357*^9, {3.455459396313409*^9, 3.455459452973609*^9}, {
   3.455459548554809*^9, 3.455459610533609*^9}, {3.4831814758974*^9, 
   3.4831814765994*^9}, {3.485611735333816*^9, 3.48561173714892*^9}, {
   3.4856120435744467`*^9, 3.48561206147047*^9}, {3.4856124429142876`*^9, 
   3.4856124504347177`*^9}, {3.4863916362566*^9, 3.4863916516070004`*^9}, {
   3.4867472927418003`*^9, 3.4867472950193996`*^9}, {3.4867478624646*^9, 
   3.4867478626986*^9}, {3.490973807057146*^9, 3.4909738290234027`*^9}, {
   3.492167340665966*^9, 3.49216734370514*^9}, {3.492187915654736*^9, 
   3.492187983528618*^9}, {3.4921882200341454`*^9, 3.4921882218522496`*^9}, {
   3.492267629019311*^9, 3.4922676292193227`*^9}, {3.4922772890961037`*^9, 
   3.4922773366558247`*^9}, 3.4947767065155954`*^9, {3.49547025770188*^9, 
   3.4954702898535366`*^9}, {3.5783276158900433`*^9, 
   3.5783276649754057`*^9}, {3.5783277004401817`*^9, 
   3.5783277321655016`*^9}, {3.5783277710073977`*^9, 3.578327771454811*^9}, {
   3.5783278258400726`*^9, 3.5783278398800488`*^9}, {3.57841299431304*^9, 
   3.5784129989833584`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "60000"], 
   RowBox[{"109", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"173880", " ", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], "+", 
      RowBox[{"43395", " ", 
       RowBox[{"sin", "(", 
        RowBox[{
         SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "-", 
      RowBox[{"75", " ", 
       RowBox[{"sin", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
      RowBox[{"17354", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
      RowBox[{"85995", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
      RowBox[{"75195", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
      RowBox[{"5400", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "3"], "(", "t", ")"}]}], ")"}]}], "-", 
      RowBox[{"11745", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
      RowBox[{"945", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "-", 
      RowBox[{"34", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
         RowBox[{
          SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
         RowBox[{
          SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.578828844460205*^9, 3.578833675310465*^9, 
  3.578833755115465*^9, 3.5788338383254232`*^9, 3.578834201904275*^9, 
  3.578834650353229*^9, 3.57883476761718*^9, 3.578835103614828*^9, 
  3.578835174453218*^9, 3.5788352615483294`*^9, 3.578835371817127*^9, 
  3.579553624425047*^9, 3.5795538296208715`*^9, 3.579553887923807*^9, 
  3.579554003394628*^9, 3.579555004905116*^9, 3.5795724091306067`*^9, 
  3.5796034488144183`*^9, 3.5796185725155473`*^9, 3.5796243980440474`*^9, 
  3.5796285708443103`*^9, 3.5798119159774027`*^9, 3.5798244022748923`*^9, 
  3.579825206753369*^9, 3.5798255349236546`*^9, 3.579994197205776*^9, 
  3.581014131913437*^9, 3.581888633792564*^9, 3.581890610934478*^9, 
  3.583584479388176*^9}]
}, Open  ]],

Cell["\<\
Calculate the gravity vector by reducing the potential energy and taking the \
Jacobian.\
\>", "Text",
 CellChangeTimes->{{3.49183024776204*^9, 3.4918302993729925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     SubscriptBox["\[PartialD]", 
      RowBox[{"{", "Q", "}"}]], "PE"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4856121155785646`*^9, 3.485612149147485*^9}, {
   3.485612183907473*^9, 3.485612196147173*^9}, {3.490973834358708*^9, 
   3.4909738345937214`*^9}, {3.4911343875259314`*^9, 
   3.4911344093261786`*^9}, {3.4911347052051015`*^9, 
   3.4911347125215197`*^9}, {3.4911347895619264`*^9, 3.4911347964193187`*^9}, 
   3.491135436852949*^9, {3.4937270888084297`*^9, 3.49372709617163*^9}, {
   3.49373901741323*^9, 3.49373903023643*^9}, {3.4937390882070303`*^9, 
   3.4937390892522297`*^9}, {3.5783272428082504`*^9, 
   3.5783272900068703`*^9}, {3.5783279198879895`*^9, 3.578327932055234*^9}, {
   3.5787426281869926`*^9, 3.578742631423986*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"G", ",", "\"\<Gmat\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.578689473090464*^9, 3.578689474042344*^9}, 
   3.581888504504655*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Holonomic constraints", "Subsection",
 CellChangeTimes->{{3.4856130387373667`*^9, 3.4856130423055706`*^9}}],

Cell[CellGroupData[{

Cell["End-effector configurations", "Subsubsection",
 CellChangeTimes->{{3.4857072707638583`*^9, 3.4857072919330583`*^9}, 
   3.4891650427955303`*^9, 3.4909736201434555`*^9}],

Cell["TODO No torso? Not really for amber 2", "Text",
 CellChangeTimes->{{3.5784150788567934`*^9, 3.5784151026077585`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "stt"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "sth"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "-", "Lfh"}], ",", "0", ",", "0"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "sta"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "stk"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "stH"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "Tb"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "Tt"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt", "+", "rTz"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "nsH"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc", "+", "Lt"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "nsk"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", 
       RowBox[{"ha", "+", "Lc"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "nsa"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Lft"}], ",", "0", ",", "ha"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "nsh"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Lft"}], "-", "Lfh"}], ",", "0", ",", "0"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["g", "nst"], "[", "0", "]"}], "=", 
   RowBox[{"RPToHomogeneous", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.578413950551354*^9, 3.5784139733284187`*^9}, {
   3.5784198789268246`*^9, 3.5784198949316254`*^9}, {3.578828204426499*^9, 
   3.578828276038068*^9}, 3.578828377928441*^9, {3.5795724410841675`*^9, 
   3.579572516089553*^9}, {3.5796192087507825`*^9, 3.5796192254982605`*^9}, {
   3.579619758665575*^9, 3.579619761173893*^9}, {3.579624104862938*^9, 
   3.579624160685527*^9}, {3.579629760726391*^9, 3.5796297642586555`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gtw", "=", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "3", ",", "3", ",", "4", ",", "5", ",", "6", ",", "6", ",", "7",
      ",", "8", ",", "9", ",", "9", ",", "9"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"glb", "=", 
   RowBox[{"{", 
    RowBox[{
    "stt", ",", "sth", ",", "sta", ",", "stk", ",", "stH", ",", "Tb", ",", 
     "Tt", ",", "nsH", ",", "nsk", ",", "nsa", ",", "nsh", ",", "nst"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.578828324168758*^9, 3.5788283847379007`*^9}, {
  3.578828420249549*^9, 3.578828423316936*^9}, {3.578828601466996*^9, 
  3.578828617329019*^9}, {3.5795725342783813`*^9, 3.5795725576810317`*^9}, {
  3.5795726002073703`*^9, 3.579572615711714*^9}, {3.5795726487032337`*^9, 
  3.579572659966653*^9}, {3.5795728043832517`*^9, 3.579572805013835*^9}, {
  3.579572854231366*^9, 3.579572857255163*^9}, {3.579572970846245*^9, 
  3.5795729947673745`*^9}, {3.579619271067364*^9, 3.579619284176479*^9}, {
  3.579619753030367*^9, 3.5796197561422424`*^9}, {3.579628468609909*^9, 
  3.579628470200899*^9}, {3.579629772332116*^9, 3.5796297739926515`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["g", 
          RowBox[{
          "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], 
         "[", "\[Theta]", "]"}], "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"ForwardKinematics", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "\[CapitalXi]", "\[LeftDoubleBracket]", "#1", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "Q", "\[LeftDoubleBracket]", "#1", 
                   "\[RightDoubleBracket]"}]}], "}"}], "&"}], ")"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{
               "gtw", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}],
                "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["g", 
                RowBox[{
                "glb", "\[LeftDoubleBracket]", "#1", 
                 "\[RightDoubleBracket]"}]], "[", "0", "]"}], "}"}]}], 
            "]"}]}], "/.", "constsubs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{
         "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], "=", 
        RowBox[{
         RowBox[{"RigidPosition", "[", 
          RowBox[{
           SubscriptBox["g", 
            RowBox[{
            "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], 
           "[", "\[Theta]", "]"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["v", 
         RowBox[{
         "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          SubscriptBox["\[PartialD]", "t"], 
          SubscriptBox["p", 
           RowBox[{
           "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["R", 
         RowBox[{
         "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], "=", 
        RowBox[{"RigidOrientation", "[", 
         RowBox[{
          SubscriptBox["g", 
           RowBox[{
           "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], 
          "[", "\[Theta]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Omega]", 
         RowBox[{
         "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]], "=", 
        RowBox[{
         RowBox[{"CrossProd", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"Inverse", "[", 
             SubscriptBox["R", 
              RowBox[{
              "glb", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}]],
              "]"}], ".", 
            RowBox[{
             SubscriptBox["\[PartialD]", "t"], 
             SubscriptBox["R", 
              RowBox[{
              "glb", "\[LeftDoubleBracket]", "#1", 
               "\[RightDoubleBracket]"}]]}]}], "]"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"{", "2", "}"}], "\[RightDoubleBracket]"}]}], ";"}], 
      "\[IndentingNewLine]", "}"}], "&"}], ")"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "glb", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.578828396499681*^9, 3.578828575933547*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "@", 
    RowBox[{"CrossProd", "@", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", "i", 
       RowBox[{"Length", "[", "Q", "]"}]], 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"{", 
           RowBox[{
           "Q", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "}"}]], 
         RowBox[{
          SubscriptBox["g", "#1"], "[", "\[Theta]", "]"}]}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          SubscriptBox["g", "#1"], "[", "\[Theta]", "]"}], "]"}]}], 
       RowBox[{
       "dQ", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}]}]}], 
   "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"stt", ",", "sth", ",", "nst", ",", "nsh"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.578328347831483*^9, 3.5783283557127666`*^9}, {
   3.578419986867646*^9, 3.578419994308527*^9}, {3.5795730117430773`*^9, 
   3.579573017422332*^9}, {3.579573065840123*^9, 3.579573114801417*^9}, {
   3.5795731901841526`*^9, 3.5795731921109347`*^9}, {3.579619191799116*^9, 
   3.579619193036259*^9}, 3.579619764846287*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "0"], "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], "0"},
     {"0", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "0"], "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "0"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "1"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "2"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "3"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "4"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "5"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "6"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "0"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "1"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "2"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "-", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "3"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "4"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "5"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "6"], "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.579619305960911*^9, 3.5796197653097143`*^9, 
  3.5796197975314255`*^9, 3.5796244131267834`*^9, 3.5796285871988173`*^9, 
  3.579628800326186*^9, 3.5796298006835604`*^9, 3.579811931617858*^9, 
  3.5798244215437*^9, 3.5798252259681263`*^9, 3.579825553960248*^9, 
  3.579994216160276*^9, 3.581014147790559*^9, 3.581890626665674*^9, 
  3.583584496401307*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JLabels", "=", 
   RowBox[{"{", 
    RowBox[{"stt", ",", "sth", ",", "nst", ",", "nsh"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JFLabels", "=", 
   RowBox[{"{", 
    RowBox[{"stf", ",", "nsf"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.578825031497205*^9, 3.578825033573835*^9}, {
  3.579573130438883*^9, 3.5795731365835667`*^9}, {3.5796187107390695`*^9, 
  3.579618713947034*^9}, {3.579618800654166*^9, 3.579618806530597*^9}, {
  3.579619505963561*^9, 3.5796195197142706`*^9}, {3.579619653699094*^9, 
  3.579619661610879*^9}, {3.57961977310583*^9, 3.579619773249601*^9}, {
  3.57962028925788*^9, 3.579620289442051*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jh", "=", 
   RowBox[{"PSimple", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Join", "@@", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", 
             RowBox[{"{", "dQ", "}"}]], "#1"}], "&"}], ")"}], "/@", "#1"}]}], 
       "&"}], ")"}], "/@", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Join", "[", 
          RowBox[{
           SubscriptBox["v", "#1"], ",", 
           SubscriptBox["\[Omega]", "#1"]}], "]"}], "}"}], "&"}], ")"}], "/@",
       "JLabels"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.578350383871366*^9, 3.57835054775606*^9}, {
   3.5783507729881325`*^9, 3.578350791567357*^9}, {3.578350846633114*^9, 
   3.5783508467581215`*^9}, 3.5783625786188755`*^9, {3.5784141521938295`*^9, 
   3.5784142406005864`*^9}, {3.578420027278018*^9, 3.578420031515936*^9}, {
   3.578742688101789*^9, 3.578742694054963*^9}, {3.578747705113739*^9, 
   3.578747733912199*^9}, {3.578824964300315*^9, 3.578825005520293*^9}, {
   3.5788250361759787`*^9, 3.57882504093676*^9}, {3.5795731836561136`*^9, 
   3.579573187710864*^9}, {3.579573279040353*^9, 3.5795732926399336`*^9}, {
   3.57957332980031*^9, 3.579573354103793*^9}, {3.5796187866201963`*^9, 
   3.57961881782003*^9}, {3.5796188551465263`*^9, 3.5796189006552124`*^9}, {
   3.579618935635539*^9, 3.5796189869808292`*^9}, {3.5796190749481263`*^9, 
   3.579619090747728*^9}, {3.5796191759885054`*^9, 3.579619180819969*^9}, 
   3.5796193501242914`*^9, 3.5796193963470087`*^9, {3.5796195587483435`*^9, 
   3.579619634482334*^9}, 3.5796197183563223`*^9, 3.579628497258477*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jhdot", "=", 
   RowBox[{"PSimple", "[", 
    RowBox[{
     SubscriptBox["\[PartialD]", 
      RowBox[{"{", "t", "}"}]], "Jh"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.578359365706591*^9, 3.5783594036416492`*^9}, {
  3.578362517386286*^9, 3.5783625197784977`*^9}, {3.5783625674655676`*^9, 
  3.5783625819299355`*^9}, {3.578742697449718*^9, 3.578742699058735*^9}, {
  3.578747753340373*^9, 3.57874775559863*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Only", " ", "write", " ", "the", " ", "Jacobians", " ", "for", " ", 
    "point", " ", "contact", " ", 
    RowBox[{"here", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"JLi", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{
        "JLabels", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteExpr", "[", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{
         "JLabels", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
        ",", 
        RowBox[{"\"\<p\>\"", "<>", "JLi"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteExpr", "[", 
       RowBox[{
        SubscriptBox["v", 
         RowBox[{
         "JLabels", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
        ",", 
        RowBox[{"\"\<v\>\"", "<>", "JLi"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteExpr", "[", 
       RowBox[{
        SubscriptBox["\[Omega]", 
         RowBox[{
         "JLabels", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
        ",", 
        RowBox[{"\"\<w\>\"", "<>", "JLi"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteExpr", "[", 
       RowBox[{
        RowBox[{"Jh", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"\"\<J\>\"", "<>", "JLi"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteExpr", "[", 
       RowBox[{
        RowBox[{"Jhdot", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"\"\<J\>\"", "<>", "JLi", "<>", "\"\<_dot\>\""}]}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "Jh", "]"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.57835113025946*^9, 3.578351200380592*^9}, {
   3.578351533241479*^9, 3.5783516789076385`*^9}, 3.578351709062426*^9, {
   3.578351740092351*^9, 3.5783517624609027`*^9}, {3.5783519103864017`*^9, 
   3.5783519457620173`*^9}, 3.5783522010361314`*^9, {3.5783625953543415`*^9, 
   3.578362644963189*^9}, {3.5788250733916473`*^9, 3.578825153562478*^9}, {
   3.579619890195964*^9, 3.5796199368460755`*^9}, {3.5796203141158533`*^9, 
   3.579620318387802*^9}, {3.5796204086462154`*^9, 3.579620447275916*^9}, {
   3.5796204901325235`*^9, 3.579620566437042*^9}, {3.5796206026925488`*^9, 
   3.5796206519580784`*^9}, 3.5796310300200834`*^9, {3.579631116852331*^9, 
   3.579631117052516*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{
    SubscriptBox["p", "Tb"], ",", "\"\<pTb\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{
    SubscriptBox["p", "sta"], ",", "\"\<psta\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5799939188177547`*^9, 3.579993939169544*^9}, {
  3.57999397847283*^9, 3.579993983225218*^9}, {3.5799987519239364`*^9, 
  3.5799987529648976`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Now", " ", "write", " ", "the", " ", "Jacobians", " ", "for", " ", "flat", 
   " ", "foot", " ", "contact", " ", "which", " ", "include", " ", 
   "restrictions", " ", "on", " ", "two", " ", "linear", " ", "velocities", 
   " ", "and", " ", "one", " ", "angular", " ", 
   RowBox[{"velocity", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.57835113025946*^9, 3.578351200380592*^9}, {
   3.578351533241479*^9, 3.5783516789076385`*^9}, 3.578351709062426*^9, {
   3.578351740092351*^9, 3.5783517624609027`*^9}, {3.5783519103864017`*^9, 
   3.5783519457620173`*^9}, 3.5783522010361314`*^9, {3.5783625953543415`*^9, 
   3.578362644963189*^9}, {3.5788250733916473`*^9, 3.578825153562478*^9}, {
   3.5796197961759114`*^9, 3.5796198229157877`*^9}, {3.5796199232745333`*^9, 
   3.579619947796195*^9}, {3.579620287274047*^9, 3.5796202875222764`*^9}, {
   3.579620323010073*^9, 3.5796203606258364`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JLi", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{
       "JFLabels", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteExpr", "[", 
      RowBox[{
       RowBox[{"Jh", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"2", "i"}], "-", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"\"\<J\>\"", "<>", "JLi"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteExpr", "[", 
      RowBox[{
       RowBox[{"Jhdot", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"2", "i"}], "-", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"\"\<J\>\"", "<>", "JLi", "<>", "\"\<_dot\>\""}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", 
      RowBox[{"Length", "[", "JFLabels", "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.57835113025946*^9, 3.578351200380592*^9}, {
   3.578351533241479*^9, 3.5783516789076385`*^9}, 3.578351709062426*^9, {
   3.578351740092351*^9, 3.5783517624609027`*^9}, {3.5783519103864017`*^9, 
   3.5783519457620173`*^9}, 3.5783522010361314`*^9, {3.5783625953543415`*^9, 
   3.578362644963189*^9}, {3.5788250733916473`*^9, 3.578825153562478*^9}, {
   3.5796197961759114`*^9, 3.5796198229157877`*^9}, {3.5796199232745333`*^9, 
   3.579620009483205*^9}, {3.5799993173509693`*^9, 3.579999317997566*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot positions", "Subsection",
 CellChangeTimes->{{3.5788281494051733`*^9, 3.57882815272318*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pp", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "#1"], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "sta", ",", "stt", ",", "sth", ",", "sta", ",", "stk", ",", "stH", ",", 
       "Tb", ",", "Tt", ",", "Tb", ",", "nsH", ",", "nsk", ",", "nsa", ",", 
       "nsh", ",", "nst", ",", "nsa"}], "}"}]}], ")"}], 
   "\[Transpose]"}]}]], "Input",
 CellChangeTimes->{{3.578828156248925*^9, 3.578828182381076*^9}, {
  3.5788286585931587`*^9, 3.578828732373548*^9}, {3.578828797877434*^9, 
  3.5788288039640903`*^9}, {3.579573445086961*^9, 3.579573492711017*^9}, {
  3.5795735277274103`*^9, 3.579573548447579*^9}, {3.5796239625944576`*^9, 
  3.579624008176583*^9}, {3.579629558616951*^9, 3.5796295851474705`*^9}, {
  3.5796298064971623`*^9, 3.5796298091168966`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       SubscriptBox["p", "x"], "(", "t", ")"}], 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}], "-", 
       RowBox[{
        FractionBox["5", "16"], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sin", "(", 
              RowBox[{
               SubscriptBox["q", "0"], "(", "t", ")"}], ")"}], "+", 
             RowBox[{"5", " ", 
              RowBox[{"sin", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}]}], 
            ")"}]}], "-", 
          RowBox[{"5", " ", 
           RowBox[{"cos", "(", 
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"cos", "(", 
         FractionBox[
          RowBox[{
           SubscriptBox["q", "2"], "(", "t", ")"}], "2"], ")"}], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
          RowBox[{
           SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
          FractionBox[
           RowBox[{
            SubscriptBox["q", "2"], "(", "t", ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"cos", "(", 
         FractionBox[
          RowBox[{
           SubscriptBox["q", "2"], "(", "t", ")"}], "2"], ")"}], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
          RowBox[{
           SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
          FractionBox[
           RowBox[{
            SubscriptBox["q", "2"], "(", "t", ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"sin", "(", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
           RowBox[{
            SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
           RowBox[{
            SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
           RowBox[{
            SubscriptBox["q", "3"], "(", "t", ")"}]}], ")"}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "x"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"cos", "(", 
         FractionBox[
          RowBox[{
           SubscriptBox["q", "2"], "(", "t", ")"}], "2"], ")"}], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
          RowBox[{
           SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
          FractionBox[
           RowBox[{
            SubscriptBox["q", "2"], "(", "t", ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"cos", "(", 
         FractionBox[
          RowBox[{
           SubscriptBox["q", "2"], "(", "t", ")"}], "2"], ")"}], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          RowBox[{
           SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
          RowBox[{
           SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
          FractionBox[
           RowBox[{
            SubscriptBox["q", "2"], "(", "t", ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "x"], "(", "t", ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              SubscriptBox["q", "0"], "(", "t", ")"}], ")"}], "+", 
            RowBox[{"5", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}], "+", 
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}], "-", 
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
                 RowBox[{
                  SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "x"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              SubscriptBox["q", "0"], "(", "t", ")"}], ")"}], "+", 
            RowBox[{"5", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}], "+", 
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"cos", "(", 
                 FractionBox[
                  RowBox[{
                   SubscriptBox["q", "5"], "(", "t", ")"}], "2"], ")"}], " ", 
                RowBox[{"sin", "(", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                  RowBox[{
                   SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                  RowBox[{
                   SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
                  RowBox[{
                   SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
                  RowBox[{
                   SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
                  FractionBox[
                   RowBox[{
                    SubscriptBox["q", "5"], "(", "t", ")"}], "2"]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "x"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "80"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "20"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "-", 
         RowBox[{"5", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"8", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"40", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"40", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"40", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"40", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"8", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"80", " ", 
          RowBox[{
           SubscriptBox["p", "x"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"10", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"10", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "x"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{
              SubscriptBox["q", "0"], "(", "t", ")"}], ")"}], "+", 
            RowBox[{"5", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}], "+", 
               RowBox[{"sin", "(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                 RowBox[{
                  SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"cos", "(", 
                 FractionBox[
                  RowBox[{
                   SubscriptBox["q", "5"], "(", "t", ")"}], "2"], ")"}], " ", 
                RowBox[{"sin", "(", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                  RowBox[{
                   SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                  RowBox[{
                   SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
                  RowBox[{
                   SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
                  RowBox[{
                   SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
                  FractionBox[
                   RowBox[{
                    SubscriptBox["q", "5"], "(", "t", ")"}], "2"]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "x"], "(", "t", ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       SubscriptBox["p", "z"], "(", "t", ")"}], 
      RowBox[{
       RowBox[{
        FractionBox["5", "16"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "10"], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"cos", "(", 
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"sin", "(", 
              RowBox[{
               SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"cos", "(", 
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"sin", "(", 
              RowBox[{
               SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"cos", "(", 
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"sin", "(", 
              RowBox[{
               SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"cos", "(", 
          RowBox[{
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
           RowBox[{
            SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
           RowBox[{
            SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
           RowBox[{
            SubscriptBox["q", "3"], "(", "t", ")"}]}], ")"}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "z"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"cos", "(", 
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"sin", "(", 
              RowBox[{
               SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "20"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"cos", "(", 
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"cos", "(", 
               RowBox[{
                RowBox[{
                 SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
                RowBox[{
                 SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "+", 
             RowBox[{"sin", "(", 
              RowBox[{
               SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SubscriptBox["p", "z"], "(", "t", ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "+", 
            RowBox[{"sin", "(", 
             RowBox[{
              SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "z"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "+", 
            RowBox[{"sin", "(", 
             RowBox[{
              SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "z"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "80"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"40", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"40", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"40", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"40", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"8", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"80", " ", 
          RowBox[{
           SubscriptBox["p", "z"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"10", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"10", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "-", 
         RowBox[{"5", " ", 
          RowBox[{"sin", "(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
            RowBox[{
             SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "5"], "(", "t", ")"}], "+", 
            RowBox[{
             SubscriptBox["q", "6"], "(", "t", ")"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "z"], "(", "t", ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "20"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"cos", "(", 
           RowBox[{
            SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "4"], "(", "t", ")"}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"cos", "(", 
              RowBox[{
               RowBox[{
                SubscriptBox["q", "0"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "1"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "2"], "(", "t", ")"}], "-", 
               RowBox[{
                SubscriptBox["q", "3"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "4"], "(", "t", ")"}], "+", 
               RowBox[{
                SubscriptBox["q", "5"], "(", "t", ")"}]}], ")"}]}], "+", 
            RowBox[{"sin", "(", 
             RowBox[{
              SubscriptBox["q", "0"], "(", "t", ")"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", 
          RowBox[{
           SubscriptBox["p", "z"], "(", "t", ")"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5795735490861692`*^9, 3.579573589043133*^9, 3.5796034756832495`*^9, 
   3.5796185990178185`*^9, 3.579620668398271*^9, {3.5796240084378242`*^9, 
   3.5796240302489815`*^9}, 3.579624426542678*^9, 3.5796286013883357`*^9, 
   3.5796288146270514`*^9, {3.5796295590483503`*^9, 3.579629585339648*^9}, 
   3.579629814206992*^9, 3.579631067460684*^9, 3.5796311308762913`*^9, 
   3.5798119449481773`*^9, 3.5798244407044077`*^9, 3.5798252451658688`*^9, 
   3.579825573304125*^9, 3.5799942353970366`*^9, 3.581014163645453*^9, 
   3.581890642710617*^9, 3.5835845123085938`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"WriteExpr", "[", 
   RowBox[{"pp", ",", "\"\<plotpos\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.578828780687031*^9, 3.578828793424518*^9}, 
   3.581888460122004*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conversion to MATLAB", "Section",
 CellChangeTimes->{{3.5818884640769873`*^9, 3.58188846919695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Run", "[", 
  RowBox[{"\"\<perl \>\"", "<>", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"utildir", ",", "\"\<math2mat.pl\>\""}], "}"}], "]"}], "<>", 
   "\"\< \>\"", "<>", "builddir", "<>", "\"\< \>\"", "<>", "builddir"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5784142663864326`*^9, 3.5784142862558084`*^9}, {
  3.578414345336445*^9, 3.5784143835117483`*^9}, {3.5784144350173807`*^9, 
  3.578414478379481*^9}, {3.5818884209006767`*^9, 3.581888421747861*^9}}],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5784142887000685`*^9, {3.578414358062213*^9, 3.578414392194779*^9}, {
   3.578414437033244*^9, 3.5784144393613977`*^9}, 3.578414479970953*^9, 
   3.5784145743592415`*^9, 3.5784147893420544`*^9, 3.5784150733857336`*^9, {
   3.578420037201194*^9, 3.5784200547394133`*^9}, 3.578420980683712*^9, {
   3.578685234186389*^9, 3.5786852606989074`*^9}, 3.5786853180259233`*^9, 
   3.5786853718697166`*^9, 3.5786854070172205`*^9, 3.578689481125894*^9, {
   3.578689597020071*^9, 3.578689612539423*^9}, 3.578742731806526*^9, 
   3.578742761973024*^9, 3.57874382787954*^9, 3.578747190150331*^9, 
   3.578747772879939*^9, 3.578824923680048*^9, 3.578825206098754*^9, 
   3.578828810525475*^9, 3.578828852134074*^9, 3.578833681747199*^9, 
   3.5788337615463*^9, 3.578833844729665*^9, 3.578834208479192*^9, 
   3.5788346570033693`*^9, 3.578834774123114*^9, 3.578835109934306*^9, 
   3.578835180593223*^9, 3.5788352678277397`*^9, 3.578835378173415*^9, 
   3.5795536308519926`*^9, 3.5795538360187902`*^9, 3.5795538943767767`*^9, 
   3.5795540096744375`*^9, 3.5795550111498933`*^9, 3.579573591348265*^9, 
   3.579603475882434*^9, 3.579618599152944*^9, 3.5796206740164633`*^9, {
   3.57962401411307*^9, 3.5796240318104258`*^9}, 3.5796244266687946`*^9, 
   3.579628601531468*^9, 3.579628814763177*^9, 3.5796298178413506`*^9, {
   3.579631068726855*^9, 3.5796310978077297`*^9}, 3.5796311319412766`*^9, 
   3.5798119450873055`*^9, 3.5798244408445377`*^9, 3.5798252453180094`*^9, 
   3.5798255734432535`*^9, 3.5799942354761095`*^9, 3.581014163821751*^9, 
   3.581890642841936*^9, 3.583584512634574*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dl2", "=", 
  RowBox[{"DateString", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.4755248724793*^9, 3.4755248752560997`*^9}, 
   3.4755249570937*^9, {3.4918297990723767`*^9, 3.4918297998424206`*^9}, {
   3.58188844772857*^9, 3.5818884481695747`*^9}}],

Cell[BoxData[
 FormBox["\<\"Tue 23 Jul 2013 11:08:32\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5783952252235374`*^9, 3.5784105123107214`*^9, 3.578414611983035*^9, 
   3.578414858287814*^9, 3.5784150734247694`*^9, {3.578420038588477*^9, 
   3.5784200547724433`*^9}, 3.5784209817727194`*^9, {3.578685236613634*^9, 
   3.5786852607309375`*^9}, 3.5786853180599546`*^9, 3.578685371895741*^9, 
   3.578685407045246*^9, 3.578689481145912*^9, {3.5786895970561047`*^9, 
   3.5786896125624447`*^9}, {3.578742732519692*^9, 3.578742761990198*^9}, 
   3.578743827897311*^9, 3.578824923697188*^9, 3.578825206116083*^9, 
   3.578828811065844*^9, 3.578828852152938*^9, 3.578833681765552*^9, 
   3.578833761562891*^9, 3.578833844812714*^9, 3.5788342084956083`*^9, 
   3.578834657085444*^9, 3.57883477414073*^9, 3.578835109996963*^9, 
   3.578835180647143*^9, 3.578835267887781*^9, 3.5788353781893797`*^9, 
   3.5795536308780174`*^9, 3.5795538360558243`*^9, 3.579553894398797*^9, 
   3.5795540096924543`*^9, 3.57955501117892*^9, 3.5795735933421106`*^9, 
   3.579603475906456*^9, 3.579618599178968*^9, 3.5796206748652477`*^9, 
   3.5796244267028255`*^9, 3.579628601561496*^9, 3.5796288148082185`*^9, 
   3.579631069934971*^9, 3.579631132935194*^9, 3.579811945105322*^9, 
   3.5798244408695607`*^9, 3.5798252453420315`*^9, 3.5798255734702787`*^9, 
   3.5799942355051365`*^9, 3.581014163827119*^9, 3.581890642904731*^9, 
   3.583584512695611*^9}]
}, Open  ]],

Cell["Compiliation time (seconds)", "Text",
 CellChangeTimes->{{3.4831816188431997`*^9, 3.4831816296540003`*^9}, {
  3.578742732860379*^9, 3.578742734130189*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tr", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"dl2", "-", "dl1"}], ")"}], ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"24", " ", "60", " ", "60"}], ",", 
      RowBox[{"60", " ", "60"}], ",", "60", ",", "1"}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4755249725845003`*^9, 3.4755250081525*^9}, {
   3.4939935420952*^9, 3.4939935426256*^9}, 3.494339291013456*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Computation time:      \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"DateDifference", "[", 
       RowBox[{"dl1", ",", "dl2", ",", "\"\<Second\>\""}], "]"}], "//", 
      "First"}], "]"}], "<>", "\"\< seconds\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4939935436084003`*^9, 3.4939935487408*^9}, {
  3.4939935851823997`*^9, 3.4939936013128*^9}, {3.4939937276104*^9, 
  3.4939937459248*^9}, {3.581879432471252*^9, 3.5818795044558973`*^9}}],

Cell[BoxData[
 FormBox["\<\"Computation time:      129. seconds\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.581890642973135*^9, 3.583584512799981*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{927, 1148},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
ShowSelection->True,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 405, 5, 83, "Title"],
Cell[CellGroupData[{
Cell[997, 31, 131, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[1153, 37, 192, 4, 30, "Input"],
Cell[1348, 43, 1727, 25, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3112, 73, 292, 5, 30, "Input"],
Cell[3407, 80, 1757, 26, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5201, 111, 520, 10, 30, "Input"],
Cell[5724, 123, 1389, 20, 31, "Output"]
}, Open  ]],
Cell[7128, 146, 514, 14, 50, "Input"],
Cell[CellGroupData[{
Cell[7667, 164, 325, 8, 33, "Input"],
Cell[7995, 174, 1441, 24, 172, "Output"]
}, Open  ]],
Cell[9451, 201, 847, 12, 30, "Input"],
Cell[10301, 215, 759, 14, 30, "Input"],
Cell[CellGroupData[{
Cell[11085, 233, 14989, 242, 498, "Input"],
Cell[26077, 477, 1827, 44, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27941, 526, 104, 1, 28, "Subsubsection"],
Cell[28048, 529, 923, 26, 88, "Input"],
Cell[CellGroupData[{
Cell[28996, 559, 2068, 40, 88, "Input"],
Cell[31067, 601, 934, 23, 33, "Output"]
}, Open  ]],
Cell[32016, 627, 685, 18, 88, "Input"],
Cell[CellGroupData[{
Cell[32726, 649, 11339, 169, 30, "Input"],
Cell[44068, 820, 4679, 117, 55, "Output"]
}, Open  ]],
Cell[48762, 940, 634, 13, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49433, 958, 249, 3, 28, "Subsubsection"],
Cell[49685, 963, 632, 14, 30, "Input"],
Cell[50320, 979, 1533, 37, 88, "Input"],
Cell[51856, 1018, 1254, 33, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53147, 1056, 122, 1, 28, "Subsubsection"],
Cell[53272, 1059, 1102, 25, 126, "Input"],
Cell[54377, 1086, 2948, 76, 449, "Input"],
Cell[57328, 1164, 509, 13, 69, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57886, 1183, 204, 3, 72, "Section"],
Cell[CellGroupData[{
Cell[58115, 1190, 168, 2, 28, "Subsubsection"],
Cell[58286, 1194, 4686, 130, 211, "Input"],
Cell[62975, 1326, 1119, 28, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64131, 1359, 281, 4, 28, "Subsubsection"],
Cell[64415, 1365, 6284, 140, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70736, 1510, 222, 3, 37, "Subsection"],
Cell[CellGroupData[{
Cell[70983, 1517, 123, 1, 28, "Subsubsection"],
Cell[71109, 1520, 1699, 40, 55, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72845, 1565, 392, 6, 28, "Subsubsection"],
Cell[73240, 1573, 673, 19, 32, "Input"],
Cell[73916, 1594, 839, 20, 58, "Input"],
Cell[CellGroupData[{
Cell[74780, 1618, 1109, 22, 50, "Input"],
Cell[75892, 1642, 3820, 96, 55, "Output"]
}, Open  ]],
Cell[79727, 1741, 263, 7, 30, "Text"],
Cell[79993, 1750, 359, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[80377, 1764, 622, 11, 30, "Input"],
Cell[81002, 1777, 4421, 87, 174, "Output"]
}, Open  ]],
Cell[85438, 1867, 224, 5, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85699, 1877, 169, 2, 28, "Subsubsection"],
Cell[85871, 1881, 213, 4, 30, "Text"],
Cell[86087, 1887, 977, 17, 30, "Input"],
Cell[87067, 1906, 247, 5, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87351, 1916, 390, 7, 28, "Subsubsection"],
Cell[87744, 1925, 94, 1, 30, "Text"],
Cell[87841, 1928, 4483, 72, 30, "Input"],
Cell[CellGroupData[{
Cell[92349, 2004, 4500, 69, 58, "Input"],
Cell[96852, 2075, 4408, 118, 115, "Output"]
}, Open  ]],
Cell[101275, 2196, 179, 4, 30, "Text"],
Cell[101457, 2202, 843, 16, 32, "Input"],
Cell[102303, 2220, 207, 5, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102559, 2231, 113, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[102697, 2236, 174, 2, 28, "Subsubsection"],
Cell[102874, 2240, 123, 1, 30, "Text"],
Cell[103000, 2243, 4606, 143, 240, "Input"],
Cell[107609, 2388, 1151, 23, 50, "Input"],
Cell[108763, 2413, 3755, 99, 189, "Input"],
Cell[CellGroupData[{
Cell[112543, 2516, 1165, 30, 58, "Input"],
Cell[113711, 2548, 3257, 90, 84, "Output"]
}, Open  ]],
Cell[116983, 2641, 690, 15, 50, "Input"],
Cell[117676, 2658, 1710, 37, 32, "Input"],
Cell[119389, 2697, 455, 10, 32, "Input"],
Cell[119847, 2709, 2886, 69, 205, "Input"],
Cell[122736, 2780, 455, 12, 50, "Input"],
Cell[123194, 2794, 948, 15, 50, "Input"],
Cell[124145, 2811, 1539, 34, 126, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125733, 2851, 103, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[125861, 2856, 831, 18, 30, "Input"],
Cell[126695, 2876, 43104, 1182, 67, "Output"]
}, Open  ]],
Cell[169814, 4061, 211, 5, 30, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[170074, 4072, 106, 1, 72, "Section"],
Cell[CellGroupData[{
Cell[170205, 4077, 508, 10, 30, "Input"],
Cell[170716, 4089, 1659, 24, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172412, 4118, 274, 5, 30, "Input"],
Cell[172689, 4125, 1442, 21, 31, "Output"]
}, Open  ]],
Cell[174146, 4149, 162, 2, 30, "Text"],
Cell[174311, 4153, 445, 12, 30, "Input"],
Cell[CellGroupData[{
Cell[174781, 4169, 540, 11, 50, "Input"],
Cell[175324, 4182, 164, 3, 24, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
